{"version":3,"sources":["utils/index.ts","components/Nav.tsx","assets/logo.png","services/base.ts","types/index.ts","utils/initData.ts","utils/undoRedo.ts","store/template.ts","utils/createNewLayer.ts","components/side-bar/ImageItem.tsx","components/side-bar/TextItem.tsx","components/side-bar/Shapes.tsx","components/side-bar/UploadImage.tsx","components/side-bar/Sidebar.tsx","services/common.ts","components/Footer.tsx","assets/undo.png","assets/redo.png","store/context.ts","utils/mouseEvent.ts","utils/resizeLayer.ts","utils/clipImage.ts","assets/rotate.svg","assets/lock.svg","components/layer/Border.tsx","components/layer/HoverBorder.tsx","components/layer/Layer.tsx","utils/helpLine.ts","components/layer/TextEditor.tsx","components/layer/Image.tsx","assets/resize.svg","components/ClipImage.tsx","components/layer/shapes/Rect.tsx","components/layer/shapes/Circle.tsx","components/Canvas.tsx","components/tool-bar/tool-items/style.ts","utils/const.ts","components/tool-bar/tool-items/CanvasSize.tsx","components/tool-bar/tool-items/ClearCanvas.tsx","components/tool-bar/tool-items/BackgroundColor.tsx","components/tool-bar/tool-items/text/TextColor.tsx","components/tool-bar/tool-items/text/FontFamily.tsx","components/tool-bar/tool-items/text/FontSize.tsx","components/tool-bar/tool-items/text/FontWeight.tsx","components/tool-bar/tool-items/text/Underline.tsx","components/tool-bar/tool-items/text/TextAlign.tsx","components/tool-bar/tool-items/image/Flip.tsx","components/tool-bar/tool-items/image/Clip.tsx","components/tool-bar/tool-items/shape/ShapeFillColor.tsx","components/tool-bar/tool-items/shape/ShapeBorderColor.tsx","assets/border-weight.svg","components/tool-bar/tool-items/shape/ShapeBorderWidth.tsx","assets/border-style.svg","components/tool-bar/tool-items/shape/ShapeBorderStyle.tsx","components/tool-bar/tool-items/common/LayerOrder.tsx","assets/opacity.svg","components/tool-bar/tool-items/common/Opacity.tsx","components/tool-bar/tool-items/common/LockLayer.tsx","components/tool-bar/tool-items/common/RemoveLayer.tsx","components/tool-bar/Index.tsx","components/Editor.tsx","components/Main.tsx","pages/App.tsx","reportWebVitals.ts","index.tsx"],"names":["getCenterCoords","p1","p2","x","y","calcRotatedCoords","point","center","rotate","Math","PI","cos","sin","getCoverImage","selector","a","el","document","querySelector","copyEl","cloneNode","style","transform","position","left","body","appendChild","querySelectorAll","forEach","img","setAttribute","opt","width","offsetWidth","height","offsetHeight","backgroundColor","useCORS","Promise","resolve","reject","html2canvas","then","canvas","res","toDataURL","catch","e","finally","removeChild","Nav","useState","loading","setLoading","exportImage","url","createElement","href","Date","now","click","remove","console","error","Header","Img","src","type","onClick","styled","header","service","axios","create","baseURL","timeout","interceptors","response","use","data","LAYER_TYPE","POINT_TYPE","defaultTemplate","global","background","color","layers","id","reverse","source","imageUrl","opacity","zIndex","content","font","fontSize","lineHeight","textAlign","fontWeight","underline","historyCache","pointer","isUndoOrRedo","undoRedo","setCanUseUndo","templateStore","setCanUseRedo","init","template","push","pushHistory","_template","cloneDeep","map","l","isSelected","isEditing","isHover","splice","length","shift","undo","setTemplate","setLayerType","EMPTY","redo","Object","assign","layer","isLocked","scale","localTemplateCache","localStorage","getItem","JSON","parse","observable","layerType","needUpdateLayerHeight","isMoving","canUseUndo","canUseRedo","this","find","getTemplate","clip","pre","val","setCanvasSize","size","setLayers","setLayer","idx","findIndex","addLayer","updateLayerType","removeLayer","setLayerLevel","level","selectLayer","dispatchEvent","Event","hoverLayer","IMAGE","TEXT","RECT","CIRCLE","setEditStatus","some","setLayerLock","resetSelectStatus","resetEditStatus","setBackgroundColor","setNeedUpdateLayerHeight","setIsMoving","action","bound","reaction","join","replaceAll","stringify","setItem","save","delay","createImage","String","top","right","bottom","createRect","rectInfo","fill","borderWidth","borderColor","borderStyle","createCircle","circleInfo","observer","image","flexBasis","webformatWidth","webformatHeight","draggable","newLayer","webformatURL","onDragStartCapture","dataTransfer","setData","alt","Image","div","onUseText","createText","marginTop","Rect","RectItem","Circle","CircleItem","onUseImage","UploadButton","htmlFor","accept","display","onChange","reader","FileReader","readAsDataURL","target","files","onload","result","label","Panel","Collapse","Search","Input","ajaxLock","isLoadMore","Sidebar","list","setList","page","per_page","image_type","q","orientation","safesearch","query","setQuery","showFilter","setShowFilter","useEffect","params","ajax","key","lang","concat","hits","Side","defaultActiveKey","collapsible","extra","onSearch","preventDefault","placeholder","title","trigger","visible","onVisibleChange","FilterOutlined","stopPropagation","FilterPanel","ListContent","UploadImage","ImageItem","TextItem","aside","setScale","responsive","FooterBar","SliderWrapper","className","tipFormatter","value","min","max","ToolItem","round","UndoRedo","footer","ScaleContext","createContext","BackgroundContext","MouseEvents","handleMove","handleUp","payload","startCoords","preCoords","mouseUp","onmousemove","onmouseup","mouseMove","event","diffX","clientX","diffY","clientY","diff","curCoords","mouseDown","MIN_SIZE","normalResize","lockRatio","whRatio","newX","newY","newWidth","newHeight","TL","TR","BL","BR","T","B","L","R","rotateResize","curPoint","symmetricPoint","pointCenter","info","newCenterPoint","newOriginCurPoint","newOriginSymmetricPoint","abs","latestOriginCurPoint","latestCurPoint","sqrt","newCenter","isReverse","angle","clipImage","oldWidth","oldHeight","imageWhRatio","ratio","updateImageClip","INIT_ANGLE","ANGLE_TO_CURSOR","start","end","cursor","useContext","cursors","setCursors","resize","resizeNormal","pointRect","getBoundingClientRect","canvasRect","Number","resizeWithRotate","calcCursors","useCallback","newAngle","item","i","BorderEl","LockIcon","icon","lockIcon","PointBR","onMouseDown","PointTL","PointTR","PointBL","PointL","PointR","PointT","PointB","RotateIcon","rotateIcon","borderEl","closest","rect","rotateCenterPoint","offsetY","offsetX","atan2","Point","span","alignItems","justifyContent","pointerEvents","borderRadius","boxShadow","userSelect","props","HoverBorder","children","setIsSelectedBackground","realRect","layerId","allLayers","canvasSize","vLineEl","hLineEl","vType","hType","vLineHandle","targetX","hLineHandle","targetY","renderLine","vLine","visibility","hLine","getRect","scl","rad","move","helpLine","helpLineRect","initHelpLine","helpLinePipe","updatePosition","newPosition","hideLine","LayerWrapper","onMouseEnter","onMouseOut","LayerContent","TransportBorder","Border","createPortal","editorRef","useRef","editor","setEditor","onTextChange","_layer","text","getText","current","instance","Quill","setText","enable","setSelection","on","off","TextWrapper","Text","onDoubleClick","Editor","ref","spellCheck","fontFamily","textDecorationLine","ImgWrapper","preLayer","setLayerInfo","confirm","clipHandle","handleTop","clipTop","handleLeft","clipLeft","handleRight","clipRight","handleBottom","clipBottom","Mask","Wrapper","CanvasContent","LayerControl","AngleTL","resizeIcon","AngleTR","AngleBL","AngleBR","Line1","Line2","Line3","Line4","newTop","newLeft","newRight","newBottom","overflow","border","TransportToolBar","ToolBar","CheckOutlined","CloseOutlined","Line","ResizeAngle","dragCursorPosition","isSelectedBackground","onDrop","getPosition","test","getData","log","onUseRect","onUseCircle","onDragOver","pageX","pageY","Background","BACKGROUND","TransportImage","ClipImage","toJS","Layer","TransportEditor","TextEditor","BackgroundBorder","VLine","HLine","TextControl","flex","margin","ColorItem","FONT_LIST","name","FONTSIZE_LIST","CANVAS_SIZE_LIST","canvasWidth","canvasHeight","selectValue","setSelectValue","CanvasSizeOptions","Group","direction","marginRight","isNumber","marginLeft","placement","onConfirm","okText","cancelText","clr","rgba","rgb","r","g","b","activeLayer","Option","Select","f","layerScale","toFixed","isNaN","BoldOutlined","hasUnderline","UnderlineOutlined","align","AlignLeftOutlined","AlignCenterOutlined","AlignRightOutlined","onReverseImage","overlay","Item","padding","SwapOutlined","shapeInfo","step","borderWidthIcon","onBorderStyleChange","BorderSolid","BorderDashed","BorderDotted","borderStyleIcon","levelInfo","sort","opacityIcon","LockOutlined","UnlockOutlined","DeleteOutlined","ToolBarWrapper","ItemGroup","includes","CanvasSize","BackgroundColor","TextColor","FontFamily","FontSize","FontWeight","Underline","TextAlign","Flip","Clip","ShapeFillColor","ShapeBorderColor","ShapeBorderWidth","ShapeBorderStyle","LayerOrder","Opacity","LockLayer","RemoveLayer","ClearCanvas","copyLayer","scrollWrapperRef","wrapperEl","clientWidth","clientHeight","onKeyboardListener","activeElement","metaKey","ctrlKey","shiftKey","addEventListener","removeEventListener","ScrollWrapper","Container","Provider","Canvas","Footer","num","Main","MainBody","main","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c179c10b.chunk.js","sourcesContent":["import html2canvas from 'html2canvas'\n\ninterface Coords {\n  x: number;\n  y: number;\n}\n\n// 求两点之间的中点坐标\nexport const getCenterCoords = (p1: Coords, p2: Coords): Coords => {\n  return {\n    x: p1.x + ((p2.x - p1.x) / 2),\n    y: p1.y + ((p2.y - p1.y) / 2)\n  }\n}\n\n/**\n * 计算根据圆心旋转后的点的坐标\n * @param point 旋转前的点坐标\n * @param center 旋转中心\n * @param rotate 旋转的角度\n * @return 旋转后的坐标\n */\n export const calcRotatedCoords = (point: Coords, center: Coords, rotate: number): Coords => {\n  rotate /= 180 / Math.PI\n  return {\n    x: (point.x - center.x) * Math.cos(rotate) - (point.y - center.y) * Math.sin(rotate) + center.x,\n    y: (point.x - center.x) * Math.sin(rotate) + (point.y - center.y) * Math.cos(rotate) + center.y\n  }\n}\n\n/** 截取图片 */\nexport async function getCoverImage (selector: string): Promise<string> {\n  const el = document.querySelector(selector) as HTMLElement\n  const copyEl = el.cloneNode(true) as HTMLElement\n\n  copyEl.style.transform = ''\n  copyEl.style.position = 'fixed'\n  copyEl.style.left = '-9999px'\n  document.body.appendChild(copyEl)\n  copyEl.querySelectorAll('img').forEach((img) => {\n    // 图片跨域，服务端也要支持（图片服务器配置Access-Control-Allow-Origin）\n    img.setAttribute('crossOrigin', 'anonymous')\n  })\n  const opt = {\n    width: copyEl.offsetWidth, // canvas宽度\n    height: copyEl.offsetHeight,\n    backgroundColor: null, // 画出来的图片有白色的边框,不要可设置背景为透明色（null）\n    useCORS: true // 支持图片跨域\n  }\n\n  return new Promise((resolve, reject) => {\n    html2canvas(copyEl, opt).then((canvas: any) => {\n      const res = canvas.toDataURL('image/png')\n      resolve(res)\n    }).catch((e: any) => {\n      reject(e)\n    }).finally(() => {\n      document.body.removeChild(copyEl)\n    })\n  })\n}\n","import styled from '@emotion/styled'\nimport Logo from 'assets/logo.png'\nimport { Button } from 'antd'\nimport { getCoverImage } from 'utils'\nimport { useState } from 'react'\n\nexport default function Nav () {\n  const [loading, setLoading] = useState(false)\n\n  const exportImage = async () => {\n    setLoading(true)\n    try {\n      const url = await getCoverImage('#canvasContent')\n      const a = document.createElement('a')\n      a.href = url\n      a.setAttribute('download', `${Date.now()}.png`)\n      a.click()\n      a.remove()\n    } catch (e) { console.error(e) }\n    setLoading(false)\n  }\n\n  return <Header>\n    <a href=\"https://github.com/XXLiang1122/visual-editor\"><Img src={Logo} /></a>\n    <Button loading={loading} type=\"primary\" onClick={exportImage}>导出图片</Button>\n  </Header>\n}\n\nconst Header = styled.header`\n  height: 56px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 20px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n`\n\nconst Img = styled.img`\n  width: 48px;\n  height: 48px;\n  object-fit: cover;\n  cursor: pointer;\n`","export default \"data:image/png;base64,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\"","import axios from 'axios'\n\nconst service = axios.create({\n  baseURL: 'https://pixabay.com/api',\n  timeout: 10000\n})\n\nservice.interceptors.response.use((response) => {\n  return response.data\n})\n\nexport default service","export interface TemplateInfo {\n  global: {\n    width: number;\n    height: number;\n  },\n  background: {\n    color: string;\n  },\n  layers: Layer[];\n}\n\nexport interface Layer {\n  id: string;\n  type: LayerType;\n  width: number;\n  height: number;\n  position: {\n    x: number;\n    y: number;\n  };\n  rotate: number;\n  reverse?: {\n    x: number;\n    y: number;\n  },\n  source: {\n    imageUrl?: string;\n    content?: string;\n  };\n  opacity: number;\n  style?: FontStyle;\n  clip?: ImageClip;\n  rectInfo?: RectShape;\n  circleInfo?: RectShape;\n  zIndex: number;\n  isSelected?: boolean;\n  isHover?: boolean;\n  isEditing?: boolean;\n  isLocked?: boolean;\n  scale?: number;\n}\n\nexport interface RectShape {\n  fill: string;\n  borderWidth: number;\n  borderColor: string;\n  borderStyle: string;\n}\n\nexport interface FontStyle {\n  font: string;\n  fontSize: number;\n  lineHeight: number;\n  color: string;\n  textAlign: Align;\n  fontWeight: number;\n  underline: boolean;\n}\n\nexport interface ImageClip {\n  width: number;\n  height: number;\n  top: number;\n  left: number;\n  right: number;\n  bottom: number;\n  pre: {\n    width: number;\n    height: number;\n    top: number;\n    left: number;\n    right: number;\n    bottom: number;\n  }\n}\n\nexport type LayerType = 'image' | 'text' | 'rect' | 'circle'\nexport type Align = 'left' | 'center' | 'right' | 'justify'\n\nexport enum LAYER_TYPE {\n  EMPTY = 'empty',\n  IMAGE = 'image',\n  TEXT = 'text',\n  RECT = 'rect',\n  CIRCLE = 'circle',\n  BACKGROUND = 'background'\n}\n\nexport enum POINT_TYPE {\n  TL = 'topLeft',\n  TR = 'topRight',\n  BL = 'bottomLeft',\n  BR = 'bottomRight',\n  T = 'top',\n  B = 'bottom',\n  L = 'left',\n  R = 'right'\n}\n\nexport interface Coords {\n  x: number;\n  y: number;\n}\n","import { TemplateInfo } from 'types'\n\nexport const defaultTemplate: TemplateInfo = {\n  global: {\n    width: 1280,\n    height: 720\n  },\n  background: {\n    color: '#fff'\n  },\n  layers: [\n    {\n      id: '1',\n      type: 'image',\n      width: 510,\n      height: 340,\n      position: {\n        x: 100,\n        y: 100\n      },\n      rotate: 0,\n      reverse: {\n        x: 1,\n        y: 1\n      },\n      source: {\n        imageUrl: 'https://cdn.pixabay.com/photo/2014/04/13/20/49/cat-323262__340.jpg'\n      },\n      opacity: 1,\n      zIndex: 1\n    },\n    {\n      id: '2',\n      type: 'text',\n      width: 380,\n      height: 72,\n      position: {\n        x: 100,\n        y: 500\n      },\n      rotate: 0,\n      source: {\n        content: '双击编辑文字'\n      },\n      style: {\n        font: 'Microsoft Yahei',\n        fontSize: 60,\n        lineHeight: 1.2,\n        color: '#000',\n        textAlign: 'left',\n        fontWeight: 400,\n        underline: false\n      },\n      opacity: 1,\n      zIndex: 2\n    }\n  ]\n}","import { cloneDeep } from 'lodash'\nimport { templateStore } from 'store/template'\nimport { TemplateInfo, LAYER_TYPE } from 'types'\n\nconst historyCache: TemplateInfo[] = []\nlet pointer = 0\nlet isUndoOrRedo = false\n\nexport default function undoRedo () {\n  const { setCanUseUndo, setCanUseRedo } = templateStore\n\n  const init = (template: TemplateInfo) => {\n    historyCache.push(template)\n  }\n\n  // 缓存历史记录\n  const pushHistory = () => {\n    if (isUndoOrRedo) {\n      isUndoOrRedo = false\n      return\n    }\n\n    const _template = cloneDeep(templateStore.template)\n    _template.layers = _template.layers.map(l => {\n      l.isSelected = false\n      l.isEditing = false\n      l.isHover = false\n      return l\n    })\n    pointer++\n    historyCache[pointer] = _template\n    historyCache.splice(pointer + 1, historyCache.length)\n    setCanUseUndo(true)\n    setCanUseRedo(false)\n    if (historyCache.length > 50) {\n      historyCache.shift()\n      pointer--\n    }\n  }\n\n  // 撤销\n  const undo = () => {\n    if (historyCache[pointer - 1]) {\n      isUndoOrRedo = true\n      pointer--\n      const _template = historyCache[pointer]\n      templateStore.setTemplate(cloneDeep(_template))\n      templateStore.setLayerType(LAYER_TYPE.EMPTY)\n      setCanUseRedo(true)\n      if (!historyCache[pointer - 1]) {\n        setCanUseUndo(false)\n      }\n    }\n  }\n\n  // 重做\n  const redo = () => {\n    if (historyCache[pointer + 1]) {\n      isUndoOrRedo = true\n      pointer++\n      const _template = historyCache[pointer]\n      templateStore.setTemplate(cloneDeep(_template))\n      templateStore.setLayerType(LAYER_TYPE.EMPTY)\n      setCanUseUndo(true)\n      if (!historyCache[pointer + 1]) {\n        setCanUseRedo(false)\n      }\n    }\n  }\n\n  return {\n    init,\n    pushHistory,\n    undo,\n    redo\n  }\n}","import { observable, action, reaction } from 'mobx'\nimport { defaultTemplate } from 'utils/initData'\nimport { TemplateInfo, Layer, LAYER_TYPE } from 'types'\nimport { cloneDeep } from 'lodash'\nimport undoRedo from 'utils/undoRedo'\n\nlet template: TemplateInfo = Object.assign(defaultTemplate, {\n  layers: defaultTemplate.layers.map(layer => { return {...layer, isSelected: false, isEditing: false, isHover: false, isLocked: false, scale: 1} })\n})\n\nconst localTemplateCache = localStorage.getItem('TEMPLATE')\nif (localTemplateCache) {\n  template = JSON.parse(localTemplateCache)\n}\n\n// 模板store\nexport const templateStore = observable({\n  // 模板\n  template: template,\n  // 当前编辑图层类型\n  layerType: LAYER_TYPE.EMPTY,\n  // 是否需要重新计算图层的高度，比如改变字体大小时需要\n  needUpdateLayerHeight: false,\n  // 图层是否正在移动\n  isMoving: false,\n  canUseUndo: false,\n  canUseRedo: false,\n\n  get layers (): Layer[] {\n    return this.template.layers\n  },\n\n  get activeLayer (): Layer | undefined {\n    return this.layers.find(l => l.isSelected)\n  },\n\n  // 获取最新的模板\n  getTemplate () {\n    const _template = cloneDeep(templateStore.template)\n    _template.layers = _template.layers.map(l => {\n      if (l.type === 'text' && l.style && l.scale) {\n        l.style.fontSize *= l.scale\n      }\n      delete l.isSelected\n      delete l.isEditing\n      delete l.scale\n      // @ts-ignore\n      delete l.clip?.pre\n      return l\n    })\n    return _template\n  },\n\n  // 修改整体模板\n  setTemplate (val: TemplateInfo) {\n    this.template = val\n  },\n\n  // 修改画布尺寸\n  setCanvasSize (size: { width: number; height: number }) {\n    this.template.global.width = size.width\n    this.template.global.height = size.height\n  },\n\n  // 修改全部图层\n  setLayers (layers: Layer[]) {\n    this.template.layers = layers\n  },\n\n  // 修改单个图层\n  setLayer (layer: Layer) {\n    const idx = this.layers.findIndex(l => l.id === layer.id)\n    if (idx > -1 && !this.layers[idx].isLocked) {\n      this.layers[idx] = layer\n    }\n  },\n\n  // 新增单个图层\n  addLayer (layer: Layer) {\n    this.layers.push(layer)\n    this.updateLayerType(layer)\n  },\n\n  // 移除单个图层\n  removeLayer (id: string) {\n    const idx = this.layers.findIndex(l => l.id === id)\n    if (idx > -1 && !this.layers[idx].isLocked) {\n      this.layers.splice(idx, 1)\n      this.setLayerType(LAYER_TYPE.EMPTY)\n    }\n  },\n\n  // 设置图层层级\n  setLayerLevel (id: string, level: number) {\n    const idx = this.layers.findIndex(l => l.id === id)\n    if (idx > -1) {\n      this.layers[idx].zIndex = level\n    }\n  },\n\n  // 选择图层\n  selectLayer (id: string) {\n    this.layers.forEach(layer => {\n      layer.isSelected = layer.id === id\n      if (layer.isSelected) {\n        this.updateLayerType(layer)\n      }\n    })\n    // 隐藏一些下拉组件\n    document.dispatchEvent(new Event('mousedown'))\n  },\n\n  // 鼠标经过图层\n  hoverLayer (id?: string) {\n    this.layers.forEach(layer => {\n      layer.isHover = id ? layer.id === id : false\n    })\n  },\n\n  // 更新图层类型\n  updateLayerType (layer: Layer) {\n    switch (layer.type) {\n      case 'image': this.setLayerType(LAYER_TYPE.IMAGE); break;\n      case 'text': this.setLayerType(LAYER_TYPE.TEXT); break;\n      case 'rect': this.setLayerType(LAYER_TYPE.RECT); break;\n      case 'circle': this.setLayerType(LAYER_TYPE.CIRCLE); break;\n    }\n  },\n\n  // 设置当前选择的图层类型\n  setLayerType (type: LAYER_TYPE) {\n    this.layerType = type\n  },\n\n  // 设置图层编辑状态(文字编辑、图片裁剪)\n  setEditStatus (id: string) {\n    if (this.layers.some(l => l.id === id && l.isLocked)) return\n    this.layers.forEach(layer => {\n      layer.isEditing = layer.id === id\n    })\n  },\n\n  // 设置图层锁定状态\n  setLayerLock (id: string, isLocked: boolean) {\n    const idx = this.layers.findIndex(l => l.id === id)\n    if (idx > -1) {\n      this.layers[idx].isLocked = isLocked\n      this.layers[idx].isEditing = false\n    }\n  },\n\n  // 重置所有图层选中状态\n  resetSelectStatus () {\n    this.layers.forEach(layer => {\n      layer.isSelected = false\n    })\n    this.setLayerType(LAYER_TYPE.EMPTY)\n  },\n\n  // 重置所有文字图层编辑状态\n  resetEditStatus () {\n    this.layers.forEach(layer => {\n      layer.isEditing = false\n    })\n  },\n\n  // 设置背景色\n  setBackgroundColor (color: string) {\n    this.template.background.color = color\n  },\n\n  // 设置needUpdateLayerHeight\n  setNeedUpdateLayerHeight (val: boolean) {\n    this.needUpdateLayerHeight = val\n  },\n\n  // 设置isMoving\n  setIsMoving (val: boolean) {\n    this.isMoving = val\n  },\n\n  setCanUseUndo (val: boolean) {\n    this.canUseUndo = val\n  },\n\n  setCanUseRedo (val: boolean) {\n    this.canUseRedo = val\n  },\n}, {\n  setTemplate: action.bound,\n  getTemplate: action.bound,\n  setCanvasSize: action.bound,\n  setLayers: action.bound,\n  setLayer: action.bound,\n  addLayer: action.bound,\n  removeLayer: action.bound,\n  selectLayer: action.bound,\n  setLayerLevel: action.bound,\n  hoverLayer: action.bound,\n  updateLayerType: action.bound,\n  setLayerType: action.bound,\n  setEditStatus: action.bound,\n  setLayerLock: action.bound,\n  resetSelectStatus: action.bound,\n  resetEditStatus: action.bound,\n  setBackgroundColor: action.bound,\n  setNeedUpdateLayerHeight: action.bound,\n  setIsMoving: action.bound,\n  setCanUseUndo: action.bound,\n  setCanUseRedo: action.bound\n})\n\n// 撤销重做\nconst { init, pushHistory } = undoRedo()\ninit(template)\n\n// 切换图层时重置文字编辑状态\n// 清空空文字图层\nreaction(\n  () => templateStore.layers.map(l => l.isSelected).join(''),\n  () => {\n    templateStore.resetEditStatus()\n    const idx = templateStore.layers.findIndex(l => l.type === 'text' && !l.source.content?.replaceAll(/\\n/g, ''))\n    if (idx > -1) {\n      templateStore.removeLayer(templateStore.layers[idx].id)\n    }\n  }\n)\n\n// 保存到本地\nconst save = () => {\n  const template = cloneDeep(templateStore.template)\n  template.layers = template.layers.map(l => {\n    l.isSelected = false\n    l.isEditing = false\n    l.isHover = false\n    return l\n  })\n  localStorage.setItem('TEMPLATE', JSON.stringify(template))\n}\n\n// 侦听保存\nreaction(\n  () => {\n    const template = cloneDeep(templateStore.template)\n    template.layers = template.layers.map(l => {\n      delete l.isSelected\n      delete l.isEditing\n      delete l.isHover\n      return l\n    })\n    return JSON.stringify(template)\n  },\n  () => { save(); pushHistory() },\n  {\n    delay: 500\n  }\n)\n","import { Layer, Coords } from 'types'\n\n// 创建图片图层\nexport const createImage = (width: number, height: number, url: string, position: Coords, zIndex: number): Layer => {\n  return {\n    id: String(Date.now()),\n    type: 'image',\n    width: width,\n    height: height,\n    position,\n    rotate: 0,\n    reverse: {\n      x: 1,\n      y: 1\n    },\n    source: {\n      imageUrl: url\n    },\n    clip: {\n      width: width,\n      height: height,\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      pre: {\n        width: width,\n        height: height,\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n      }\n    },\n    opacity: 1,\n    zIndex,\n    isSelected: true,\n    isEditing: false,\n    isLocked: false,\n    scale: 1\n  }\n}\n\n// 创建文字图层\nexport const createText = (position: Coords, zIndex: number, style: any): Layer => {\n  const {\n    width,\n    height,\n    fontWeight,\n    fontSize\n  } = style\n\n  return {\n    id: String(Date.now()),\n    type: 'text',\n    width,\n    height,\n    position,\n    rotate: 0,\n    source: {\n      content: '双击编辑文字'\n    },\n    style: {\n      font: '微软雅黑',\n      fontSize,\n      lineHeight: 1.2,\n      color: '#000',\n      textAlign: 'left',\n      fontWeight,\n      underline: false\n    },\n    opacity: 1,\n    zIndex,\n    isSelected: true,\n    isEditing: true,\n    isLocked: false,\n    scale: 1\n  }\n}\n\n// 创建矩形图层\nexport const createRect = (width: number = 200, height: number = 200, position: Coords, zIndex: number): Layer => {\n  return {\n    id: String(Date.now()),\n    type: 'rect',\n    width: width,\n    height: height,\n    position,\n    source: {},\n    rotate: 0,\n    opacity: 1,\n    rectInfo: {\n      fill: '#fff',\n      borderWidth: 6,\n      borderColor: '#000',\n      borderStyle: 'solid'\n    },\n    zIndex,\n    isSelected: true,\n    isEditing: false,\n    isLocked: false\n  }\n}\n\n// 创建圆形图层\nexport const createCircle = (width: number = 200, height: number = 200, position: Coords, zIndex: number): Layer => {\n  return {\n    id: String(Date.now()),\n    type: 'circle',\n    width: width,\n    height: height,\n    position,\n    source: {},\n    rotate: 0,\n    opacity: 1,\n    circleInfo: {\n      fill: '#fff',\n      borderWidth: 6,\n      borderColor: '#000',\n      borderStyle: 'solid'\n    },\n    zIndex,\n    isSelected: true,\n    isEditing: false,\n    isLocked: false\n  }\n}","import styled from '@emotion/styled'\nimport { ImageItem as ImageInfo } from 'types/image'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { DragEvent } from 'react'\nimport { createImage } from 'utils/createNewLayer'\n\nexport default observer(({ image }: { image: ImageInfo }) => {\n  const { template, layers, addLayer, resetSelectStatus } = templateStore\n\n  // 使用图片\n  const onUseImage = () => {\n    const position = {\n      x: (template.global.width - image.webformatWidth) / 2,\n      y: (template.global.height - image.webformatHeight) / 2\n    }\n    const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n    const newLayer = createImage(image.webformatWidth, image.webformatHeight, image.webformatURL, position, zIndex)\n\n    resetSelectStatus()\n    addLayer(newLayer)\n  }\n\n  // 拖拽图片\n  const onDragStartCapture = (e: DragEvent<HTMLDivElement>) => {\n    e.dataTransfer.setData('image', JSON.stringify(image))\n  }\n\n  return <Image\n    style={{\n      flexBasis: `${100 * image.webformatWidth / image.webformatHeight}px`\n    }}\n    draggable=\"true\"\n    onClick={onUseImage}\n    onDragStartCapture={onDragStartCapture}\n  >\n    <img src={image.webformatURL} alt=\"\" draggable=\"false\" />\n  </Image>\n})\n\nconst Image = styled.div`\n  position: relative;\n  margin: 0 10px 10px 0;\n  background-color: #f0f1f4;\n  overflow: hidden;\n  flex-grow: 1;\n  cursor: pointer;\n\n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #000;\n    opacity: 0;\n    transition: opacity 100ms;\n  }\n\n  &:hover::before {\n    opacity: .2;\n  }\n\n  &:active::before {\n    opacity: 0;\n  }\n\n  img {\n    min-width: 100%;\n    height: 100px;\n    object-fit: cover;\n  }\n`","import { templateStore } from 'store/template'\nimport { Button } from 'antd'\nimport { observer } from 'mobx-react'\nimport { createText } from 'utils/createNewLayer'\n\nexport default observer(() => {\n  const { template, layers, addLayer, resetSelectStatus, setEditStatus } = templateStore\n\n  // 新增文本\n  const onUseText = (type: 'title' | 'text' | 'subTitle') => {\n    let style = {\n      width: 600,\n      height: 114,\n      fontWeight: 700,\n      fontSize: 95\n    }\n\n    if (type === 'subTitle') {\n      style = {\n        width: 380,\n        height: 72,\n        fontWeight: 700,\n        fontSize: 60\n      }\n    }\n\n    if (type === 'text') {\n      style = {\n        width: 300,\n        height: 48,\n        fontWeight: 400,\n        fontSize: 40\n      }\n    }\n\n    const position = {\n      x: (template.global.width - style.width) / 2,\n      y: (template.global.height - style.height) / 2\n    }\n    const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n    const newLayer = createText(position, zIndex, style)\n\n    resetSelectStatus()\n    addLayer(newLayer)\n    setEditStatus(newLayer.id)\n  }\n\n  return <>\n    <Button size=\"large\" style={{ width: '100%', height: 40, fontWeight: 700 }} onClick={() => onUseText('title')}>\n      添加标题\n    </Button>\n    <Button size=\"middle\" style={{ width: '100%', height: 36, fontWeight: 500, marginTop: 20 }} onClick={() => onUseText('subTitle')}>\n      添加副标题\n    </Button>\n    <Button size=\"small\" style={{ width: '100%', height: 32, marginTop: 20 }} onClick={() => onUseText('text')}>\n      添加正文\n    </Button>\n  </>\n})\n","import styled from '@emotion/styled'\nimport { templateStore } from 'store/template'\nimport { DragEvent } from 'react'\nimport { observer } from 'mobx-react'\nimport { createRect, createCircle } from 'utils/createNewLayer'\n\nexport const Rect = observer(() => {\n  const { template, layers, addLayer, resetSelectStatus } = templateStore\n  const onUseRect = () => {\n    const position = {\n      x: (template.global.width - 200) / 2,\n      y: (template.global.height - 200) / 2\n    }\n    const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n    const newLayer = createRect(200, 200, position, zIndex)\n\n    resetSelectStatus()\n    addLayer(newLayer)\n  }\n\n  // 拖拽\n  const onDragStartCapture = (e: DragEvent<HTMLDivElement>) => {\n    e.dataTransfer.setData('rect', '1')\n  }\n\n  return <RectItem draggable=\"true\" onClick={onUseRect} onDragStartCapture={onDragStartCapture} />\n})\n\nexport const Circle = observer(() => {\n  const { template, layers, addLayer, resetSelectStatus } = templateStore\n  const onUseCircle = () => {\n    const position = {\n      x: (template.global.width - 200) / 2,\n      y: (template.global.height - 200) / 2\n    }\n    const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n    const newLayer = createCircle(200, 200, position, zIndex)\n\n    resetSelectStatus()\n    addLayer(newLayer)\n  }\n\n  // 拖拽\n  const onDragStartCapture = (e: DragEvent<HTMLDivElement>) => {\n    e.dataTransfer.setData('circle', '1')\n  }\n\n  return <CircleItem draggable=\"true\" onClick={onUseCircle} onDragStartCapture={onDragStartCapture} />\n})\n\nconst RectItem = styled.div`\n  position: relative;\n  width: 60px;\n  height: 60px;\n  margin-right: 10px;\n  border: 4px solid #000;\n  background-color: transparent;\n  cursor: pointer;\n\n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #000;\n    opacity: 0;\n    transition: opacity 100ms;\n  }\n\n  &:hover::before {\n    opacity: .15;\n  }\n\n  &:active::before {\n    opacity: 0;\n  }\n`\n\nconst CircleItem = styled(RectItem)`\n  border-radius: 50%;\n  &::before {\n    border-radius: 50%;\n  }\n`","import styled from '@emotion/styled'\nimport { templateStore } from 'store/template'\nimport { Button } from 'antd'\nimport { observer } from 'mobx-react'\nimport { createImage } from 'utils/createNewLayer'\n\nexport default observer(() => {\n  const { template, layers, addLayer, resetSelectStatus } = templateStore\n\n  // 选择图片\n  const uploadImage = (e: any) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(e.target.files[0])\n    reader.onload = el => {\n      const url = el.target?.result\n      if (typeof url === 'string') {\n        const img = new Image()\n        img.src = url\n        img.onload = () => {\n          onUseImage(img.width, img.height, url)\n        }\n      }\n    }\n  }\n\n  // 使用图片\n  const onUseImage = (width: number, height: number, url: string) => {\n    const position = {\n      x: (template.global.width - width) / 2,\n      y: (template.global.height - height) / 2\n    }\n    const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n    const newLayer = createImage(width, height, url, position, zIndex)\n\n    resetSelectStatus()\n    addLayer(newLayer)\n  }\n\n  return <>\n    <UploadButton htmlFor=\"uploadImage\">\n      <Button size=\"large\">\n        选择本地图片\n      </Button>\n    </UploadButton>\n    <input type=\"file\" id=\"uploadImage\" accept=\"image/*\" style={{ display: 'none' }} onChange={uploadImage} />\n  </>\n})\n\nconst UploadButton = styled.label`\n  display: block;\n  width: 100%;\n  margin-bottom: 16px;\n  cursor: pointer;\n\n  button {\n    width: 100%;\n    pointer-events: none;\n  }\n`","import styled from '@emotion/styled'\nimport { useState, useEffect } from 'react'\nimport { ImageItem as ImageInfo, SearchQuery } from 'types/image'\nimport { getImages } from 'services/common'\nimport { Collapse } from 'antd'\nimport { FilterOutlined } from '@ant-design/icons'\nimport { Popover, Input, Button } from 'antd'\nimport ImageItem from './ImageItem'\nimport TextItem from './TextItem'\nimport { Rect, Circle } from './Shapes'\nimport UploadImage from './UploadImage'\n\nconst { Panel } = Collapse\nconst { Search } = Input\n\nlet ajaxLock = false\nlet isLoadMore = false\n\nexport default function Sidebar () {\n  // 图片列表\n  const [list, setList] = useState<ImageInfo[]>([])\n  // 图片查询参数\n  const [query, setQuery] = useState<Partial<SearchQuery>>({\n    page: 1,\n    per_page: 20,\n    image_type: 'all',\n    q: '',\n    orientation: 'all',\n    safesearch: true\n  })\n\n  const [showFilter, setShowFilter] = useState(false)\n\n  useEffect(() => {\n    getImages(query).then((data: any) => {\n      if (isLoadMore) {\n        setList(list => list.concat(data.hits))\n      } else {\n        setList(data.hits)\n      }\n    }).finally(() => {\n      ajaxLock = false\n    })\n  }, [query])\n\n  // 加载更多图片\n  const onLoadMore = () => {\n    if (ajaxLock) return\n    ajaxLock = true\n    const page = query.page\n    isLoadMore = true\n    setQuery(Object.assign({}, query, {\n      page: page ? page + 1 : 1\n    }))\n  }\n\n  // 图片筛选面板\n  const FilterPanel = () => {\n    const onSearch = (val: string, e: any) => {\n      e.preventDefault()\n      if (val) {\n        isLoadMore = false\n        setQuery(Object.assign({}, query, {\n          q: val,\n          page: 1\n        }))\n      }\n    }\n\n    const Content = () => {\n      return <>\n        <Search placeholder=\"搜索\" onSearch={onSearch} style={{ width: 200 }} />\n      </>\n    }\n\n    return <Popover\n      content={Content}\n      title=\"筛选\"\n      trigger=\"click\"\n      visible={showFilter}\n      onVisibleChange={visible => setShowFilter(visible)}\n    >\n      <FilterOutlined onClick={(e) => { e.stopPropagation(); setShowFilter(true) }} />\n    </Popover>\n  }\n\n  return <Side>\n    <Collapse defaultActiveKey={['1']} collapsible=\"header\">\n      <Panel header={<div style={{ width: '300px' }}>图片</div>} key=\"1\" extra={FilterPanel()}>\n        <ListContent>\n          <UploadImage />\n          {list.map(image => <ImageItem key={image.id} image={image} />)}\n          <Button style={{ width: '100%', marginTop: '20px' }} onClick={onLoadMore}>加载更多</Button>\n      </ListContent>\n      </Panel>\n      <Panel header={<div style={{ width: '300px' }}>文字</div>} key=\"2\">\n        <ListContent>\n          <TextItem />\n        </ListContent>\n      </Panel>\n      <Panel header={<div style={{ width: '300px' }}>形状</div>} key=\"3\">\n        <ListContent>\n          <Rect />\n          <Circle />\n        </ListContent>\n      </Panel>\n    </Collapse>\n  </Side>\n}\n\nconst Side = styled.aside`\n  flex: none;\n  display: flex;\n  flex-direction: column;\n  width: 400px;\n  height: 100%;\n  background-color: #fff;\n  border-right: 1px solid #ddd;\n  overflow-y: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #fff;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n\n  .ant-collapse {\n    border: 0;\n    background-color: #fff;\n  }\n`\n\nconst ListContent = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  padding-left: 10px;\n  user-select: none;\n\n  &:after {\n    content: '';\n    display: block;\n    flex-grow: 99999;\n  }\n`\n","import ajax from './base'\n\nconst key = '24178889-8dbe9fccf0c585814c1dcb342'\n\nexport const getImages = (params: any): any => {\n  return ajax({\n    url: '/',\n    params: {\n      key,\n      lang: 'zh',\n      ...params\n    }\n  })\n}\n","import styled from '@emotion/styled'\nimport { Slider } from 'antd'\nimport UndoIcon from 'assets/undo.png'\nimport RedoIcon from 'assets/redo.png'\nimport undoRedo from 'utils/undoRedo'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\n\nconst { undo, redo } = undoRedo()\n\nexport default observer(({ scale, setScale, responsive }: { scale: number; setScale: (n: number) => void; responsive: () => void }) => {\n  const { canUseUndo, canUseRedo } = templateStore\n\n  const scaleChange = (val: number) => {\n    setScale(val / 100)\n  }\n\n  return <FooterBar>\n    <SliderWrapper>\n      <Slider\n        className=\"slider\"\n        tipFormatter={null}\n        value={scale * 100}\n        min={10} max={500}\n        onChange={scaleChange}\n      />\n      <ToolItem className=\"scale active\" onClick={responsive}>{Math.round(scale * 100)}%</ToolItem>\n    </SliderWrapper>\n    <UndoRedo>\n      <ToolItem className={ canUseUndo ? 'active' : '' } onClick={undo}><img src={UndoIcon} alt=\"\" /></ToolItem>\n      <ToolItem className={ canUseRedo ? 'active' : '' } onClick={redo}><img src={RedoIcon} alt=\"\" /></ToolItem>\n    </UndoRedo>\n  </FooterBar>\n})\n\nconst FooterBar = styled.footer`\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  width: 100%;\n  height: 44px;\n  padding: 0 40px;\n  background-color: #fff;\n  border-top: 1px solid #ddd;\n\n  .slider {\n    width: 240px;\n  }\n\n  .scale {\n    /* width: 100px; */\n    margin: 0 20px;\n  }\n`\n\nconst SliderWrapper = styled.div`\n  display: flex;\n  align-items: center;\n`\n\nconst UndoRedo = styled.div`\n  display: flex;\n  justify-content: space-around;\n  width: 120px;\n\n  img {\n    width: 22px;\n    height: 22px;\n    pointer-events: none;\n    user-select: none;\n  }\n`\n\nconst ToolItem = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 6px 8px;\n  border-radius: 4px;\n  cursor: not-allowed;\n  opacity: .5;\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  &.active {\n    opacity: 1;\n    cursor: pointer;\n  }\n`","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArRJREFUWEfFl09rE1EQwGfyB/SgKOjBQz1IIeBBEPsB6tFL8uZBCiIIgiiKigcpiKDtwYJ4kFpQiAh68WDovrdRWMGDfoAW9KBURRCUigoe9BJD3o5syZbNZje7G5P4IITMmzfzezPzZgjCf16Yxj8RXQWAeWae11rPpTmTVicRQAhxGREXfIPDhugLQESXAOBm8DaI+MCyrBNpb5ikFwtARBcAYDFk4I3rujO2bb9NMpx2PxJACHEGEe+M2rlnvwdASnmSme+Nw3kPABEdB4CHEeHzIvKtIzfM7HqrUCgY79v7DQCe/Hur1friOM6vzCkQQhxFxEdpDyborSGicl13WWu92k93IwXVanWy3W5/GJLzLjOIWDPGLMYV7mYNENFjj2UUEAAQ+3q6ijAOwms+acAQcQIASp3PrjSF3PMKoiAG6X5CiNuIeD4JIrIPDBFiGhFfhDppzbKs076sXyeMqolZpVRXa05KTblcLuXz+bWgHjNP+a8jaRb0QLiue8y27UzPVQgxi4g3Nm+NeMWyrI0BlzgNw+kYdBgR0U8A2NmBeKWUOpgKwFMKQDxn5lNa609JoQ/vE9EKABzy5caY7Y1G43diBPwDQoi5YrG4UK/XW1mdhy7hHy8ppd6nBhjEafCMdwFEvObLmPmw1vrl2ACIaBkAZABgUmv9cWwAUsrXzHzAB2g2m1scx/kzFoBKpTKRy+XeAcDWDsAzpdSR1K/gX/MvpVxi5nOB8J/VWt8dCwAReRPWa2j+WkfEKcuyvo4cQEp5i5kvhtpw13+LodeAEGJHoVDYb4y5DgDTofTVlVIzQVlmgGq1utsYc5+Zt0XUxl4A2BdTMz3OB0qBEKJnxKYo0kjn4wBYZeaa1roWB5k5BVLKPcy8HmPwBwB8RsQVZn6ilHqaFJ3MAEkGs+7/BQfySDDlTlsQAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAqtJREFUWEfFljGrE0EQx2duQ0yjiKA2TxBEfWjhg2dno1gdaLJzD2MlKOLDRkUtLCx8tqIgPEGwULASD243ATvB9wVEsBCEh4qChQqKFlpcMrIhd1wul9wuOXEhhGRn5v+7uZ2ZRfjPC6vWl1KuIOINAGgrpcKy+JUCZMQT3VKISgGCIHjEzKdzTz0VolKAVqu1z/O8pwCw3xaiUgAj6gpROYArhBOA7/ub6vX6HCJuAwCBiJ5ZcRwL821+m/8NBDNvB4D7BVUwciZKAaSUi57nLTEzAcB8WVlZ7qcQEwHMuxRCXGLmZcugTma1Wm13GIbrhQDDg/QMAHY6RbU3DpVSbWM+BiClPIyILwpifQOAt+bDzJ9stIYdMW+aio8BSCkXhuKbs17MvKq1vmgjmtgUdEWzNSI+BkBEpomcyIkf0VqvuYgT0RUAuJPzGRMfASCiMwDwMOvU6/Xmu92uSbv1IqJzAPDARnwEIAiCx8x8KnFk5mta61vWygAQBMFJZn5iK57PwPvMqf+ulNriIm5sC4ZRYdqzcQdV0Gw2NwohfmY2XiqlDroC5OZAqXiaASLaMyyxRNPKuQjQQCBiW2u9YvMAgwzka5+Zb9oGsBGZZpMA7ELE9YxhpJRamjW4jf8AwPf9DY1G40/igIivoyg6YBNgVpu0FRPRKwBYGAb83e/393Y6HauWOwtEFsDM7vOZLNyLoujCLMFtfFMAKeVRRHyecyq91dqIlB7CxEBKeRsRr440CsS7URRdnlVokv/YOM6dhcRvTQhxPY7jN1rrH1XCFF5IiOgLAGydIPQOAD7m9xDxlxDibBiGX10AJ17JikZzWWBmdh7dUy+lUsplRDR3wsUycbNfOUAiSkTHEPE4M5sBtWPC6/nMzIe01h9sYNNydzH+F7Z/AWqi/yEtgkl8AAAAAElFTkSuQmCC\"","import { createContext } from 'react'\nexport const ScaleContext = createContext<number>(1)\nexport const BackgroundContext = createContext<any>(null)","import { MouseEvent as MouseEventType } from 'react'\n\nexport class MouseEvents {\n  constructor (e: MouseEventType<HTMLElement>, handleMove: (payload: any) => void, handleUp?: () => void) {\n    this.mouseDown(e)\n    this.handleMove = handleMove\n    handleUp && (this.handleUp = handleUp)\n  }\n  \n  private handleMove = (payload: any) => {}\n  private handleUp = () => {}\n\n  private startCoords = {\n    x: 0,\n    y: 0\n  }\n\n  private preCoords = {\n    x: 0,\n    y: 0\n  }\n\n  private mouseUp = () => {\n    document.onmousemove = null\n    document.onmouseup = null\n    this.handleUp()\n  }\n\n  private mouseMove = (event: any) => {\n    const diffX = event.clientX - this.preCoords.x\n    const diffY = event.clientY - this.preCoords.y\n    const preCoords = {\n      x: this.preCoords.x,\n      y: this.preCoords.y\n    }\n    this.handleMove({\n      diff: {\n        x: diffX,\n        y: diffY\n      },\n      startCoords: this.startCoords,\n      curCoords: this.preCoords,\n      preCoords: preCoords\n    })\n    this.preCoords = {\n      x: event.clientX,\n      y: event.clientY\n    }\n  }\n\n  private mouseDown = (e: MouseEventType<HTMLElement>) => {\n    this.startCoords = {\n      x: e.clientX,\n      y: e.clientY\n    }\n    this.preCoords = {\n      x: e.clientX,\n      y: e.clientY\n    }\n    document.onmousemove = this.mouseMove\n    document.onmouseup = this.mouseUp\n  }\n}","import { Layer, POINT_TYPE, Coords } from 'types'\nimport { getCenterCoords, calcRotatedCoords } from 'utils'\n\nconst MIN_SIZE = {\n  width: 10,\n  height: 10\n}\n\n/**\n * 无旋转处理\n * @param layer 图层信息\n * @param point 拖动的点类型\n * @param diff 鼠标上次和当前移动的xy差值\n * @param scale 画布缩放\n * @param lockRatio 是否锁定比例\n * @returns \n */\nexport function normalResize (layer: Layer, point: POINT_TYPE, diff: Coords, scale: number, lockRatio: boolean): Layer {\n  const whRatio = layer.width / layer.height\n  let { x: newX, y: newY } = layer.position\n  let { width: newWidth, height: newHeight } = layer\n  const { x, y } = diff\n  switch (point) {\n    case POINT_TYPE.TL: {\n      const height = layer.height\n      newWidth -= x / scale\n      newX += x / scale\n      if (lockRatio) {\n        newHeight = newWidth / whRatio\n      } else {\n        newHeight -= y / scale\n      }\n      newY -= newHeight - height\n      break\n    }\n    case POINT_TYPE.TR: {\n      const height = layer.height\n      newWidth += x / scale\n      if (lockRatio) {\n        newHeight = newWidth / whRatio\n      } else {\n        newHeight -= y / scale\n      }\n      newY -= newHeight - height\n      break\n    }\n    case POINT_TYPE.BL: {\n      newWidth -= x / scale\n      newX += x / scale\n      if (lockRatio) {\n        newHeight = newWidth / whRatio\n      } else {\n        newHeight += y / scale\n      }\n      break\n    }\n    case POINT_TYPE.BR: {\n      newWidth += x / scale\n      if (lockRatio) {\n        newHeight = newWidth / whRatio\n      } else {\n        newHeight += y / scale\n      }\n      break\n    }\n    case POINT_TYPE.T: {\n      newHeight -= y / scale\n      newY += y / scale\n      break\n    }\n    case POINT_TYPE.B: {\n      newHeight += y / scale\n      break\n    }\n    case POINT_TYPE.L: {\n      newWidth -= x / scale\n      newX += x / scale\n      break\n    }\n    case POINT_TYPE.R: {\n      newWidth += x / scale\n      break\n    }\n  }\n\n  if ((newWidth > MIN_SIZE.width && newHeight > MIN_SIZE.height) || newWidth > layer.width || newHeight > layer.height) {\n    if (newWidth > MIN_SIZE.width) {\n      layer.width = newWidth\n      layer.position.x = newX\n    }\n    if (newHeight > MIN_SIZE.height) {\n      layer.height = newHeight\n      layer.position.y = newY\n    }\n  }\n\n  return layer\n}\n\n/**\n * 有旋转处理\n * @param point 拖动的点类型\n * @param curPoint 鼠标相对于画布左上角的坐标\n * @param symmetricPoint 对称点\n * @param pointCenter 当前拖动的点/边元素的中心位置\n * @param info 图层信息props\n * @param layer 最新的图层信息\n * @param whRatio 宽高比\n * @param scale 画布缩放值\n * @param lockRatio 是否锁定比例\n * @returns 返回调整后的图层信息\n */\nexport function rotateResize (point: POINT_TYPE, curPoint: Coords, symmetricPoint: Coords, pointCenter: Coords, info: Layer, layer: Layer, whRatio: number, scale: number, lockRatio: boolean): Layer {\n  switch (point) {\n    case POINT_TYPE.TL: {\n      // 根据鼠标当前位置和对称点获取最新中心点\n      let newCenterPoint = getCenterCoords(curPoint, symmetricPoint)\n      // 获取旋转前的左上角坐标\n      let newOriginCurPoint = calcRotatedCoords(curPoint, newCenterPoint, -info.rotate)\n      // 获取旋转前的对称点坐标\n      let newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n      let newWidth = newOriginSymmetricPoint.x - newOriginCurPoint.x\n      let newHeight = newOriginSymmetricPoint.y - newOriginCurPoint.y\n\n      if (lockRatio) {\n        // 获取等比缩放计算后的坐标\n        if (newWidth / newHeight > whRatio) {\n          newOriginCurPoint.x += Math.abs(newWidth - newHeight * whRatio)\n        } else {\n          newOriginCurPoint.y += Math.abs(newHeight - newWidth / whRatio)\n        }\n\n        // 由于现在求的未旋转前的坐标是以没按比例缩减宽高前的坐标来计算的\n        // 所以缩减宽高后，需要按照原来的中心点旋转回去，获得缩减宽高并旋转后对应的坐标\n        // 然后以这个坐标和对称点获得新的中心点，并重新计算未旋转前的坐标\n        const latestOriginCurPoint = calcRotatedCoords(newOriginCurPoint, newCenterPoint, info.rotate)\n        newCenterPoint = getCenterCoords(latestOriginCurPoint, symmetricPoint)\n        newOriginCurPoint = calcRotatedCoords(latestOriginCurPoint, newCenterPoint, -info.rotate)\n        newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n        newWidth = newOriginSymmetricPoint.x - newOriginCurPoint.x\n        newHeight = newOriginSymmetricPoint.y - newOriginCurPoint.y\n      }\n\n      if (newWidth / scale > MIN_SIZE.width && newHeight / scale > MIN_SIZE.height) {\n        layer.width = newWidth / scale\n        layer.height = newHeight / scale\n        layer.position.y = newOriginCurPoint.y / scale\n        layer.position.x = newOriginCurPoint.x / scale\n      }\n      break\n    }\n\n    case POINT_TYPE.TR: {\n      let newCenterPoint = getCenterCoords(curPoint, symmetricPoint)\n      // 获取旋转前的右上角坐标\n      let newOriginCurPoint = calcRotatedCoords(curPoint, newCenterPoint, -info.rotate)\n      let newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n      let newWidth = newOriginCurPoint.x - newOriginSymmetricPoint.x\n      let newHeight = newOriginSymmetricPoint.y - newOriginCurPoint.y\n\n      if (lockRatio) {\n        if (newWidth / newHeight > whRatio) {\n          newOriginCurPoint.x -= Math.abs(newWidth - newHeight * whRatio)\n        } else {\n          newOriginCurPoint.y += Math.abs(newHeight - newWidth / whRatio)\n        }\n\n        const latestOriginCurPoint = calcRotatedCoords(newOriginCurPoint, newCenterPoint, info.rotate)\n        newCenterPoint = getCenterCoords(latestOriginCurPoint, symmetricPoint)\n        newOriginCurPoint = calcRotatedCoords(latestOriginCurPoint, newCenterPoint, -info.rotate)\n        newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n        newWidth = newOriginCurPoint.x - newOriginSymmetricPoint.x\n        newHeight = newOriginSymmetricPoint.y - newOriginCurPoint.y\n      }\n\n      if (newWidth / scale > MIN_SIZE.width && newHeight / scale > MIN_SIZE.height) {\n        layer.width = newWidth / scale\n        layer.height = newHeight / scale\n        layer.position.y = newOriginCurPoint.y / scale\n        layer.position.x = newOriginSymmetricPoint.x / scale\n      }\n      break\n    }\n\n    case POINT_TYPE.BR: {\n      let newCenterPoint = getCenterCoords(curPoint, symmetricPoint)\n      // 获取旋转前的右下角坐标\n      let newOriginCurPoint = calcRotatedCoords(curPoint, newCenterPoint, -info.rotate)\n      let newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n      let newWidth = newOriginCurPoint.x - newOriginSymmetricPoint.x\n      let newHeight = newOriginCurPoint.y - newOriginSymmetricPoint.y\n\n      if (lockRatio) {\n        if (newWidth / newHeight > whRatio) {\n          newOriginCurPoint.x -= Math.abs(newWidth - newHeight * whRatio)\n        } else {\n          newOriginCurPoint.y -= Math.abs(newHeight - newWidth / whRatio)\n        }\n\n        const latestOriginCurPoint = calcRotatedCoords(newOriginCurPoint, newCenterPoint, info.rotate)\n        newCenterPoint = getCenterCoords(latestOriginCurPoint, symmetricPoint)\n        newOriginCurPoint = calcRotatedCoords(latestOriginCurPoint, newCenterPoint, -info.rotate)\n        newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n        newWidth = newOriginCurPoint.x - newOriginSymmetricPoint.x\n        newHeight = newOriginCurPoint.y - newOriginSymmetricPoint.y\n      }\n\n      if (newWidth / scale > MIN_SIZE.width && newHeight / scale > MIN_SIZE.height) {\n        layer.width = newWidth / scale\n        layer.height = newHeight / scale\n        layer.position.y = newOriginSymmetricPoint.y / scale\n        layer.position.x = newOriginSymmetricPoint.x / scale\n      }\n      break\n    }\n\n    case POINT_TYPE.BL: {\n      let newCenterPoint = getCenterCoords(curPoint, symmetricPoint)\n      // 获取旋转前的左下角坐标\n      let newOriginCurPoint = calcRotatedCoords(curPoint, newCenterPoint, -info.rotate)\n      let newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n      let newWidth = newOriginSymmetricPoint.x - newOriginCurPoint.x\n      let newHeight = newOriginCurPoint.y - newOriginSymmetricPoint.y\n\n      if (lockRatio) {\n        if (newWidth / newHeight > whRatio) {\n          newOriginCurPoint.x += Math.abs(newWidth - newHeight * whRatio)\n        } else {\n          newOriginCurPoint.y -= Math.abs(newHeight - newWidth / whRatio)\n        }\n\n        const latestOriginCurPoint = calcRotatedCoords(newOriginCurPoint, newCenterPoint, info.rotate)\n        newCenterPoint = getCenterCoords(latestOriginCurPoint, symmetricPoint)\n        newOriginCurPoint = calcRotatedCoords(latestOriginCurPoint, newCenterPoint, -info.rotate)\n        newOriginSymmetricPoint = calcRotatedCoords(symmetricPoint, newCenterPoint, -info.rotate)\n\n        newWidth = newOriginSymmetricPoint.x - newOriginCurPoint.x\n        newHeight = newOriginCurPoint.y - newOriginSymmetricPoint.y\n      }\n\n      if (newWidth / scale > MIN_SIZE.width && newHeight / scale > MIN_SIZE.height) {\n        layer.width = newWidth / scale\n        layer.height = newHeight / scale\n        layer.position.y = newOriginSymmetricPoint.y / scale\n        layer.position.x = newOriginCurPoint.x / scale\n      }\n      break\n    }\n\n    case POINT_TYPE.T:\n    case POINT_TYPE.B: {\n      // 由于用户拉伸时是以任意角度拉伸的，所以在求得旋转前的坐标时，只取 y 坐标（这里的 x 坐标可能是任意值），x 坐标用 pointCenter 的。\n      // 这个中心点（第二个参数）用 pointCenter, center, symmetricPoint 都可以，只要他们在一条直线上就行\n      const newOriginCurPoint = calcRotatedCoords(curPoint, pointCenter, -info.rotate)\n\n      // 算出旋转前 y 坐标，再用 initCurPoint 的 x 坐标，重新计算它们旋转后对应的坐标\n      const latestCurPoint = calcRotatedCoords({\n        x: pointCenter.x,\n        y: newOriginCurPoint.y\n      }, pointCenter, info.rotate)\n\n      // 用旋转后的坐标和对称点算出新的高度（勾股定理）\n      const newHeight = Math.sqrt((latestCurPoint.x - symmetricPoint.x) ** 2 + (latestCurPoint.y - symmetricPoint.y) ** 2)\n\n      const newCenter = {\n        x: latestCurPoint.x - (latestCurPoint.x - symmetricPoint.x) / 2,\n        y: latestCurPoint.y + (symmetricPoint.y - latestCurPoint.y) / 2\n      }\n\n      // 是否反向拉伸了\n      let isReverse = false\n      const angle = (info.rotate + 360) % 360\n      // 禁止反向拉伸\n      if (point === POINT_TYPE.T) {\n        if ((angle >= 0 && angle <= 90) || (angle >= 270 && angle <= 360)) {\n          if (latestCurPoint.y >= symmetricPoint.y) {\n            isReverse = true\n          }\n        } else if (latestCurPoint.y <= symmetricPoint.y) {\n          isReverse = true\n        }\n      }\n      if (point === POINT_TYPE.B) {\n        if (angle >= 90 && angle <= 270) {\n          if (latestCurPoint.y >= symmetricPoint.y) {\n            isReverse = true\n          }\n        } else if (latestCurPoint.y <= symmetricPoint.y) {\n          isReverse = true\n        }\n      }\n\n      if (newHeight / scale > MIN_SIZE.height && !isReverse) {\n        layer.height = newHeight / scale\n        layer.position.y = (newCenter.y - (newHeight / 2)) / scale\n        layer.position.x = newCenter.x / scale - (layer.width / 2)\n      }\n      break\n    }\n\n    case POINT_TYPE.L:\n    case POINT_TYPE.R: {\n      const newOriginCurPoint = calcRotatedCoords(curPoint, pointCenter, -info.rotate)\n\n      const latestCurPoint = calcRotatedCoords({\n        x: newOriginCurPoint.x,\n        y: pointCenter.y\n      }, pointCenter, info.rotate)\n\n      const newWidth = Math.sqrt((latestCurPoint.x - symmetricPoint.x) ** 2 + (latestCurPoint.y - symmetricPoint.y) ** 2)\n\n      const newCenter = {\n        x: latestCurPoint.x - (latestCurPoint.x - symmetricPoint.x) / 2,\n        y: latestCurPoint.y + (symmetricPoint.y - latestCurPoint.y) / 2\n      }\n\n      // 是否反向拉伸了\n      let isReverse = false\n      const angle = (info.rotate + 360) % 360\n      // 禁止反向拉伸\n      if (point === POINT_TYPE.L) {\n        if ((angle >= 0 && angle <= 90) || (angle >= 270 && angle <= 360)) {\n          if (latestCurPoint.x >= symmetricPoint.x) {\n            isReverse = true\n          }\n        } else if (latestCurPoint.x <= symmetricPoint.x) {\n          isReverse = true\n        }\n      }\n      if (point === POINT_TYPE.R) {\n        if (angle >= 90 && angle <= 270) {\n          if (latestCurPoint.x >= symmetricPoint.x) {\n            isReverse = true\n          }\n        } else if (latestCurPoint.x <= symmetricPoint.x) {\n          isReverse = true\n        }\n      }\n\n      if (newWidth / scale > MIN_SIZE.width && !isReverse) {\n        layer.width = newWidth / scale\n        layer.position.y = newCenter.y / scale - (layer.height / 2)\n        layer.position.x = (newCenter.x - (newWidth / 2)) / scale\n      }\n      break\n    }\n  }\n\n  return layer\n}","import { Layer, POINT_TYPE } from 'types'\n\n// 计算处理图片裁剪\nexport const clipImage = (layer: Layer, point: POINT_TYPE, oldWidth: number, oldHeight: number): Layer => {\n  // 判断是否有翻转，翻转后方向互换\n  if (layer.reverse?.x === -1) {\n    if (point === POINT_TYPE.L) {\n      point = POINT_TYPE.R\n    } else if (point === POINT_TYPE.R) {\n      point = POINT_TYPE.L\n    }\n  }\n  if (layer.reverse?.y === -1) {\n    if (point === POINT_TYPE.T) {\n      point = POINT_TYPE.B\n    } else if (point === POINT_TYPE.B) {\n      point = POINT_TYPE.T\n    }\n  }\n  if (layer.clip) {\n    const imageWhRatio = layer.clip.pre.width / layer.clip.pre.height\n    switch (point) {\n      case POINT_TYPE.BR:\n      case POINT_TYPE.BL:\n      case POINT_TYPE.TL:\n      case POINT_TYPE.TR: {\n        // 全部等比例伸缩\n        const ratio = layer.width / oldWidth\n        layer.clip.width *= ratio\n        layer.clip.height *= ratio\n        layer.clip.top *= ratio\n        layer.clip.left *= ratio\n        layer.clip.right *= ratio\n        layer.clip.bottom *= ratio\n        break\n      }\n      case POINT_TYPE.R: {\n        // 伸缩\n        if (layer.width + layer.clip.left > layer.clip.pre.width) {\n          layer.clip.left *= layer.width / oldWidth\n          layer.clip.top *= layer.width / oldWidth\n          const newWidth = layer.clip.left + layer.width\n          layer.clip.width = newWidth\n          layer.clip.height = newWidth / imageWhRatio\n        // 裁剪\n        } else {\n          layer.clip.left = layer.clip.pre.left\n          layer.clip.top = layer.clip.pre.top\n          layer.clip.width = layer.clip.pre.width\n          layer.clip.height = layer.clip.pre.height\n        }\n        break\n      }\n      case POINT_TYPE.L: {\n        // 伸缩\n        if (layer.width + layer.clip.right > layer.clip.pre.width) {\n          layer.clip.right *= layer.width / oldWidth\n          const newWidth = layer.clip.right + layer.width\n          layer.clip.width = newWidth\n          layer.clip.left = 0\n          layer.clip.top *= layer.width / oldWidth\n          layer.clip.height = newWidth / imageWhRatio\n        // 裁剪\n        } else {\n          layer.clip.left = layer.clip.pre.width - layer.clip.pre.right - layer.width\n          layer.clip.top = layer.clip.pre.top\n          layer.clip.width = layer.clip.pre.width\n          layer.clip.height = layer.clip.pre.height\n          layer.clip.right = layer.clip.pre.right\n          layer.clip.bottom = layer.clip.pre.bottom\n        }\n        break\n      }\n      case POINT_TYPE.B: {\n        // 伸缩\n        if (layer.height + layer.clip.top > layer.clip.pre.height) {\n          layer.clip.top *= layer.height / oldHeight\n          layer.clip.left *= layer.height / oldHeight\n          const newHeight = layer.clip.top + layer.height\n          layer.clip.height = newHeight\n          layer.clip.width = newHeight * imageWhRatio\n        // 裁剪\n        } else {\n          layer.clip.left = layer.clip.pre.left\n          layer.clip.top = layer.clip.pre.top\n          layer.clip.width = layer.clip.pre.width\n          layer.clip.height = layer.clip.pre.height\n        }\n        break\n      }\n      case POINT_TYPE.T: {\n        // 伸缩\n        if (layer.height + layer.clip.bottom > layer.clip.pre.height) {\n          layer.clip.bottom *= layer.height / oldHeight\n          const newHeight = layer.clip.bottom + layer.height\n          layer.clip.height = newHeight\n          layer.clip.top = 0\n          layer.clip.left *= layer.height / oldHeight\n          layer.clip.width = newHeight * imageWhRatio\n        // 裁剪\n        } else {\n          layer.clip.top = layer.clip.pre.height - layer.clip.pre.bottom - layer.height\n          layer.clip.left = layer.clip.pre.left\n          layer.clip.width = layer.clip.pre.width\n          layer.clip.height = layer.clip.pre.height\n          layer.clip.right = layer.clip.pre.right\n          layer.clip.bottom = layer.clip.pre.bottom\n        }\n        break\n      }\n    }\n  }\n  return layer\n}\n\n// 更新上一次的图片的裁剪信息，保存在pre对象里\nexport const updateImageClip = (layer: Layer): Layer => {\n  if (layer.clip) {\n    layer.clip.pre.left = layer.clip.left\n    layer.clip.pre.top = layer.clip.top\n    layer.clip.pre.right = layer.clip.width - layer.clip.left - layer.width\n    layer.clip.pre.bottom = layer.clip.height - layer.clip.top - layer.height\n    layer.clip.pre.width = layer.clip.width\n    layer.clip.pre.height = layer.clip.height\n    layer.clip.right = layer.clip.pre.right\n    layer.clip.bottom = layer.clip.pre.bottom\n  }\n  return layer\n}","export default __webpack_public_path__ + \"static/media/rotate.a7cc796d.svg\";","export default __webpack_public_path__ + \"static/media/lock.7263c59f.svg\";","import { Layer, POINT_TYPE, Coords } from 'types'\nimport { MouseEvent, useContext, useState, useEffect, useCallback } from 'react'\nimport styled from '@emotion/styled'\nimport { ScaleContext } from 'store/context'\nimport { MouseEvents } from 'utils/mouseEvent'\nimport { normalResize, rotateResize } from 'utils/resizeLayer'\nimport { clipImage, updateImageClip } from 'utils/clipImage'\nimport rotateIcon from 'assets/rotate.svg'\nimport lockIcon from 'assets/lock.svg'\nimport { templateStore } from 'store/template'\nimport { cloneDeep } from 'lodash'\nimport { observer } from 'mobx-react'\n\n// 初始的指针角度（左上、上、右上、右）\nconst INIT_ANGLE = [0, 45, 90, 135]\n// 角度范围对应的指针样式\nconst ANGLE_TO_CURSOR = [\n  { start: 0, end: 23, cursor: 'nwse-resize' },\n  { start: 338, end: 360, cursor: 'nwse-resize' },\n  { start: 23, end: 68, cursor: 'ns-resize' },\n  { start: 68, end: 113, cursor: 'nesw-resize' },\n  { start: 113, end: 158, cursor: 'ew-resize' },\n  { start: 158, end: 203, cursor: 'nwse-resize' },\n  { start: 203, end: 248, cursor: 'ns-resize' },\n  { start: 248, end: 293, cursor: 'nesw-resize' },\n  { start: 293, end: 338, cursor: 'ew-resize' }\n]\n\n// 编辑框\nexport default observer(({ info }: { info: Layer; }) => {\n  const scale = useContext(ScaleContext)\n\n  const { layers, setLayer, isMoving, setIsMoving } = templateStore\n\n  // 鼠标样式\n  const [cursors, setCursors] = useState<string[]>([])\n\n  // 调整大小 无旋转\n  const resizeNormal = (e: MouseEvent<HTMLElement>, point: POINT_TYPE) => {\n    const idx = layers.findIndex(layer => layer.id === info.id)\n\n    if (idx > -1) {\n      new MouseEvents(e, (payload) => {\n        const layer = cloneDeep(layers[idx])\n\n        const oldHeight = layer.height\n        const oldWidth = layer.width\n\n        // 普通拖拽框大小\n        let res = normalResize(layer, point, payload.diff, scale, true)\n\n        // 处理文本框缩放\n        if (res.type === 'text') {\n          if (res.height !== oldHeight && res.scale) {\n            res.scale *= res.height / oldHeight\n          }\n        }\n        // 处理图片裁剪\n        if (res.type === 'image') {\n          res = clipImage(res, point, oldWidth, oldHeight)\n        }\n\n        setLayer(res)\n        setIsMoving(true)\n      }, () => {\n        let layer = cloneDeep(layers[idx])\n        if (layer.type === 'image') {\n          // 更新图片裁剪信息\n          layer = updateImageClip(layer)\n          setLayer(layer)\n        }\n        setIsMoving(false)\n      })\n    }\n  }\n\n  // 调整大小 有旋转\n  const resizeWithRotate = (e: MouseEvent<HTMLElement>, point: POINT_TYPE) => {\n    // 图层相对于画布左上角的中心点\n    const center = {\n      x: (info.position.x + info.width / 2) * scale,\n      y: (info.position.y + info.height / 2) * scale\n    }\n\n    // 获取边框圆点中心点\n    const pointRect = (e.target as HTMLElement)?.getBoundingClientRect()\n    const canvasRect = (document.querySelector('#layerControl') as HTMLElement)?.getBoundingClientRect()\n    const pointCenter = {\n      x: pointRect.left - Number(canvasRect.left) + pointRect.width / 2,\n      y: pointRect.top - Number(canvasRect.top) + pointRect.height / 2\n    }\n\n    // 获取对称点\n    const symmetricPoint = {\n      x: center.x - (pointCenter.x - center.x),\n      y: center.y - (pointCenter.y - center.y)\n    }\n\n    const whRatio = info.width / info.height\n    const idx = layers.findIndex(layer => layer.id === info.id)\n\n    new MouseEvents(e, ({ curCoords }: { curCoords: Coords }) => {\n      const layer = cloneDeep(layers[idx])\n\n      const curPoint = {\n        x: curCoords.x - Number(canvasRect.left),\n        y: curCoords.y - Number(canvasRect.top)\n      }\n\n      const oldHeight = layer.height\n      const oldWidth = layer.width\n\n      // 处理旋转的拖拽\n      let res = rotateResize(point, curPoint, symmetricPoint, pointCenter, info, layer, whRatio, scale, true)\n\n      // 处理文本框缩放\n      if (res.type === 'text') {\n        if (res.height !== oldHeight && res.scale) {\n          res.scale *= res.height / oldHeight\n        }\n      }\n      // 处理图片裁剪\n      if (res.type === 'image') {\n        res = clipImage(res, point, oldWidth, oldHeight)\n      }\n\n      setLayer(res)\n      setIsMoving(true)\n    }, () => {\n      let layer = cloneDeep(layers[idx])\n      if (layer.type === 'image') {\n        // 更新图片裁剪信息\n        layer = updateImageClip(layer)\n        setLayer(layer)\n      }\n      setIsMoving(false)\n    })\n  }\n\n  // 调整大小\n  const resize = (e: MouseEvent<HTMLElement>, point: POINT_TYPE) => {\n    e.stopPropagation()\n    if (info.rotate === 0) {\n      resizeNormal(e, point)\n    } else {\n      resizeWithRotate(e, point)\n    }\n  }\n\n  // 旋转\n  const rotate = (e: MouseEvent<HTMLElement>) => {\n    e.stopPropagation()\n    const borderEl = (e.target as HTMLElement).closest('.border-control')\n    if (borderEl) {\n      const rect = borderEl.getBoundingClientRect()\n      const rotateCenterPoint = {\n        x: rect.left + rect.width / 2,\n        y: rect.top + rect.height / 2\n      }\n      new MouseEvents(e, ({ curCoords }: { curCoords: Coords }) => {\n        const offsetY = curCoords.y - rotateCenterPoint.y\n        const offsetX = curCoords.x - rotateCenterPoint.x\n        // 当前距离x轴的角度(x轴起逆时针方向至该边)\n        const angle = Math.atan2(offsetY, offsetX) * 180 / Math.PI\n\n        const idx = layers.findIndex(layer => layer.id === info.id)\n        const layer = cloneDeep(layers[idx])\n        layer.rotate = (angle - 90 + 360) % 360\n\n        setLayer(layer)\n        setIsMoving(true)\n      }, () => {\n        setIsMoving(false)\n      })\n    }\n  }\n\n  // 计算8个圆点的指针样式，按顺序分别为 左上（右下）、上（下）、右上（左下）、右（左）\n  const calcCursors = useCallback(() => {\n    let angle = info.rotate\n    if (angle < 0) {\n      angle += 360\n    }\n    const cursors: string[] = []\n    INIT_ANGLE.forEach((a) => {\n      const newAngle = (a + angle) % 360\n      const item = ANGLE_TO_CURSOR.find(i => i.start <= newAngle && i.end >= newAngle)\n      if (item) {\n        cursors.push(item.cursor)\n      }\n    })\n    setCursors(cursors)\n  }, [info.rotate])\n\n  useEffect(() => {\n    calcCursors()\n  }, [calcCursors])\n\n  return <BorderEl \n    style={{\n      width: info.width * scale,\n      height: info.height * scale,\n      transform: `translate(${info.position.x * scale}px, ${info.position.y * scale}px) rotate(${info.rotate}deg)`\n    }}\n    className={['border-control', isMoving ? 'moving' : ''].join(' ')}\n  >\n    {info.isLocked ?\n      <LockIcon icon={lockIcon} rotate={info.rotate} /> :\n      <>\n        <PointBR style={{ cursor: cursors[0] }} onMouseDown={e => resize(e, POINT_TYPE.BR)} />\n        {info.width * scale > 30 && info.height * scale > 30 && <>\n            <PointTL style={{ cursor: cursors[0] }} onMouseDown={e => resize(e, POINT_TYPE.TL)} />\n            <PointTR style={{ cursor: cursors[2] }} onMouseDown={e => resize(e, POINT_TYPE.TR)} />\n            <PointBL style={{ cursor: cursors[2] }} onMouseDown={e => resize(e, POINT_TYPE.BL)} />\n            <PointL style={{ cursor: cursors[3] }} onMouseDown={e => resize(e, POINT_TYPE.L)} />\n            <PointR style={{ cursor: cursors[3] }} onMouseDown={e => resize(e, POINT_TYPE.R)} />\n            { info.type !== 'text' && <PointT style={{ cursor: cursors[1] }} onMouseDown={e => resize(e, POINT_TYPE.T)} /> }\n            { info.type !== 'text' && <PointB style={{ cursor: cursors[1] }} onMouseDown={e => resize(e, POINT_TYPE.B)} /> }\n          </>\n        }\n        <RotateIcon className='rotate-point' icon={rotateIcon} onMouseDown={rotate} />\n      </>\n    }\n  </BorderEl>\n})\n\nconst BorderEl = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n\n  &.moving .rotate-point {\n    opacity: 0;\n  }\n\n  &.moving span {\n    opacity: 0;\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    right: -1px;\n    bottom: -1px;\n    border: 2px solid #00c4cc;\n  }\n`\n\nconst Point = styled.span`\n  position: absolute;\n  display: block;\n  background: transparent;\n  z-index: 1;\n  pointer-events: auto;\n  width: 18px;\n  height: 18px;\n  user-select: none;\n  transition: opacity 200ms;\n\n  ::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    border-radius: 6px;\n    background: #fff;\n    box-shadow: 0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(53 71 90 / 20%);\n  }\n`\n\nconst PointTL = styled(Point)`\n  top: -9px;\n  left: -9px;\n  cursor: nwse-resize;\n`\n\nconst PointTR = styled(Point)`\n  top: -9px;\n  right: -9px;\n  cursor: nesw-resize;\n`\n\nconst PointBL = styled(Point)`\n  bottom: -9px;\n  left: -9px;\n  cursor: nesw-resize;\n`\n\nconst PointBR = styled(Point)`\n  bottom: -9px;\n  right: -9px;\n  cursor: nwse-resize;\n`\n\nconst PointT = styled(Point)`\n  width: calc(100% - 24px);\n  height: 12px;\n  top: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n`\n\nconst PointB = styled(Point)`\n  width: calc(100% - 24px);\n  height: 12px;\n  bottom: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n`\n\nconst PointL = styled(Point)`\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  left: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n`\n\nconst PointR = styled(Point)`\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  right: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n`\n\nconst RotateIcon = styled.div<{icon: string}>(\n  {\n    position: 'absolute',\n    left: '50%',\n    bottom: '-50px',\n    width: '20px',\n    height: '20px',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    transform: 'translate(-50%, -50%)',\n    pointerEvents: 'auto',\n    borderRadius: '50%',\n    boxShadow: '0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)',\n    userSelect: 'none',\n    cursor: 'grab'\n  },\n  props => ({\n    background: `#fff url(${props.icon}) no-repeat center / 18px 18px`\n  })\n)\n\nconst LockIcon = styled.div<{icon: string; rotate: number}>(\n  {\n    position: 'absolute',\n    right: '0',\n    bottom: '0',\n    width: '20px',\n    height: '20px',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    pointerEvents: 'auto',\n    borderRadius: '50%',\n    boxShadow: '0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)',\n    userSelect: 'none',\n    zIndex: '1'\n  },\n  props => ({\n    background: `#fff url(${props.icon}) no-repeat center / 13px 13px`,\n    transform: `translate(50%, 50%) rotate(${-props.rotate}deg)`\n  })\n)","import { useContext } from 'react'\nimport styled from '@emotion/styled'\nimport { Layer } from 'types'\nimport { ScaleContext } from 'store/context'\n\nexport default function HoverBorder ({ info }: { info: Layer; }) {\n  const scale = useContext(ScaleContext)\n\n  return <BorderEl \n    style={{\n      width: info.width * scale,\n      height: info.height * scale,\n      transform: `translate(${info.position.x * scale}px, ${info.position.y * scale}px) rotate(${info.rotate}deg)`\n    }}\n  />\n}\n\nconst BorderEl = styled.div`\nposition: absolute;\ntop: 0;\nleft: 0;\npointer-events: none;\n\n&:after {\n  content: '';\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n}\n`","import { MouseEvent as MouseEventType, useContext } from 'react'\nimport { createPortal } from 'react-dom'\nimport styled from '@emotion/styled'\nimport { Layer as LayerType } from 'types'\nimport { ScaleContext, BackgroundContext } from 'store/context'\nimport { MouseEvents } from 'utils/mouseEvent'\nimport { helpLine } from 'utils/helpLine'\nimport Border from './Border'\nimport HoverBorder from './HoverBorder'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { cloneDeep } from 'lodash'\n\n// 图层\nexport default observer(({ children, info }: { children: JSX.Element, info: LayerType }) => {\n  const scale = useContext(ScaleContext)\n  const { template, layers, setLayer, selectLayer, hoverLayer, isMoving, setIsMoving } = templateStore\n\n  // 设置背景选中状态\n  const { setIsSelectedBackground } = useContext(BackgroundContext)\n\n  // 辅助线\n  const { getRect: helpLineRect, init: initHelpLine, move: helpLinePipe } = helpLine()\n\n  // 更新图层位置\n  const updatePosition = ({ diff }: { diff: { x: number; y: number; } }) => {\n    const layer = cloneDeep(info)\n\n    const newPosition = helpLinePipe({\n      x: helpLineRect().x + diff.x / scale,\n      y: helpLineRect().y + diff.y / scale\n    })\n\n    layer.position = newPosition\n\n    setLayer(layer)\n    setIsMoving(true)\n  }\n\n  // 隐藏辅助线\n  const hideLine = () => {\n    const vLineEl = document.querySelector('#verticalLine') as HTMLElement\n    vLineEl.style.visibility = 'hidden'\n    const hLineEl = document.querySelector('#horizontalLine') as HTMLElement\n    hLineEl.style.visibility = 'hidden'\n    setIsMoving(false)\n  }\n\n  // 选中图层\n  const onSelectLayer = (e: MouseEventType<HTMLDivElement>) => {\n    e.stopPropagation()\n    if (info.isEditing) return\n    selectLayer(info.id)\n    setIsSelectedBackground(false)\n    // 锁定了就不给拖动\n    if (info.isLocked) return\n    // 初始化拖拽事件\n    new MouseEvents(e, updatePosition, hideLine)\n    // 初始化辅助线数据\n    initHelpLine({\n      ...info.position,\n      width: info.width,\n      height: info.height,\n      rotate: info.rotate\n    }, info.id, layers, scale, { ...template.global })\n  }\n\n  // 鼠标移入图层\n  const onLayerMouseEnter = (e: MouseEventType<HTMLDivElement>) => {\n    e.stopPropagation()\n    hoverLayer(info.id)\n  }\n\n  // 鼠标移出图层\n  const onLayerMouseOut = (e: MouseEventType<HTMLDivElement>) => {\n    e.stopPropagation()\n    hoverLayer()\n  }\n\n  return <LayerWrapper\n    style={{\n      width: info.width,\n      height: info.height,\n      transform: `translate(${info.position.x}px, ${info.position.y}px) rotate(${info.rotate}deg)`,\n      opacity: info.opacity,\n      zIndex: info.zIndex\n    }}\n    onMouseDown={onSelectLayer}\n    onMouseEnter={onLayerMouseEnter}\n    onMouseOut={onLayerMouseOut}\n    className={[isMoving ? 'moving' : '', info.isEditing ? 'edit' : ''].join(' ')}\n  >\n    {/* 图层内容 */}\n    <LayerContent style={{transform: `scale(${info.reverse?.x || 1}, ${info.reverse?.y || 1})`}}>\n      { children }\n    </LayerContent>\n    {/* 拖拽边框 */}\n    {info.isSelected && <TransportBorder>\n      <Border info={info} />\n    </TransportBorder>}\n    {/* 鼠标移入边框 */}\n    {!info.isSelected && !isMoving && info.isHover && <TransportBorder>\n      <HoverBorder info={info} />\n    </TransportBorder>}\n  </LayerWrapper>\n})\n\n// 传送门\nfunction TransportBorder ({ children }: { children: JSX.Element }) {\n  return createPortal(\n    children,\n    document.querySelector('#layerControl') as HTMLDivElement\n  )\n}\n\nconst LayerWrapper = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n  user-select: none;\n  cursor: default;\n\n  &.moving {\n    cursor: all-scroll;\n  }\n\n  &.edit {\n    cursor: text;\n  }\n`\n\nconst LayerContent = styled.div`\n  width: 100%;\n  height: 100%;\n  transition: transform 250ms;\n`","import { Layer } from 'types'\n\ninterface Rect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  rotate: number;\n}\n\ninterface RealRect extends Omit<Rect, 'rotate'> {}\n\ninterface Size {\n  width: number;\n  height: number;\n}\n\ninterface Coord {\n  x: number;\n  y: number;\n}\n\nexport function helpLine () {\n  // 当前图层位置信息\n  let rect: Rect = {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    rotate: 0\n  }\n\n  // 当前图层实际DOM的位置信息\n  let realRect: RealRect = {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n  }\n\n  // 当前图层ID\n  let layerId = ''\n  // 所有的图层数据\n  let allLayers: Layer[] = []\n  // 缩放值\n  let scale = 1\n  // 画布尺寸\n  let canvasSize: Size = {\n    width: 0,\n    height: 0\n  }\n  // 吸附距离\n  let diff = 4\n\n  const vLineEl = document.querySelector('#verticalLine') as HTMLElement\n  const hLineEl = document.querySelector('#horizontalLine') as HTMLElement\n  let vType: 0 | 1 | 2 = 0 // 垂直线位置-0左1中2右\n  let hType: 0 | 1 | 2 = 0 // 水平线位置-0上1中2下\n\n  // 初始化数据\n  const init = (data: Rect, id: string, layers: Layer[], scl: number, size: Size) => {\n    rect = data\n    layerId = id\n    allLayers = layers\n    scale = scl\n    diff = 4 / scale\n    canvasSize = size\n\n    // 获取旋转后的真实元素位置信息\n    const rad = rect.rotate * Math.PI / 180\n    const newWidth = Math.abs(rect.width * Math.cos(rad)) + Math.abs(rect.height * Math.sin(rad))\n    const newHeight = Math.abs(rect.height * Math.cos(rad)) + Math.abs(rect.width * Math.sin(rad))\n    realRect.width = newWidth\n    realRect.height = newHeight\n    realRect.x = rect.x + (rect.width - newWidth) / 2\n    realRect.y = rect.y - (newHeight - rect.height) / 2\n  }\n\n  // 移动吸附\n  const move = ({ x, y }: Coord): Coord => {\n    rect.x = x\n    rect.y = y\n\n    const res: Coord = {\n      x: rect.x,\n      y: rect.y\n    }\n\n    // 更新真实元素位置信息\n    realRect.x = rect.x + (rect.width - realRect.width) / 2\n    realRect.y = rect.y - (realRect.height - rect.height) / 2\n\n    // 遍历所有图层，与当前图层两两对比\n    allLayers.forEach(l => {\n      // 获取其他图层真实的元素定位\n      const rad = l.rotate * Math.PI / 180\n      const newWidth = Math.abs(l.width * Math.cos(rad)) + Math.abs(l.height * Math.sin(rad))\n      const newHeight = Math.abs(l.height * Math.cos(rad)) + Math.abs(l.width * Math.sin(rad))\n      const newX = l.position.x + (l.width - newWidth) / 2\n      const newY = l.position.y - (newHeight - l.height) / 2\n\n      if (l.id !== layerId) {\n        // x 垂直线\n        vLineHandle(newX + newWidth, res) // 对象图层右\n        vLineHandle(newX + newWidth / 2, res) // 对象图层中\n        vLineHandle(newX, res) // 对象图层左\n\n        // y 水平线\n        hLineHandle(newY + newHeight, res) // 对象图层下\n        hLineHandle(newY + newHeight / 2, res) // 对象图层中\n        hLineHandle(newY, res) // 对象图层上\n      }\n    })\n\n    // 与画布对齐\n    // x 垂直线\n    vLineHandle(canvasSize.width, res) // 画布右\n    vLineHandle(canvasSize.width / 2, res) // 画布中\n    vLineHandle(0, res) // 画布左\n    // y 水平线\n    hLineHandle(canvasSize.height, res) // 画布下\n    hLineHandle(canvasSize.height / 2, res) // 画布中\n    hLineHandle(0, res) // 画布上\n\n    // 渲染辅助线DOM\n    renderLine(res)\n\n    return res\n  }\n\n  // 垂直线\n  const vLineHandle = (targetX: number, res: Coord) => {\n    // 右\n    if (Math.abs(targetX - (realRect.x + realRect.width)) <= diff) {\n      res.x = targetX - rect.width \n      res.x += (rect.width - realRect.width) / 2\n      vType = 2\n    }\n    // 中\n    if (Math.abs(targetX - (realRect.x + realRect.width / 2)) <= diff) {\n      res.x = targetX - rect.width / 2\n      vType = 1\n    }\n    // 左\n    if (Math.abs(targetX - realRect.x) <= diff) {\n      res.x = targetX\n      res.x -= (rect.width - realRect.width) / 2\n      vType = 0\n    }\n  }\n\n  // 水平线\n  const hLineHandle = (targetY: number, res: Coord) => {\n    // 下\n    if (Math.abs(targetY - (realRect.y + realRect.height)) <= diff) {\n      res.y = targetY - rect.height\n      res.y -= (realRect.height - rect.height) / 2\n      hType = 2\n    }\n    // 中\n    if (Math.abs(targetY - (realRect.y + realRect.height / 2)) <= diff) {\n      res.y = targetY - rect.height / 2\n      hType = 1\n    }\n    // 上\n    if (Math.abs(targetY - realRect.y) <= diff) {\n      res.y = targetY\n      res.y += (realRect.height - rect.height) / 2\n      hType = 0\n    }\n  }\n\n  // 渲染辅助线DOM\n  const renderLine = (res: Coord) => {\n    if (vLineEl && hLineEl) {\n      // TODO: 当前位置刚好在线上，条件不满足\n      if (res.x !== rect.x) {\n        let vLine = 0\n        if (vType === 0) vLine = res.x + (rect.width - realRect.width) / 2\n        if (vType === 1) vLine = res.x + rect.width / 2\n        if (vType === 2) vLine = res.x + (rect.width - realRect.width) / 2 + realRect.width\n        vLineEl.style.transform = `translateX(${vLine * scale}px)`\n        vLineEl.style.visibility = 'visible'\n      } else {\n        vLineEl.style.visibility = 'hidden'\n      }\n      if (res.y !== rect.y) {\n        let hLine = 0\n        if (hType === 0) hLine = res.y - (realRect.height - rect.height) / 2\n        if (hType === 1) hLine = res.y + rect.height / 2\n        if (hType === 2) hLine = res.y - (realRect.height - rect.height) / 2 + realRect.height\n        hLineEl.style.transform = `translateY(${hLine * scale}px)`\n        hLineEl.style.visibility = 'visible'\n      } else {\n        hLineEl.style.visibility = 'hidden'\n      }\n    }\n  }\n\n  const getRect = () => {\n    return rect\n  }\n\n  return {\n    getRect,\n    init,\n    move\n  }\n}","import 'quill/dist/quill.core.css'\nimport 'quill/dist/quill.snow.css'\nimport Quill from 'quill'\nimport { observer } from 'mobx-react'\nimport styled from '@emotion/styled'\nimport { FontStyle } from 'types'\nimport { Layer } from 'types'\nimport { useCallback, useEffect, useRef, useState, useContext } from 'react'\nimport { templateStore } from 'store/template'\nimport { cloneDeep } from 'lodash'\nimport { ScaleContext } from 'store/context'\n\nexport default observer(({ layer }: { layer: Layer }) => {\n  const editorRef = useRef<HTMLDivElement>(null)\n\n  const { setEditStatus, setLayer, needUpdateLayerHeight, setNeedUpdateLayerHeight, isMoving } = templateStore\n  const scale = useContext(ScaleContext)\n\n  // quill实例\n  let [editor, setEditor] = useState<Quill | null>(null)\n\n  // 画布的DOM信息\n  const canvasRect = (document.querySelector('#textControl') as HTMLElement)?.getBoundingClientRect()\n\n  // 文本内容变化\n  const onTextChange = useCallback(() => {\n    if (editor) {\n      const _layer = cloneDeep(layer)\n      const text = editor.getText()\n      _layer.source.content = text\n\n      if (editorRef.current) {\n        // 文本换行了，更新图层最新高度和位置\n        const rect = editorRef.current.getBoundingClientRect()\n        const rad = (layer.rotate % 180) * Math.PI / 180\n        const newHeight = Math.abs((rect.height - layer.width * scale * Math.sin(rad)) / Math.cos(rad))\n\n        // 高度不一致表示换行/减行\n        if (newHeight / scale !== layer.height) {\n          _layer.height = newHeight / scale\n\n          const center = {\n            x: rect.left + rect.width / 2 - canvasRect.left,\n            y: rect.top + rect.height / 2 - canvasRect.top\n          }\n          const newX = center.x / scale - (layer.width / 2)\n          const newY = (center.y - (newHeight / 2)) / scale\n\n          _layer.position = {\n            x: newX,\n            y: newY\n          }\n        }\n      }\n      setLayer(_layer)\n    }\n  }, [editor, layer, setLayer, scale, canvasRect])\n\n  // 字体大小改变了，高度也要更新\n  useEffect(() => {\n    if (needUpdateLayerHeight && editorRef.current) {\n      const _layer = cloneDeep(layer)\n      const rect = editorRef.current.getBoundingClientRect()\n      const rad = (layer.rotate % 180) * Math.PI / 180\n      const newHeight = Math.abs((rect.height - layer.width * scale * Math.sin(rad)) / Math.cos(rad))\n\n      // 高度不一致表示换行/减行\n      if (newHeight / scale !== layer.height) {\n        _layer.height = newHeight / scale\n\n        const center = {\n          x: rect.left + rect.width / 2 - canvasRect.left,\n          y: rect.top + rect.height / 2 - canvasRect.top\n        }\n        const newX = center.x / scale - (layer.width / 2)\n        const newY = (center.y - (newHeight / 2)) / scale\n\n        _layer.position = {\n          x: newX,\n          y: newY\n        }\n        setLayer(_layer)\n      }\n      setNeedUpdateLayerHeight(false)\n    }\n  }, [canvasRect, layer, needUpdateLayerHeight, scale, setLayer, setNeedUpdateLayerHeight])\n\n  // 拖拽改变文本框宽度时，更新图层最新高度\n  // TODO: 位置会偏移\n  useEffect(() => {\n    // isMoving表示拖拽\n    if (isMoving && editorRef.current) {\n      const rect = editorRef.current.getBoundingClientRect()\n      const rad = (layer.rotate % 180) * Math.PI / 180\n      const newHeight = Math.abs((rect.height - layer.width * scale * Math.sin(rad)) / Math.cos(rad))\n\n      // 高度不一致表示换行/减行\n      if (Math.abs(newHeight / scale - layer.height) > 1) {\n        const _layer = cloneDeep(layer)\n        _layer.height = newHeight / scale\n        setLayer(_layer)\n      }\n    }\n  }, [layer, scale, isMoving, canvasRect, setLayer])\n\n  // 进入编辑状态\n  const onEditText = () => {\n    setEditStatus(layer.id)\n  }\n\n  // 初始化quill实例\n  useEffect(() => {\n    if (editorRef.current && !editor) {\n      const instance = new Quill(editorRef.current)\n      setEditor(instance)\n    }\n  }, [editor])\n\n  // 设置文本内容\n  useEffect(() => {\n    if (editor && layer.source.content && editor.getText() !== layer.source.content) {\n      editor.setText(layer.source.content)\n    }\n  }, [editor, layer.source.content])\n\n  // 设置编辑状态\n  useEffect(() => {\n    if (editor) {\n      editor.enable(layer.isEditing)\n      layer.isEditing && editor.setSelection(0, 1000)\n    }\n  }, [editor, layer.isEditing])\n\n  useEffect(() => {\n    if (editor) {\n      editor.on('text-change', onTextChange)\n    }\n    return () => {\n      editor?.off('text-change', onTextChange)\n    }\n  }, [editor, onTextChange])\n\n  return <TextWrapper\n    style={{\n      transform: `scale(${layer.scale})`,\n      width: `${layer.width / (layer.scale || 1)}px`,\n      height: `${layer.height / (layer.scale || 1)}px`\n    }}\n  >\n    <Text\n      data={layer.style as FontStyle}\n      onDoubleClick={onEditText}\n    >\n      <Editor ref={editorRef} spellCheck=\"false\" />\n    </Text>\n  </TextWrapper>\n})\n\nconst TextWrapper = styled.div`\n  transform-origin: 0 0;\n`\n\nconst Text = styled.div<{data: FontStyle}>(\n  {},\n  props => ({\n    fontFamily: `\"${props.data.font}\"`,\n    fontSize: props.data.fontSize,\n    color: props.data.color,\n    lineHeight: props.data.lineHeight,\n    textAlign: props.data.textAlign,\n    fontWeight: props.data.fontWeight,\n    textDecorationLine: props.data.underline ? 'underline' : 'none'\n  })\n)\n\nconst Editor = styled.div`\n  font-family: inherit;\n  font-size: inherit;\n\n  .ql-editor {\n    padding: 0;\n    overflow: visible;\n    font-family: inherit;\n    line-height: inherit;\n    text-align: inherit;\n    white-space: break-spaces;\n    /* user-select: text; */\n    line-break: anywhere;\n\n    &>* {\n      cursor: inherit;\n    }\n  }\n`","import { observer } from 'mobx-react'\nimport styled from '@emotion/styled'\nimport { Layer } from 'types'\nimport { templateStore } from 'store/template'\nimport { MouseEvent } from 'react'\n\nexport default observer(({ layer }: { layer: Layer }) => {\n  const { setEditStatus } = templateStore\n\n  const onClipImage = (e: MouseEvent) => {\n    e.stopPropagation()\n    setEditStatus(layer.id)\n\n  }\n\n  return (\n    <ImgWrapper onDoubleClick={onClipImage}>\n      <div style={{\n        position: 'absolute',\n        width: `${layer.clip?.width}px`,\n        height: `${layer.clip?.height}px`,\n        transform: `translate(-${layer.clip?.left}px, -${layer.clip?.top}px)`\n      }}>\n        <Img src={layer.source.imageUrl} draggable=\"false\" />\n      </div>\n    </ImgWrapper>\n  )\n})\n\nconst ImgWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`\n\nconst Img = styled.img`\n  width: 100%;\n  height: 100%;\n`","export default __webpack_public_path__ + \"static/media/resize.771f2b8f.svg\";","import { observer } from 'mobx-react'\nimport styled from '@emotion/styled'\nimport { Layer, POINT_TYPE, Coords } from 'types'\nimport { templateStore } from 'store/template'\nimport { ScaleContext } from 'store/context'\nimport { MouseEvent, useContext, useEffect, useState } from 'react'\nimport { MouseEvents } from 'utils/mouseEvent'\nimport { normalResize, rotateResize } from 'utils/resizeLayer'\nimport resizeIcon from 'assets/resize.svg'\nimport { cloneDeep } from 'lodash'\nimport { CheckOutlined, CloseOutlined } from '@ant-design/icons'\nimport { createPortal } from 'react-dom'\n\nlet preLayer: Partial<Layer> = {}\n\nexport default observer(({ info }: { info: Layer }) => {\n  const { template, setLayer, resetEditStatus } = templateStore\n  const scale = useContext(ScaleContext)\n\n  const [layer, setLayerInfo] = useState(info)\n\n  const confirm = (e: MouseEvent) => {\n    e.stopPropagation()\n    setLayer(layer)\n    resetEditStatus()\n  }\n\n  const cancel = (e: MouseEvent) => {\n    e.stopPropagation()\n    resetEditStatus()\n  }\n\n  const onMaskClick = (e: MouseEvent) => {\n    e.stopPropagation()\n    if ((e.target as HTMLElement).id === 'clipImageMask') {\n      confirm(e)\n    }\n  }\n\n  useEffect(() => {\n    setLayerInfo(info)\n  }, [info])\n\n  const clipHandle = (newLayer: Layer, point: POINT_TYPE) => {\n    const handleTop = () => {\n      if (newLayer.clip) {\n        const clipTop = newLayer.clip.height - newLayer.height - newLayer.clip.bottom\n        if (clipTop >= 0) {\n          newLayer.clip.top = clipTop\n          newLayer.clip.pre.top = clipTop\n        } else {\n          newLayer.height = preLayer.height as number\n          newLayer.position.y = preLayer.position?.y as number\n        }\n      }\n    }\n    const handleLeft = () => {\n      if (newLayer.clip) {\n        const clipLeft = newLayer.clip.width - newLayer.width - newLayer.clip.right\n        if (clipLeft >= 0) {\n          newLayer.clip.left = clipLeft\n          newLayer.clip.pre.left = clipLeft\n        } else {\n          newLayer.width = preLayer.width  as number\n          newLayer.position.x = preLayer.position?.x  as number\n        }\n      }\n    }\n    const handleRight = () => {\n      if (newLayer.clip) {\n        const clipRight = newLayer.clip.width - newLayer.width - newLayer.clip.left\n        if (clipRight >= 0) {\n          newLayer.clip.right = clipRight\n          newLayer.clip.pre.right = clipRight\n        } else {\n          newLayer.width = newLayer.clip.width - newLayer.clip.left\n        }\n      }\n    }\n    const handleBottom = () => {\n      if (newLayer.clip) {\n        const clipBottom = newLayer.clip.height - newLayer.height - newLayer.clip.top\n        if (clipBottom >= 0) {\n          newLayer.clip.bottom = clipBottom\n          newLayer.clip.pre.bottom = clipBottom\n        } else {\n          newLayer.height = newLayer.clip.height - newLayer.clip.top\n        }\n      }\n    }\n    if (newLayer.clip) {\n      switch (point) {\n        case POINT_TYPE.BR: {\n          handleBottom()\n          handleRight()\n          break\n        }\n        case POINT_TYPE.BL: {\n          handleBottom()\n          handleLeft()\n          break\n        }\n        case POINT_TYPE.TL: {\n          handleTop()\n          handleLeft()\n          break\n        }\n        case POINT_TYPE.TR: {\n          handleTop()\n          handleRight()\n          break\n        }\n      }\n    }\n    return newLayer\n  }\n\n  // 调整大小 无旋转\n  const resizeNormal = (e: MouseEvent<HTMLElement>, point: POINT_TYPE) => {\n    const _layer = cloneDeep(layer)\n    new MouseEvents(e, (payload) => {\n      preLayer = cloneDeep(_layer)\n\n      // 普通拖拽框大小\n      const newLayer = normalResize(_layer, point, payload.diff, scale, false)\n      const res = clipHandle(newLayer, point)\n\n      setLayerInfo(Object.assign({}, res))\n    }, () => {\n\n    })\n  }\n\n  // 调整大小 有旋转\n  // TODO: 拖拽优化\n  const resizeWithRotate = (e: MouseEvent<HTMLElement>, point: POINT_TYPE) => {\n    const _layer = cloneDeep(layer)\n\n    // 图层相对于画布左上角的中心点\n    const center = {\n      x: (_layer.position.x + _layer.width / 2) * scale,\n      y: (_layer.position.y + _layer.height / 2) * scale\n    }\n\n    // 获取边框圆点中心点\n    const pointRect = (e.target as HTMLElement)?.getBoundingClientRect()\n    const canvasRect = (document.querySelector('#layerControl') as HTMLElement)?.getBoundingClientRect()\n    const pointCenter = {\n      x: pointRect.left - Number(canvasRect.left) + pointRect.width / 2,\n      y: pointRect.top - Number(canvasRect.top) + pointRect.height / 2\n    }\n\n    // 获取对称点\n    const symmetricPoint = {\n      x: center.x - (pointCenter.x - center.x),\n      y: center.y - (pointCenter.y - center.y)\n    }\n\n    const whRatio = _layer.width / _layer.height\n\n    new MouseEvents(e, ({ curCoords }: { curCoords: Coords; }) => {\n      const curPoint = {\n        x: curCoords.x - Number(canvasRect.left),\n        y: curCoords.y - Number(canvasRect.top)\n      }\n\n      preLayer = cloneDeep(layer)\n\n      // 处理旋转的拖拽\n      const newLayer = rotateResize(point, curPoint, symmetricPoint, pointCenter, _layer, layer, whRatio, scale, false)\n\n      const res = clipHandle(newLayer, point)\n\n      setLayerInfo(Object.assign({}, res))\n    }, () => {\n\n    })\n  }\n\n  // 调整大小\n  const resize = (e: MouseEvent<HTMLElement>, point: POINT_TYPE) => {\n    e.stopPropagation()\n    if (info.rotate === 0) {\n      resizeNormal(e, point)\n    } else {\n      resizeWithRotate(e, point)\n    }\n  }\n\n  // 拖拽图片位置\n  // TODO: 旋转后拖拽优化\n  const onDragImage = (e: MouseEvent<HTMLDivElement>) => {\n    e.stopPropagation()\n    // 初始化拖拽事件\n    new MouseEvents(e, ({ diff }: { diff: Coords }) => {\n      const { clip } = layer\n      if (clip) {\n        const newTop = clip.top - diff.y / scale * (layer.reverse?.y || 1)\n        const newLeft = clip.left - diff.x / scale * (layer.reverse?.x || 1)\n        const newRight = clip.right + diff.x / scale * (layer.reverse?.x || 1)\n        const newBottom = clip.bottom + diff.y / scale * (layer.reverse?.y || 1)\n\n        if (newTop >= 0 && newBottom >= 0) {\n          clip.top = newTop\n          clip.bottom = newBottom\n          clip.pre.top = newTop\n          clip.pre.bottom = newBottom\n          setLayerInfo(Object.assign({}, layer))\n        }\n        if (newRight >= 0 && newLeft >= 0) {\n          clip.left = newLeft\n          clip.right = newRight\n          clip.pre.left = newLeft\n          clip.pre.right = newRight\n          setLayerInfo(Object.assign({}, layer))\n        }\n      }\n    })\n  }\n\n  return (\n    <>\n      <Mask id=\"clipImageMask\" onMouseDown={onMaskClick}>\n        <Wrapper style={{\n          width: template.global.width * scale,\n          height: template.global.height * scale\n        }}>\n          <CanvasContent style={{\n            width: template.global.width,\n            height: template.global.height,\n            transform: `scale(${scale})`\n          }}>\n            {/* 裁剪效果层 */}\n            <LayerWrapper style={{\n              width: layer.width,\n              height: layer.height,\n              transform: `translate(${layer.position.x}px, ${layer.position.y}px) rotate(${layer.rotate}deg) scale(${layer.reverse?.x || 1}, ${layer.reverse?.y || 1})`\n            }}>\n              <ImgWrapper>\n                <div style={{\n                  position: 'absolute',\n                  width: `${layer.clip?.width}px`,\n                  height: `${layer.clip?.height}px`,\n                  transform: `translate(-${layer.clip?.left}px, -${layer.clip?.top}px)`\n                }}>\n                  <Img src={layer.source.imageUrl} draggable=\"false\" />\n                </div>\n              </ImgWrapper>\n            </LayerWrapper>\n          </CanvasContent>\n          {/* 编辑层 */}\n          <LayerControl style={{\n            width: template.global.width * scale,\n            height: template.global.height * scale\n          }}>\n            {/* 裁剪边框 */}\n            <BorderEl \n              className={layer.reverse?.x === -1 || layer.reverse?.y === -1 ? 'hidden' : ''}\n              style={{\n                width: layer.width * scale,\n                height: layer.height * scale,\n                transform: `translate(${layer.position.x * scale}px, ${layer.position.y * scale}px) rotate(${layer.rotate}deg)`\n              }}>\n              {(layer.reverse?.x !== -1 && layer.reverse?.y !== -1) && <>\n                  <AngleTL onMouseDown={e => resize(e, POINT_TYPE.TL)}><img src={resizeIcon} alt=\"\" /></AngleTL>\n                  <AngleTR onMouseDown={e => resize(e, POINT_TYPE.TR)}><img src={resizeIcon} alt=\"\" /></AngleTR>\n                  <AngleBL onMouseDown={e => resize(e, POINT_TYPE.BL)}><img src={resizeIcon} alt=\"\" /></AngleBL>\n                  <AngleBR onMouseDown={e => resize(e, POINT_TYPE.BR)}><img src={resizeIcon} alt=\"\" /></AngleBR>\n                </>\n              }\n              <Line1 /><Line2 /><Line3 /><Line4 />\n            </BorderEl>\n\n            {/* 背景拖动层 */}\n            <LayerWrapper\n              style={{\n                width: layer.width * scale,\n                height: layer.height * scale,\n                transform: `translate(${layer.position.x * scale}px, ${layer.position.y * scale}px) rotate(${layer.rotate}deg) scale(${layer.reverse?.x || 1}, ${layer.reverse?.y || 1})`\n              }}\n              onMouseDown={onDragImage}\n            >\n              <ImgWrapper style={{ overflow: 'visible' }}>\n                <div style={{\n                  position: 'absolute',\n                  width: `${layer.clip && layer.clip.width * scale}px`,\n                  height: `${layer.clip && layer.clip.height * scale}px`,\n                  transform: `translate(-${layer.clip && layer.clip.left * scale}px, -${layer.clip && layer.clip.top * scale}px)`,\n                  border: '2px dashed #00c4cc',\n                  cursor: 'move'\n                }}>\n                  <Img src={layer.source.imageUrl} draggable=\"false\" style={{ opacity: 0.5 }} />\n                </div>\n              </ImgWrapper>\n            </LayerWrapper>\n          </LayerControl>\n        </Wrapper>\n      </Mask>\n      {/* 传送工具栏 */}\n      <TransportToolBar>\n        <ToolBar>\n          <ToolItem onMouseDown={confirm}><CheckOutlined />完成</ToolItem>\n          <ToolItem onMouseDown={cancel}><CloseOutlined />取消</ToolItem>\n        </ToolBar>\n      </TransportToolBar>\n    </>\n  )\n})\n\n// 传送门\nfunction TransportToolBar ({ children }: { children: JSX.Element }) {\n  return createPortal(\n    children,\n    document.querySelector('#toolBar') as HTMLDivElement\n  )\n}\n\nconst Mask = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(0,0,0,.3);\n`\n\nconst Wrapper = styled.div`\n  flex: none;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  pointer-events: none;\n`\n\nconst CanvasContent = styled.div`\n  flex: none;\n  position: relative;\n  overflow: visible;\n  background-color: transparent;\n  user-select: none;\n  pointer-events: none;\n`\n\nconst LayerWrapper = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n  user-select: none;\n  cursor: default;\n\n  &.moving {\n    cursor: all-scroll;\n  }\n`\n\nconst ImgWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`\n\nconst Img = styled.img`\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n`\n\nconst LayerControl = styled(CanvasContent)`\n position: absolute;\n top: 0;\n left: 0;\n`\n\nconst BorderEl = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n  z-index: 1;\n\n  &.hidden {\n    &:after {\n      opacity: 0;\n    }\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    right: -1px;\n    bottom: -1px;\n    border: 2px solid #00c4cc;\n  }\n`\n\nconst Line = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  background-color: #fff;\n`\n\nconst Line1 = styled(Line)`\n  left: 33%;\n  transform: scaleX(.7);\n`\n\nconst Line2 = styled(Line)`\n  left: 66%;\n  transform: scaleX(.7);\n`\n\nconst Line3 = styled(Line)`\n  top: 33%;\n  width: 100%;\n  height: 1px;\n  transform: scaleY(.7);\n`\n\nconst Line4 = styled(Line)`\n  top: 66%;\n  width: 100%;\n  height: 1px;\n  transform: scaleY(.7);\n`\n\nconst ResizeAngle = styled.span`\n  position: absolute;\n  display: block;\n  background: transparent;\n  z-index: 1;\n  pointer-events: auto;\n  width: 22px;\n  height: 22px;\n  user-select: none;\n\n  img {\n    width: 14px;\n    height: 14px;\n    pointer-events: none;\n  }\n`\n\nconst AngleTL = styled(ResizeAngle)`\n  top: -11px;\n  left: -11px;\n  transform: rotate(180deg);\n  cursor: nwse-resize;\n`\n\nconst AngleTR = styled(ResizeAngle)`\n  top: -11px;\n  right: -11px;\n  transform: rotate(-90deg);\n  cursor: nesw-resize;\n`\n\nconst AngleBL = styled(ResizeAngle)`\n  left: -11px;\n  bottom: -11px;\n  transform: rotate(90deg);\n  cursor: nesw-resize;\n`\n\nconst AngleBR = styled(ResizeAngle)`\n  bottom: -11px;\n  right: -11px;\n  cursor: nwse-resize;\n`\n\nconst ToolBar = styled.div`\n  position: absolute;\n  left: 0;\n  top: 0;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  padding-left: 10px;\n  z-index: 1;\n  background-color: #fff;\n`\n\nconst ToolItem = styled.div`\n  display: flex;\n  align-items: center;\n  margin-right: 10px;\n  padding: 4px 10px;\n  font-size: 16px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  span {\n    margin-right: 8px;\n  }\n`","import { observer } from 'mobx-react'\nimport styled from '@emotion/styled'\nimport { Layer } from 'types'\n\nexport default observer(({ layer }: { layer: Layer }) => {\n  return <Rect style={{\n    borderWidth: layer.rectInfo?.borderWidth,\n    borderColor: layer.rectInfo?.borderColor,\n    borderStyle: layer.rectInfo?.borderStyle,\n    backgroundColor: layer.rectInfo?.fill\n  }}/>\n})\n\nconst Rect = styled.div`\n  width: 100%;\n  height: 100%;\n  border-style: solid;\n`\n","import { observer } from 'mobx-react'\nimport styled from '@emotion/styled'\nimport { Layer } from 'types'\n\nexport default observer(({ layer }: { layer: Layer }) => {\n  return <Circle style={{\n    borderWidth: layer.circleInfo?.borderWidth,\n    borderColor: layer.circleInfo?.borderColor,\n    borderStyle: layer.circleInfo?.borderStyle,\n    backgroundColor: layer.circleInfo?.fill\n  }}/>\n})\n\nconst Circle = styled.div`\n  width: 100%;\n  height: 100%;\n  border-style: solid;\n  border-radius: 50%;\n`\n","import React, { useContext, MouseEvent, DragEvent } from 'react'\nimport styled from '@emotion/styled'\nimport { ScaleContext, BackgroundContext } from 'store/context'\nimport Layer from './layer/Layer'\nimport { LAYER_TYPE } from 'types'\nimport { ImageItem } from 'types/image'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { toJS } from 'mobx'\nimport TextEditor from './layer/TextEditor'\nimport ImageLayer from './layer/Image'\nimport ClipImage from './ClipImage'\nimport Rect from './layer/shapes/Rect'\nimport Circle from './layer/shapes/Circle'\nimport { createPortal } from 'react-dom'\nimport { createImage, createRect, createCircle } from 'utils/createNewLayer'\n\ninterface Props {\n  width: number;\n  height: number;\n  scale: number;\n}\n\n// 拖拽图片时鼠标的位置\nconst dragCursorPosition = {\n  x: 0,\n  y: 0\n}\n\n// 画布\nexport default observer(() => {\n  const { template, layers, addLayer, resetSelectStatus, setLayerType } = templateStore\n  const { global, background } = template\n\n  const scale = useContext(ScaleContext)\n  const {isSelectedBackground, setIsSelectedBackground} = useContext<{\n    isSelectedBackground: boolean;\n    setIsSelectedBackground: React.Dispatch<React.SetStateAction<boolean>>\n  }>(BackgroundContext)\n\n  // 选中背景\n  const selectBackground = (e: MouseEvent<HTMLDivElement>) => {\n    e.stopPropagation()\n    setIsSelectedBackground(true)\n    resetSelectStatus()\n    setLayerType(LAYER_TYPE.BACKGROUND)\n  }\n\n  // 拖拽释放\n  const onDropCapture = (e: DragEvent<HTMLDivElement>) => {\n    e.preventDefault()\n    const getPosition = (width: number, height: number) => {\n      const canvasRect = (document.querySelector('#layerControl') as HTMLElement)?.getBoundingClientRect()\n      const x = dragCursorPosition.x - canvasRect.left\n      const y = dragCursorPosition.y - canvasRect.top\n      return {\n        x: x / scale - width / 2,\n        y: y / scale - height / 2\n      }\n    }\n    // 使用图片\n    const onUseImage = (width: number, height: number, url: string) => {\n      const position = getPosition(width, height)\n      const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n      const newLayer = createImage(width, height, url, position, zIndex)\n      resetSelectStatus()\n      addLayer(newLayer)\n    }\n    // 使用矩形\n    const onUseRect = () => {\n      const size = {\n        width: 200,\n        height: 200\n      }\n      const position = getPosition(size.width, size.height)\n      const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n      const newLayer = createRect(size.width, size.height, position, zIndex)\n      resetSelectStatus()\n      addLayer(newLayer)\n    }\n    // 使用圆形\n    const onUseCircle = () => {\n      const size = {\n        width: 200,\n        height: 200\n      }\n      const position = getPosition(size.width, size.height)\n      const zIndex = layers.length ? layers[layers.length - 1].zIndex + 1 : 1\n      const newLayer = createCircle(size.width, size.height, position, zIndex)\n      resetSelectStatus()\n      addLayer(newLayer)\n    }\n\n    // 本地图片拖拽\n    if (e.dataTransfer.files.length > 0) {\n      const files = e.dataTransfer.files\n      if (!/image\\//.test(files[0].type)) return\n      const reader = new FileReader()\n      reader.readAsDataURL(files[0])\n      reader.onload = el => {\n        const url = el.target?.result\n        if (typeof url === 'string') {\n          const img = new Image()\n          img.src = url\n          img.onload = () => {\n            onUseImage(img.width, img.height, url)\n          }\n        }\n      }\n    } else {\n      // 侧边栏图片\n      let image: ImageItem | null = null\n      if (e.dataTransfer?.getData('image')) {\n        try {\n          image = JSON.parse(e.dataTransfer?.getData('image'))\n        } catch (e) { console.log(e) }\n      }\n      // 使用图片\n      if (image) {\n        onUseImage(image.webformatWidth, image.webformatHeight, image.webformatURL)\n      }\n      // 使用矩形\n      const isRect = !!e.dataTransfer?.getData('rect')\n      if (isRect) {\n        onUseRect()\n      }\n      // 使用圆形\n      const isCircle = !!e.dataTransfer?.getData('circle')\n      if (isCircle) {\n        onUseCircle()\n      }\n    }\n  }\n\n  const onDragOver = (e: DragEvent<HTMLDivElement>) => {\n    e.preventDefault()\n    dragCursorPosition.x = e.pageX\n    dragCursorPosition.y = e.pageY\n  }\n\n  return <Wrapper width={global.width} height={global.height} scale={scale}>\n    <CanvasContent\n      id=\"canvasContent\"\n      style={{ width: global.width, height: global.height, transform: `scale(${scale})` }}\n      onDrop={onDropCapture} onDragOver={onDragOver}>\n      <Background color={background.color} onClick={selectBackground} />\n      {\n        template.layers.map(layer => {\n          // 图片\n          if (layer.type === 'image') {\n            return layer.isEditing ?\n            <TransportImage key={layer.id}>\n              <ClipImage info={toJS(layer)} />\n            </TransportImage>\n            :\n            <Layer key={layer.id} info={layer}>\n              <ImageLayer layer={toJS(layer)} />\n            </Layer>\n          }\n          // 文字\n          if (layer.type === 'text') {\n            return layer.isEditing ?\n            <TransportEditor key={layer.id}>\n              <Layer info={layer}>\n                <TextEditor layer={toJS(layer)} />\n              </Layer>\n            </TransportEditor>\n            :\n            <Layer key={layer.id} info={layer}>\n              <TextEditor layer={toJS(layer)} />\n            </Layer>\n          }\n          // 矩形\n          if (layer.type === 'rect') {\n            return <Layer key={layer.id} info={layer}>\n              <Rect layer={toJS(layer)} />\n            </Layer>\n          }\n          // 圆形\n          if (layer.type === 'circle') {\n            return <Layer key={layer.id} info={layer}>\n              <Circle layer={toJS(layer)} />\n            </Layer>\n          }\n          return <></>\n        })\n      }\n    </CanvasContent>\n    {/* 编辑框传送点 */}\n    <LayerControl id=\"layerControl\" width={global.width} height={global.height} scale={scale}>\n        {isSelectedBackground && <BackgroundBorder />}\n        {/* 垂直辅助线 */}\n        <VLine id=\"verticalLine\" />\n        {/* 水平辅助线 */}\n        <HLine id=\"horizontalLine\" />\n    </LayerControl>\n    {/* 点前编辑的文本传送点 */}\n    <TextControl id=\"textControl\" style={{ width: global.width, height: global.height, transform: `scale(${scale})` }} />\n  </Wrapper>\n})\n\n// 文字传送门\nfunction TransportEditor ({ children }: { children: JSX.Element }) {\n  return createPortal(\n    children,\n    document.querySelector('#textControl') as HTMLDivElement\n  )\n}\n\n// 图片传送门\nfunction TransportImage ({ children }: { children: JSX.Element }) {\n  return createPortal(\n    children,\n    document.querySelector('#editorContainer') as HTMLDivElement\n  )\n}\n\nconst Background = styled.div<{ color: string; }>(\n  {\n    position: 'relative',\n    zIndex: -1,\n    width: '100%',\n    height: '100%'\n  },\n  props => ({\n    backgroundColor: props.color\n  })\n)\n\nconst Wrapper = styled.div<Props>(\n  {\n    flex: 'none',\n    position: 'relative',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    margin: 'auto',\n    pointerEvents: 'none'\n  },\n  props => ({\n    width: props.width * props.scale + 100,\n    height: props.height * props.scale + 100\n  })\n)\n\nconst CanvasContent = styled.div`\n  flex: none;\n  position: relative;\n  overflow: hidden;\n  background-color: #fff;\n  user-select: none;\n  pointer-events: auto;\n`\n\nconst TextControl = styled(CanvasContent)`\n  position: absolute;\n  top: 50;\n  left: 50;\n  z-index: 1;\n  pointer-events: none;\n  overflow: visible;\n  background-color: transparent;\n`\n\nconst LayerControl = styled.div<Props>(\n  {\n    position: 'absolute',\n    top: 50,\n    left: 50,\n    zIndex: 2,\n    pointerEvents: 'none'\n  },\n  props => ({\n    width: props.width * props.scale,\n    height: props.height * props.scale\n  })\n)\n\nconst BackgroundBorder = styled.div`\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n  background: transparent;\n  pointer-events: none;\n`\n\nconst VLine = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 0;\n  height: 100%;\n  border-left: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n`\n\nconst HLine = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 0;\n  border-top: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n`","import styled from '@emotion/styled'\n\nexport const ToolItem = styled.div`\n  display: flex;\n  align-items: center;\n  margin-right: 10px;\n  padding: 4px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &.active {\n    background-color: rgba(57,76,96,.15);\n  }\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  .text {\n    padding: 0 10px;\n    font-size: 16px;\n  }\n\n  input[type=\"search\"] {\n    text-align: center;\n  }\n`\n\nexport const ColorItem = styled.div`\n  width: 28px;\n  height: 28px;\n  border: 2px solid #666;\n  border-radius: 4px;\n`","\n// 预设字体列表\nexport const FONT_LIST: Array<{\n  name: string;\n  value: string\n}> = [\n  {\n    name: '宋体',\n    value: 'SimSun'\n  },\n  {\n    name: '黑体',\n    value: 'SimHei'\n  },\n  {\n    name: '微软雅黑',\n    value: 'Microsoft Yahei'\n  },\n  {\n    name: '楷体',\n    value: 'KaiTi'\n  },\n  {\n    name: '华文楷体',\n    value: 'STKaiti'\n  },\n  {\n    name: '翩翩体-简',\n    value: 'Hanzipen SC'\n  },\n  {\n    name: '娃娃体-简',\n    value: 'Wawati SC'\n  },\n  {\n    name: '圆体-简',\n    value: 'Yuanti SC'\n  },\n  {\n    name: '兰亭黑-简',\n    value: 'Lantinghei SC'\n  }\n]\n\n// 字体大小\nexport const FONTSIZE_LIST = [6,8,10,12,14,16,18,20,22,24,28,32,36,42,48,56,64,72,80,88,96,104,120,144]\n\nexport const CANVAS_SIZE_LIST = [\n  {\n    width: 1280,\n    height: 720,\n    label: '1280px × 720px',\n    value: '1'\n  },\n  {\n    width: 720,\n    height: 1280,\n    label: '720px × 1280px',\n    value: '2'\n  },\n  {\n    width: 1024,\n    height: 768,\n    label: '1024px × 768px',\n    value: '3'\n  },\n  {\n    width: 768,\n    height: 1024,\n    label: '768px × 1024px',\n    value: '4'\n  },\n  {\n    width: 1920,\n    height: 1080,\n    label: '1920px × 1080px',\n    value: '5'\n  },\n]","import { ToolItem } from './style'\nimport { Popover, Radio, Space, InputNumber, RadioChangeEvent } from 'antd'\nimport { isNumber } from 'lodash'\nimport { templateStore } from 'store/template'\nimport { useState, useEffect } from 'react'\nimport { CANVAS_SIZE_LIST } from 'utils/const'\nimport { observer } from 'mobx-react'\n\n// 画布尺寸\nexport default observer(() => {\n  const { template, setCanvasSize } = templateStore\n\n  const canvasWidth = template.global.width\n  const canvasHeight = template.global.height\n\n  const [selectValue, setSelectValue] = useState('1')\n\n  useEffect(() => {\n    const res = CANVAS_SIZE_LIST.find(i => i.width === canvasWidth && i.height === canvasHeight && i.value !== selectValue)\n    if (res) {\n      setSelectValue(res.value)\n    } else if (selectValue !== '6') {\n      setSelectValue('6')\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  // 画布宽度修改\n  const onChangeWidth = (val: number) => {\n    if (isNumber(val) && val > 0) {\n      setCanvasSize({\n        width: val,\n        height: canvasHeight\n      })\n    }\n  }\n\n  // 画布高度修改\n  const onChangeHeight = (val: number) => {\n    if (isNumber(val) && val > 0) {\n      setCanvasSize({\n        width: canvasWidth,\n        height: val\n      })\n    }\n  }\n\n  // 选择画布尺寸\n  const onCanvasSizeChange = (e: RadioChangeEvent) => {\n    setSelectValue(e.target.value)\n    const res = CANVAS_SIZE_LIST.find(i => i.value === e.target.value)\n    if (res) {\n      setCanvasSize({\n        width: res.width,\n        height: res.height\n      })\n    }\n  }\n\n  // 画布尺寸列表\n  const CanvasSizeOptions = (\n    <>\n      <Radio.Group onChange={onCanvasSizeChange} value={selectValue}>\n        <Space direction=\"vertical\">\n          {CANVAS_SIZE_LIST.map(i => <Radio key={i.value} value={i.value}>{i.label}</Radio>)}\n          <Radio value={'6'}>\n            自定义\n            {selectValue === '6' ? <div style={{ marginTop: 10 }}>\n              <InputNumber value={canvasWidth} size=\"small\" placeholder=\"宽\" style={{ width: 100, marginRight: 10 }} onChange={onChangeWidth} />×\n              <InputNumber value={canvasHeight} size=\"small\" placeholder=\"高\" style={{ width: 100, marginLeft: 10, marginRight: 10 }} onChange={onChangeHeight} /> 像素\n            </div> : null}\n          </Radio>\n        </Space>\n      </Radio.Group>\n    </>\n  )\n\n  return (\n    <ToolItem>\n      <Popover\n        content={CanvasSizeOptions}\n        trigger=\"click\"\n        placement=\"bottomLeft\"\n      >\n        <span className=\"text\">画布尺寸</span>\n      </Popover>\n    </ToolItem>\n  )\n})","import { ToolItem } from './style'\nimport { Popconfirm } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\n\n// 清空画布\nexport default observer(() => {\n  const { setLayers } = templateStore\n\n  // 清空画布\n  const onClear = () => {\n    setLayers([])\n  }\n\n  return (\n    <ToolItem>\n      <Popconfirm\n        placement=\"bottomRight\"\n        title=\"确定清空画布？\"\n        onConfirm={onClear}\n        okText=\"清空\"\n        cancelText=\"取消\"\n      >\n        <span className=\"text\">清空画布</span>\n      </Popconfirm>\n    </ToolItem>\n  )\n})","import { ToolItem, ColorItem } from './style'\nimport { Popover } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { ChromePicker, ColorResult } from 'react-color'\n\n// 画布背景颜色\nexport default observer(() => {\n  const { template, setBackgroundColor } = templateStore\n\n  const color = template.background.color\n\n  // 选择颜色\n  const onColorChange = (clr: ColorResult) => {\n    const rgba = `rgba(${clr.rgb.r}, ${clr.rgb.g}, ${clr.rgb.b}, ${clr.rgb.a})`\n    setBackgroundColor(rgba)\n  }\n\n  return (\n    <ToolItem>\n      <Popover\n        content={<ChromePicker color={color} onChange={onColorChange} />}\n        trigger=\"click\"\n        placement=\"bottomLeft\"\n      >\n        <ColorItem style={{ backgroundColor: color }} />\n      </Popover>\n    </ToolItem>\n  )\n})","import { ToolItem, ColorItem } from '../style'\nimport { Popover } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { ChromePicker, ColorResult } from 'react-color'\nimport { cloneDeep } from 'lodash'\n\n// 文字颜色\nexport default observer(() => {\n  const { activeLayer, setLayer } = templateStore\n\n  const color = activeLayer?.style?.color || ''\n\n  // 选择颜色\n  const onColorChange = (clr: ColorResult) => {\n    const rgba = `rgba(${clr.rgb.r}, ${clr.rgb.g}, ${clr.rgb.b}, ${clr.rgb.a})`\n    const layer = cloneDeep(activeLayer)\n    if (layer?.type === 'text' && layer.style) {\n      layer.style.color = rgba\n      setLayer(layer)\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Popover\n        content={<ChromePicker color={color} onChange={onColorChange} />}\n        trigger=\"click\"\n        placement=\"bottomLeft\"\n      >\n        <ColorItem style={{ backgroundColor: color }} />\n      </Popover>\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { Select } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { FONT_LIST } from 'utils/const'\nimport { cloneDeep } from 'lodash'\n\nconst { Option } = Select\n\n// 文字类型\nexport default observer(() => {\n  const { activeLayer, setLayer } = templateStore\n\n  // 当前字体\n  const font = activeLayer?.style?.font || ''\n\n  // 选择字体\n  const onFontChange = (val: string) => {\n    const layer = cloneDeep(activeLayer)\n    if (layer?.type === 'text' && layer.style) {\n      layer.style.font = val\n      setLayer(layer)\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Select\n        value={font}\n        style={{ width: 140 }}\n        placeholder=\"选择字体\"\n        onChange={onFontChange}\n      >\n        {FONT_LIST.map(f => <Option key={f.value} value={f.value}><span style={{ fontFamily: f.value }}>{f.name}</span></Option>)}\n      </Select>\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { Select } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { FONTSIZE_LIST } from 'utils/const'\nimport { cloneDeep } from 'lodash'\n\nconst { Option } = Select\n\n// 文字大小\nexport default observer(() => {\n  const { activeLayer, setLayer, setNeedUpdateLayerHeight } = templateStore\n\n  const layerScale = activeLayer?.scale || 1\n  // 当前字体\n  const fontSize = activeLayer?.style?.fontSize || 0\n\n  // 改变字体大小\n  const onFontsizeChange = (val: string) => {\n    const size = Number(val)\n    if (!isNaN(size)) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.type === 'text' && layer.style) {\n        layer.style.fontSize = size / layerScale\n        setLayer(layer)\n        setNeedUpdateLayerHeight(true)\n      }\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Select\n        value={(fontSize * layerScale).toFixed(0)}\n        style={{ width: 100, textAlign: 'center' }}\n        placeholder=\"字体大小\"\n        onChange={onFontsizeChange}\n      >\n        {FONTSIZE_LIST.map(size => <Option key={size} value={size}>{size}</Option>)}\n      </Select>\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { BoldOutlined } from '@ant-design/icons'\nimport { cloneDeep } from 'lodash'\n\n// 字体加粗\nexport default observer(() => {\n  const { activeLayer, setLayer } = templateStore\n\n  // 当前字体粗细\n  const fontWeight = activeLayer?.style?.fontWeight || 400\n\n  // 改变字体粗细\n  const onWeightChange = () => {\n    const layer = cloneDeep(activeLayer)\n    if (layer?.type === 'text' && layer.style) {\n      layer.style.fontWeight = layer.style.fontWeight === 700 ? 400 : 700\n      setLayer(layer)\n    }\n  }\n\n  return (\n    <ToolItem className={fontWeight === 700 ? 'active' : ''} onClick={onWeightChange}>\n      <BoldOutlined style={{ fontSize: 24 }} />\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { UnderlineOutlined } from '@ant-design/icons'\nimport { cloneDeep } from 'lodash'\n\n// 文字下划线\nexport default observer(() => {\n  const { activeLayer, setLayer } = templateStore\n\n  // 当前字体是否有下划线\n  const hasUnderline = activeLayer?.style?.underline || false\n\n  // 设置下划线\n  const onUnderlineChange = () => {\n    const layer = cloneDeep(activeLayer)\n    if (layer?.type === 'text' && layer.style) {\n      layer.style.underline = !layer.style.underline\n      setLayer(layer)\n    }\n  }\n\n  return (\n    <ToolItem className={hasUnderline ? 'active' : ''} onClick={onUnderlineChange}>\n      <UnderlineOutlined style={{ fontSize: 24 }} />\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { AlignLeftOutlined, AlignCenterOutlined, AlignRightOutlined } from '@ant-design/icons'\nimport { cloneDeep } from 'lodash'\nimport { Align } from 'types'\n\n// 文字水平对齐\nexport default observer(() => {\n  const { activeLayer, setLayer } = templateStore\n\n  // 文字水平对齐\n  const textAlign = activeLayer?.style?.textAlign || 'left'\n\n  // 改变文本水平对齐\n  const onTextAlignChange = () => {\n    let align: Align = 'left'\n    if (textAlign === 'left') align = 'center'\n    if (textAlign === 'center') align = 'right'\n    if (textAlign === 'right') align = 'left'\n    const layer = cloneDeep(activeLayer)\n    if (layer?.type === 'text' && layer.style) {\n      layer.style.textAlign = align\n      setLayer(layer)\n    }\n  }\n\n  return (\n    <ToolItem onClick={onTextAlignChange}>\n      {textAlign === 'left' && <AlignLeftOutlined style={{ fontSize: 24 }} />}\n      {textAlign === 'center' && <AlignCenterOutlined style={{ fontSize: 24 }} />}\n      {textAlign === 'right' && <AlignRightOutlined style={{ fontSize: 24 }} />}\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { cloneDeep } from 'lodash'\nimport { Dropdown, Menu } from 'antd'\nimport { SwapOutlined } from '@ant-design/icons'\n\n// 图片翻转\nexport default observer(() => {\n  const { activeLayer, setLayer } = templateStore\n\n  // 翻转图片\n  const onReverseImage = (direction: 'x' | 'y') => {\n    const layer = cloneDeep(activeLayer)\n    if (layer?.reverse) {\n      if (direction === 'x') {\n        layer.reverse.x = layer.reverse.x === 1 ? -1 : 1\n      }\n      if (direction === 'y') {\n        layer.reverse.y = layer.reverse.y === 1 ? -1 : 1\n      }\n      setLayer(layer)\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Dropdown \n        overlay={\n          <Menu style={{ width: 120 }}>\n            <Menu.Item\n              key=\"x\"\n              style={{ padding: '20px' }}\n              icon={<SwapOutlined />}\n              onClick={() => onReverseImage('x')}\n            >\n              水平翻转\n            </Menu.Item>\n            <Menu.Item\n              key=\"y\"\n              style={{ padding: '20px' }}\n              icon={<SwapOutlined style={{ transform: 'rotate(90deg)' }} />}\n              onClick={() => onReverseImage('y')}\n            >\n              垂直翻转\n            </Menu.Item>\n          </Menu>\n        }\n        trigger={['click']}\n      >\n        <span className=\"text\">翻转</span>\n      </Dropdown>\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\n\n// 图片裁剪\nexport default observer(() => {\n  const { activeLayer, setEditStatus } = templateStore\n\n  // 裁剪图片\n  const clipImage = () => {\n    setEditStatus(activeLayer?.id || '')\n  }\n\n  return (\n    <ToolItem onClick={clipImage}>\n      <span className=\"text\">裁剪</span>\n    </ToolItem>\n  )\n})","import { ToolItem, ColorItem } from '../style'\nimport { Popover } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { ChromePicker, ColorResult } from 'react-color'\nimport { cloneDeep } from 'lodash'\nimport { LAYER_TYPE, RectShape } from 'types'\n\n// 形状填充颜色\nexport default observer(() => {\n  const { layerType, activeLayer, setLayer } = templateStore\n\n  // 当前形状\n  let shapeInfo: Partial<RectShape> = {}\n  if (layerType === LAYER_TYPE.CIRCLE) {\n    shapeInfo = activeLayer?.circleInfo as RectShape\n  } else if (layerType === LAYER_TYPE.RECT) {\n    shapeInfo = activeLayer?.rectInfo as RectShape\n  }\n\n  // 选择形状填充颜色\n  const onFillColorChange = (clr: ColorResult) => {\n    const rgba = `rgba(${clr.rgb.r}, ${clr.rgb.g}, ${clr.rgb.b}, ${clr.rgb.a})`\n    // 矩形\n    if (layerType === LAYER_TYPE.RECT) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.rectInfo) {\n        layer.rectInfo.fill = rgba\n        setLayer(layer)\n      }\n    }\n    // 圆形\n    if (layerType === LAYER_TYPE.CIRCLE) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.circleInfo) {\n        layer.circleInfo.fill = rgba\n        setLayer(layer)\n      }\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Popover\n        content={<ChromePicker color={shapeInfo.fill} onChange={onFillColorChange} />}\n        trigger=\"click\"\n        placement=\"bottomLeft\"\n      >\n        <ColorItem style={{ backgroundColor: shapeInfo.fill }} />\n      </Popover>\n    </ToolItem>\n  )\n})","import { ToolItem, ColorItem } from '../style'\nimport { Popover } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { ChromePicker, ColorResult } from 'react-color'\nimport { cloneDeep } from 'lodash'\nimport { LAYER_TYPE, RectShape } from 'types'\n\n// 形状边框颜色\nexport default observer(() => {\n  const { layerType, activeLayer, setLayer } = templateStore\n\n  // 当前形状\n  let shapeInfo: Partial<RectShape> = {}\n  if (layerType === LAYER_TYPE.CIRCLE) {\n    shapeInfo = activeLayer?.circleInfo as RectShape\n  } else if (layerType === LAYER_TYPE.RECT) {\n    shapeInfo = activeLayer?.rectInfo as RectShape\n  }\n\n  // 选择形状描边颜色\n  const onBorderColorChange = (clr: ColorResult) => {\n    const rgba = `rgba(${clr.rgb.r}, ${clr.rgb.g}, ${clr.rgb.b}, ${clr.rgb.a})`\n    // 矩形\n    if (layerType === LAYER_TYPE.RECT) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.rectInfo) {\n        layer.rectInfo.borderColor = rgba\n        setLayer(layer)\n      }\n    }\n    // 圆形\n    if (layerType === LAYER_TYPE.CIRCLE) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.circleInfo) {\n        layer.circleInfo.borderColor = rgba\n        setLayer(layer)\n      }\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Popover\n        content={<ChromePicker color={shapeInfo.borderColor} onChange={onBorderColorChange} />}\n        trigger=\"click\"\n        placement=\"bottomLeft\"\n      >\n        <ColorItem style={{ backgroundColor: shapeInfo.borderColor }} />\n      </Popover>\n    </ToolItem>\n  )\n})","export default __webpack_public_path__ + \"static/media/border-weight.505b2f5f.svg\";","import { ToolItem } from '../style'\nimport { Popover, Slider } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { cloneDeep } from 'lodash'\nimport { LAYER_TYPE, RectShape } from 'types'\nimport borderWidthIcon from 'assets/border-weight.svg'\n\n// 形状边框粗细\nexport default observer(() => {\n  const { layerType, activeLayer, setLayer } = templateStore\n\n  // 当前形状\n  let shapeInfo: Partial<RectShape> = {}\n  if (layerType === LAYER_TYPE.CIRCLE) {\n    shapeInfo = activeLayer?.circleInfo as RectShape\n  } else if (layerType === LAYER_TYPE.RECT) {\n    shapeInfo = activeLayer?.rectInfo as RectShape\n  }\n\n  // 形状描边粗细改变\n  const onBorderWidthChange = (val: number) => {\n    // 矩形\n    if (layerType === LAYER_TYPE.RECT) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.rectInfo) {\n        layer.rectInfo.borderWidth = val\n        setLayer(layer)\n      }\n    }\n    // 圆形\n    if (layerType === LAYER_TYPE.CIRCLE) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.circleInfo) {\n        layer.circleInfo.borderWidth = val\n        setLayer(layer)\n      }\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Popover\n        content={\n          <Slider\n            value={shapeInfo.borderWidth}\n            min={0}\n            max={50}\n            step={1}\n            style={{ width: 180 }}\n            onChange={onBorderWidthChange}\n          />\n        }\n        trigger=\"click\"\n        placement=\"bottomRight\"\n      >\n        <img src={borderWidthIcon} width=\"24\" height=\"24\" alt=\"\" />\n      </Popover>\n    </ToolItem>\n  )\n})","export default __webpack_public_path__ + \"static/media/border-style.11c5ec46.svg\";","import styled from '@emotion/styled'\nimport { ToolItem } from '../style'\nimport { Dropdown, Menu } from 'antd'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { cloneDeep } from 'lodash'\nimport { LAYER_TYPE } from 'types'\nimport borderStyleIcon from 'assets/border-style.svg'\n\n// 形状边框样式\nexport default observer(() => {\n  const { layerType, activeLayer, setLayer } = templateStore\n\n  // 形状描边样式改变\n  const onBorderStyleChange = (val: string) => {\n    // 矩形\n    if (layerType === LAYER_TYPE.RECT) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.rectInfo) {\n        layer.rectInfo.borderStyle = val\n        setLayer(layer)\n      }\n    }\n    // 圆形\n    if (layerType === LAYER_TYPE.CIRCLE) {\n      const layer = cloneDeep(activeLayer)\n      if (layer?.circleInfo) {\n        layer.circleInfo.borderStyle = val\n        setLayer(layer)\n      }\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Dropdown \n        overlay={\n          <Menu style={{ width: 120 }}>\n            <Menu.Item\n              key=\"1\"\n              style={{ padding: '20px 10px' }}\n              onClick={() => onBorderStyleChange('solid')}\n            >\n              <BorderSolid />\n            </Menu.Item>\n            <Menu.Item\n              key=\"2\"\n              style={{ padding: '20px 10px' }}\n              onClick={() => onBorderStyleChange('dashed')}\n            >\n              <BorderDashed />\n            </Menu.Item>\n            <Menu.Item\n              key=\"3\"\n              style={{ padding: '20px 10px' }}\n              onClick={() => onBorderStyleChange('dotted')}\n            >\n              <BorderDotted />\n            </Menu.Item>\n          </Menu>\n        }\n        trigger={['click']}\n      >\n        <img src={borderStyleIcon} width=\"24\" height=\"24\" alt=\"\" />\n      </Dropdown>\n    </ToolItem>\n  )\n})\n\nconst BorderSolid = styled.div`\n  width: 100%;\n  height: 0;\n  border-top: 4px solid #000;\n`\n\nconst BorderDashed = styled.div`\n  width: 100%;\n  height: 0;\n  border-top: 4px dashed #000;\n`\n\nconst BorderDotted = styled.div`\n  width: 100%;\n  height: 0;\n  border-top: 4px dotted #000;\n`","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { Popover, Slider } from 'antd'\nimport { cloneDeep } from 'lodash'\n\n// 图层层级\nexport default observer(() => {\n  const { activeLayer, layers, setLayerLevel, setLayers } = templateStore\n\n  // 图层的层级关系\n  const levelInfo = {\n    min: 1,\n    max: 100,\n    current: 1\n  }\n  if (activeLayer) {\n    levelInfo.current = layers.findIndex(l => l.id === activeLayer.id) + 1\n    levelInfo.max = layers.length\n  }\n\n  // 改变层级\n  const onLevelChange = (val: number) => {\n    // 下 -> 上\n    if (val > levelInfo.current) {\n      layers.forEach((l, idx) => {\n        if (idx + 1 > levelInfo.current && idx + 1 <= val) {\n          setLayerLevel(l.id, l.zIndex - 1)\n        }\n      })\n      activeLayer && setLayerLevel(activeLayer.id, activeLayer.zIndex + (val - levelInfo.current))\n    } else { // 上 -> 下\n      layers.forEach((l, idx) => {\n        if (idx + 1 >= val && idx + 1 < levelInfo.current) {\n          setLayerLevel(l.id, l.zIndex + 1)\n        }\n      })\n      activeLayer && setLayerLevel(activeLayer.id, activeLayer.zIndex - (levelInfo.current - val))\n    }\n    setLayers(cloneDeep(layers).sort((a, b) => a.zIndex - b.zIndex))\n  }\n\n  return (\n    <ToolItem>\n      <Popover\n        content={\n          <Slider\n            value={levelInfo.current}\n            min={levelInfo.min}\n            max={levelInfo.max}\n            style={{ width: 180 }}\n            onChange={onLevelChange}\n          />\n        }\n        trigger=\"click\"\n        placement=\"bottomRight\"\n      >\n        <span className=\"text\">层级调整</span>\n      </Popover>\n    </ToolItem>\n  )\n})","export default __webpack_public_path__ + \"static/media/opacity.6dad8d31.svg\";","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { Popover, Slider } from 'antd'\nimport { cloneDeep } from 'lodash'\nimport opacityIcon from 'assets/opacity.svg'\n\n// 图层透明度\nexport default observer(() => {\n  const { activeLayer, setLayer } = templateStore\n\n  // 透明度\n  const opacity = activeLayer?.opacity\n\n  const onOpacityChange = (val: number) => {\n    const layer = cloneDeep(activeLayer)\n    if (layer) {\n      layer.opacity = val\n      setLayer(layer)\n    }\n  }\n\n  return (\n    <ToolItem>\n      <Popover\n        content={\n          <Slider\n            value={opacity}\n            min={0}\n            max={1}\n            step={0.01}\n            style={{ width: 180 }}\n            onChange={onOpacityChange}\n          />\n        }\n        trigger=\"click\"\n        placement=\"bottomRight\"\n      >\n        <img src={opacityIcon} width=\"24\" height=\"24\" alt=\"\" />\n      </Popover>\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { LockOutlined, UnlockOutlined } from '@ant-design/icons'\n\n// 锁定图层\nexport default observer(() => {\n  const { activeLayer, setLayerLock } = templateStore\n\n  // 图层是否被锁定了\n  const isLocked = activeLayer?.isLocked || false\n\n  // 切换图层锁定状态\n  const onToggleLayerLock = () => {\n    if (activeLayer) {\n      setLayerLock(activeLayer.id, !activeLayer.isLocked)\n    }\n  }\n\n  return (\n    <ToolItem className={[\"item-lock\", isLocked ? 'active' : ''].join(' ')} onClick={onToggleLayerLock}>\n      {isLocked ? <LockOutlined style={{ fontSize: 24 }} /> : <UnlockOutlined style={{ fontSize: 24 }} />}\n    </ToolItem>\n  )\n})","import { ToolItem } from '../style'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { DeleteOutlined } from '@ant-design/icons'\n\n// 删除图层\nexport default observer(() => {\n  const { activeLayer, removeLayer } = templateStore\n\n  // 删除图层\n  const onRemove = () => {\n    if (activeLayer) {\n      removeLayer(activeLayer.id)\n    }\n  }\n\n  return (\n    <ToolItem onClick={onRemove}>\n      <DeleteOutlined style={{ fontSize: 24 }} />\n    </ToolItem>\n  )\n})","import styled from '@emotion/styled'\nimport { observer } from 'mobx-react'\nimport { templateStore } from 'store/template'\nimport { LAYER_TYPE } from 'types'\n\nimport CanvasSize from './tool-items/CanvasSize'\nimport ClearCanvas from './tool-items/ClearCanvas'\nimport BackgroundColor from './tool-items/BackgroundColor'\n\nimport TextColor from './tool-items/text/TextColor'\nimport FontFamily from './tool-items/text/FontFamily'\nimport FontSize from './tool-items/text/FontSize'\nimport FontWeight from './tool-items/text/FontWeight'\nimport Underline from './tool-items/text/Underline'\nimport TextAlign from './tool-items/text/TextAlign'\n\nimport FlipImage from './tool-items/image/Flip'\nimport ClipImage from './tool-items/image/Clip'\n\nimport ShapeFillColor from './tool-items/shape/ShapeFillColor'\nimport ShapeBorderColor from './tool-items/shape/ShapeBorderColor'\nimport ShapeBorderWidth from './tool-items/shape/ShapeBorderWidth'\nimport ShapeBorderStyle from './tool-items/shape/ShapeBorderStyle'\n\nimport LayerOrder from './tool-items/common/LayerOrder'\nimport Opacity from './tool-items/common/Opacity'\nimport LockLayer from './tool-items/common/LockLayer'\nimport RemoveLayer from './tool-items/common/RemoveLayer'\n\nexport default observer(() => {\n  const { layerType, activeLayer } = templateStore\n\n  // 图层是否被锁定了\n  const isLocked = activeLayer?.isLocked || false\n\n  return <ToolBarWrapper id=\"toolBar\">\n    <ItemGroup className={isLocked ? 'locked' : ''}>\n      {/* 画布尺寸 */}\n      {[LAYER_TYPE.EMPTY].includes(layerType) && <CanvasSize />}\n      {/* 背景颜色 */}\n      {[LAYER_TYPE.BACKGROUND].includes(layerType) && <BackgroundColor />}\n\n      {/* 文字相关 */}\n      {[LAYER_TYPE.TEXT].includes(layerType) &&\n        <>\n          {/* 文字颜色 */}\n          <TextColor />\n          {/* 字体 */}\n          <FontFamily />\n          {/* 字体大小 */}\n          <FontSize />\n          {/* 加粗 */}\n          <FontWeight />\n          {/* 下划线 */}\n          <Underline />\n          {/* 水平对齐 */}\n          <TextAlign />\n        </>\n      }\n\n      {/* 图片相关 */}\n      {[LAYER_TYPE.IMAGE].includes(layerType) &&\n        <>\n          {/* 图片翻转 */}\n          <FlipImage />\n          {/* 图片裁剪 */}\n          <ClipImage />\n        </>\n      }\n\n      {/* 形状相关 */}\n      {[LAYER_TYPE.RECT, LAYER_TYPE.CIRCLE].includes(layerType) &&\n        <>\n          {/* 填充颜色 */}\n          <ShapeFillColor />\n          {/* 边框颜色 */}\n          <ShapeBorderColor />\n          {/* 边框粗细 */}\n          <ShapeBorderWidth />\n          {/* 边框样式 */}\n          <ShapeBorderStyle />\n        </>\n      }\n    </ItemGroup>\n    <ItemGroup className={isLocked ? 'locked' : ''}>\n      {/* 右侧图层公共属性 */}\n      {[LAYER_TYPE.IMAGE, LAYER_TYPE.TEXT, LAYER_TYPE.RECT, LAYER_TYPE.CIRCLE].includes(layerType) &&\n        <>\n          {/* 图层层级 */}\n          <LayerOrder />\n          {/* 透明度 */}\n          <Opacity />\n          {/* 图层锁定 */}\n          <LockLayer />\n          {/* 删除 */}\n          <RemoveLayer />\n        </>\n      }\n      {/* 清空画布 */}\n      {[LAYER_TYPE.EMPTY].includes(layerType) && <ClearCanvas />}\n    </ItemGroup>\n  </ToolBarWrapper>\n})\n\nconst ToolBarWrapper = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  height: 46px;\n  padding: 0 10px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n  user-select: none;\n`\n\nconst ItemGroup = styled.div`\n  display: flex;\n  align-items: center;\n\n  &.locked>div:not(.item-lock) {\n    display: none;\n  }\n`","import React, { MouseEvent, useCallback, useEffect, useRef, useState } from 'react'\nimport styled from '@emotion/styled'\nimport Footer from './Footer'\nimport Canvas from './Canvas'\nimport ToolBar from './tool-bar/Index'\nimport { ScaleContext, BackgroundContext } from 'store/context'\nimport { templateStore } from 'store/template'\nimport { observer } from 'mobx-react'\nimport { Layer } from 'types'\nimport { cloneDeep } from 'lodash'\nimport undoRedo from 'utils/undoRedo'\n\nconst { undo, redo } = undoRedo()\n\n// 暂存复制的图层\nlet copyLayer: Partial<Layer> = {}\n\n// 编辑器\nexport default observer(() => {\n  // 画布缩放值\n  const [scale, setScale] = useState(1)\n  // 画布父级容器dom ref\n  const scrollWrapperRef = useRef<HTMLDivElement>(null)\n  // 获取模板数据\n  const { template, resetSelectStatus, removeLayer, addLayer } = templateStore\n\n  // 是否选中背景\n  const [isSelectedBackground, setIsSelectedBackground] = useState(false)\n\n  // 自适应\n  const responsive = useCallback(() => {\n    const wrapperEl = scrollWrapperRef.current\n    const canvasWidth = template.global.width\n    const canvasHeight = template.global.height\n    let scale = 1\n    if (wrapperEl && wrapperEl.clientWidth < canvasWidth + 100) {\n      scale = (wrapperEl.clientWidth - 100) / canvasWidth\n    }\n    if (wrapperEl && wrapperEl.clientHeight < (canvasHeight * scale + 100)) {\n      scale = (wrapperEl.clientHeight - 100) / canvasHeight\n    }\n    setScale(scale)\n  }, [template.global.height, template.global.width])\n\n  // 首次渲染画布尺寸适配\n  useEffect(() => {\n    responsive()\n  }, [responsive])\n\n  // 键盘事件监听\n  const onKeyboardListener = useCallback((e: KeyboardEvent) => {\n    // 页面失焦\n    if (document.activeElement === document.body || document.activeElement === null) {\n      // 删除\n      if (e.key === 'Backspace' || e.key === 'Delete') {\n        const layer = template.layers.find(layer => layer.isSelected)\n        if (layer) {\n          removeLayer(layer.id)\n        }\n      }\n      // 复制\n      if (e.key === 'c' && (e.metaKey || e.ctrlKey)) {\n        const layer = template.layers.find(layer => layer.isSelected)\n        if (layer && !template.layers.some(l => l.isEditing) && !layer.isLocked) {\n          copyLayer = cloneDeep(layer)\n        }\n      }\n      // 粘贴\n      if (e.key === 'v' && (e.metaKey || e.ctrlKey)) {\n        if (!template.layers.some(l => l.isEditing)) {\n          if (copyLayer.id) {\n            copyLayer.position && (copyLayer.position.x += 10)\n            copyLayer.position && (copyLayer.position.y += 10)\n            copyLayer.id = String(Date.now())\n            copyLayer.zIndex = template.layers.length ? template.layers[template.layers.length - 1].zIndex + 1 : 1\n            resetSelectStatus()\n            addLayer(copyLayer as Layer)\n          }\n        }\n      }\n      // 撤销\n      if (e.key === 'z' && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n        undo()\n      }\n      // 重做\n      if (e.key === 'z' && (e.metaKey || e.ctrlKey) && e.shiftKey) {\n        redo()\n      }\n    }\n  }, [addLayer, removeLayer, resetSelectStatus, template.layers])\n\n  useEffect(() => {\n    document.addEventListener('keydown', onKeyboardListener)\n    return () => { document.removeEventListener('keydown', onKeyboardListener) }\n  }, [onKeyboardListener])\n\n  // 取消所有图层的选中状态包括背景\n  const resetStatus = (e: MouseEvent<HTMLElement>) => {\n    // self\n    if ((e.target as HTMLElement).id === 'editorContainer') {\n      resetSelectStatus()\n      setIsSelectedBackground(false)\n    }\n  }\n\n  return <Wrapper>\n    <ToolBar />\n    <ScrollWrapper ref={scrollWrapperRef}>\n      <Container id=\"editorContainer\" onMouseDown={resetStatus}>\n        <BackgroundContext.Provider value={{ isSelectedBackground, setIsSelectedBackground }}>\n          <ScaleContext.Provider value={scale}>\n            <Canvas />\n          </ScaleContext.Provider>\n        </BackgroundContext.Provider>\n      </Container>\n    </ScrollWrapper>\n    <Footer scale={scale} setScale={(num) => setScale(num)} responsive={responsive} />\n  </Wrapper>\n})\n\nconst Wrapper = styled.div`\n  position: relative;\n  flex: 1;\n  overflow: hidden;\n`\n\nconst ScrollWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  height: calc(100% - 88px);\n  overflow: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #eef2f8;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n`\n\nconst Container = styled.div`\n  position: absolute;\n  display: flex;\n  align-items: center;\n  min-width: 100%;\n  min-height: 100%;\n`","import React from 'react'\nimport styled from '@emotion/styled'\nimport Sidebar from './side-bar/Sidebar'\nimport Editor from './Editor'\n\nexport default function Main () {\n  return <MainBody>\n    <Sidebar />\n    <Editor />\n  </MainBody>\n}\n\nconst MainBody = styled.main`\n  display: flex;\n  height: calc(100vh - 56px);\n  background-color: #eef2f8;\n  overflow: hidden;\n`\n","import React from 'react'\nimport Nav from 'components/Nav'\nimport Main from 'components/Main'\nimport './App.css'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Nav />\n      <Main />\n    </div>\n  );\n}\n\nexport default App\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from 'pages/App'\nimport reportWebVitals from './reportWebVitals'\nimport 'antd/dist/antd.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}