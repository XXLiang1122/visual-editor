(this["webpackJsonpvisual-editor"]=this["webpackJsonpvisual-editor"]||[]).push([[0],{189:function(e,t,n){},325:function(e,t,n){},327:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(31),r=n.n(o),c=(n(189),n(13)),s=n(70),l=n.n(s),d=n(91),h=n(35),u=n(11),f=n(47),x=n(165),b=n.n(x),p=function(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}},g=function(e,t,n){return n/=180/Math.PI,{x:(e.x-t.x)*Math.cos(n)-(e.y-t.y)*Math.sin(n)+t.x,y:(e.x-t.x)*Math.sin(n)+(e.y-t.y)*Math.cos(n)+t.y}};function y(e){return j.apply(this,arguments)}function j(){return(j=Object(d.a)(l.a.mark((function e(t){var n,i,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.querySelector(t),(i=n.cloneNode(!0)).style.transform="",i.style.position="fixed",i.style.left="-9999px",document.body.appendChild(i),i.querySelectorAll("img").forEach((function(e){e.setAttribute("crossOrigin","anonymous")})),a={width:i.offsetWidth,height:i.offsetHeight,backgroundColor:null,useCORS:!0},e.abrupt("return",new Promise((function(e,t){b()(i,a).then((function(t){var n=t.toDataURL("image/png");e(n)})).catch((function(e){t(e)})).finally((function(){document.body.removeChild(i)}))})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v,O,m=n(2);function w(){var e=Object(i.useState)(!1),t=Object(h.a)(e,2),n=t[0],a=t[1],o=function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.prev=1,e.next=4,y("#canvasContent");case 4:t=e.sent,(n=document.createElement("a")).href=t,n.setAttribute("download","".concat(Date.now(),".png")),n.click(),n.remove(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:a(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(m.jsxs)(A,{children:[Object(m.jsx)(C,{src:"data:image/png;base64,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"}),Object(m.jsx)(f.a,{loading:n,type:"primary",onClick:o,children:"\u5bfc\u51fa\u56fe\u7247"})]})}var A=u.a.header(v||(v=Object(c.a)(["\n  height: 56px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 20px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n"]))),C=u.a.img(O||(O=Object(c.a)(["\n  width: 48px;\n  height: 48px;\n  object-fit: cover;\n"]))),k=n(53),M=n(167),L=n.n(M).a.create({baseURL:"https://pixabay.com/api",timeout:1e4});L.interceptors.response.use((function(e){return e.data}));var E,S=L,B=n(337),I=n(342),T=n(336),z=n(331),D=n(10),R={global:{width:1280,height:720},background:{color:"#fff"},layers:[{id:"1",type:"image",width:510,height:340,position:{x:100,y:100},rotate:0,reverse:{x:1,y:1},source:{imageUrl:"https://cdn.pixabay.com/photo/2014/04/13/20/49/cat-323262__340.jpg"},opacity:1,zIndex:1},{id:"2",type:"text",width:380,height:72,position:{x:100,y:500},rotate:0,source:{content:"\u53cc\u51fb\u7f16\u8f91\u6587\u5b57"},style:{font:"Microsoft Yahei",fontSize:60,lineHeight:1.2,color:"#000",textAlign:"left",fontWeight:400,underline:!1},opacity:1,zIndex:2}]};!function(e){e.EMPTY="empty",e.IMAGE="image",e.TEXT="text",e.BACKGROUND="background"}(E||(E={}));var U=n(24),N=[],F=0,P=!1;function Y(){var e=J.setCanUseUndo,t=J.setCanUseRedo;return{init:function(e){N.push(e)},pushHistory:function(){if(P)P=!1;else{var n=Object(U.cloneDeep)(J.template);n.layers=n.layers.map((function(e){return e.isSelected=!1,e.isEditing=!1,e.isHover=!1,e})),F++,N[F]=n,N.splice(F+1,N.length),e(!0),t(!1),N.length>100&&(N.shift(),F--)}},undo:function(){if(N[F-1]){P=!0,F--;var n=N[F];J.setTemplate(Object(U.cloneDeep)(n)),J.setLayerType(E.EMPTY),t(!0),N[F-1]||e(!1)}},redo:function(){if(N[F+1]){P=!0,F++;var n=N[F];J.setTemplate(Object(U.cloneDeep)(n)),J.setLayerType(E.EMPTY),e(!0),N[F+1]||t(!1)}}}}var K=Object.assign(R,{layers:R.layers.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{isSelected:!1,isEditing:!1,isHover:!1,isLocked:!1,scale:1})}))}),Q=localStorage.getItem("TEMPLATE");Q&&(K=JSON.parse(Q));var J=Object(D.n)({template:K,layerType:E.EMPTY,needUpdateLayerHeight:!1,isMoving:!1,canUseUndo:!1,canUseRedo:!1,get layers(){return this.template.layers},getTemplate:function(){var e=Object(U.cloneDeep)(J.template);return e.layers=e.layers.map((function(e){return"text"===e.type&&e.style&&e.scale&&(e.style.fontSize*=e.scale),delete e.isSelected,delete e.isEditing,delete e.scale,e})),e},setTemplate:function(e){this.template=e},setCanvasSize:function(e){this.template.global.width=e.width,this.template.global.height=e.height},setLayers:function(e){this.template.layers=e},setLayer:function(e){var t=this.layers.findIndex((function(t){return t.id===e.id}));t>-1&&!this.layers[t].isLocked&&(this.layers[t]=e)},addLayer:function(e){this.layers.push(e),"image"===e.type?this.setLayerType(E.IMAGE):"text"===e.type&&this.setLayerType(E.TEXT)},removeLayer:function(e){var t=this.layers.findIndex((function(t){return t.id===e}));t>-1&&!this.layers[t].isLocked&&(this.layers.splice(t,1),this.setLayerType(E.EMPTY))},setLayerLevel:function(e,t){var n=this.layers.findIndex((function(t){return t.id===e}));n>-1&&(this.layers[n].zIndex=t)},selectLayer:function(e){var t=this;this.layers.forEach((function(n){n.isSelected=n.id===e,n.isSelected&&("image"===n.type?t.setLayerType(E.IMAGE):"text"===n.type&&t.setLayerType(E.TEXT))})),document.dispatchEvent(new Event("mousedown"))},hoverLayer:function(e){this.layers.forEach((function(t){t.isHover=!!e&&t.id===e}))},setLayerType:function(e){this.layerType=e},editTextLayer:function(e){this.layers.some((function(t){return t.id===e&&t.isLocked}))||this.layers.forEach((function(t){t.isEditing=t.id===e}))},setLayerLock:function(e,t){var n=this.layers.findIndex((function(t){return t.id===e}));n>-1&&(this.layers[n].isLocked=t,this.layers[n].isEditing=!1)},resetSelectStatus:function(){this.layers.forEach((function(e){e.isSelected=!1})),this.setLayerType(E.EMPTY)},resetEditStatus:function(){this.layers.forEach((function(e){e.isEditing=!1}))},setBackgroundColor:function(e){this.template.background.color=e},setNeedUpdateLayerHeight:function(e){this.needUpdateLayerHeight=e},setIsMoving:function(e){this.isMoving=e},setCanUseUndo:function(e){this.canUseUndo=e},setCanUseRedo:function(e){this.canUseRedo=e}},{setTemplate:D.f.bound,getTemplate:D.f.bound,setCanvasSize:D.f.bound,setLayers:D.f.bound,setLayer:D.f.bound,addLayer:D.f.bound,removeLayer:D.f.bound,selectLayer:D.f.bound,setLayerLevel:D.f.bound,hoverLayer:D.f.bound,setLayerType:D.f.bound,editTextLayer:D.f.bound,setLayerLock:D.f.bound,resetSelectStatus:D.f.bound,resetEditStatus:D.f.bound,setBackgroundColor:D.f.bound,setNeedUpdateLayerHeight:D.f.bound,setIsMoving:D.f.bound,setCanUseUndo:D.f.bound,setCanUseRedo:D.f.bound});Object(D.o)((function(){return J.layers.map((function(e){return e.isSelected})).join("")}),(function(){J.resetEditStatus();var e=J.layers.findIndex((function(e){var t;return"text"===e.type&&!(null===(t=e.source.content)||void 0===t?void 0:t.replaceAll(/\n/g,""))}));e>-1&&J.removeLayer(J.layers[e].id)}));var V=Y(),X=V.init,Z=V.pushHistory;X(K);Object(D.o)((function(){var e=Object(U.cloneDeep)(J.template);return e.layers=e.layers.map((function(e){return delete e.isSelected,delete e.isEditing,delete e.isHover,e})),JSON.stringify(e)}),(function(){!function(){var e=Object(U.cloneDeep)(J.template);e.layers=e.layers.map((function(e){return e.isSelected=!1,e.isEditing=!1,e.isHover=!1,e})),localStorage.setItem("TEMPLATE",JSON.stringify(e))}(),Z()}),{delay:500});var H,W,G,q,_=n(30),$=Object(_.a)((function(e){var t=e.image,n=J.template,i=J.layers,a=J.addLayer,o=J.resetSelectStatus;return Object(m.jsx)(ee,{style:{flexBasis:"".concat(100*t.webformatWidth/t.webformatHeight,"px")},draggable:"true",onClick:function(){var e={id:String(Date.now()),type:"image",width:t.webformatWidth,height:t.webformatHeight,position:{x:(n.global.width-t.webformatWidth)/2,y:(n.global.height-t.webformatHeight)/2},rotate:0,reverse:{x:1,y:1},source:{imageUrl:t.webformatURL},opacity:1,zIndex:i.length?i[i.length-1].zIndex+1:1,isSelected:!0,isEditing:!1,isLocked:!1,scale:1};o(),a(e)},onDragStartCapture:function(e){e.dataTransfer.setData("image",JSON.stringify(t))},children:Object(m.jsx)("img",{src:t.webformatURL,alt:"",draggable:"false"})})})),ee=u.a.div(H||(H=Object(c.a)(["\n  position: relative;\n  margin: 0 10px 10px 0;\n  background-color: #f0f1f4;\n  overflow: hidden;\n  flex-grow: 1;\n\n  img {\n    min-width: 100%;\n    height: 100px;\n    object-fit: cover;\n  }\n"]))),te=Object(_.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,i=J.resetSelectStatus,a=J.editTextLayer;return Object(m.jsx)(f.a,{size:"large",style:{width:"100%"},onClick:function(){var o={id:String(Date.now()),type:"text",width:380,height:72,position:{x:(e.global.width-300)/2,y:(e.global.height-72)/2},rotate:0,source:{content:"\u53cc\u51fb\u7f16\u8f91\u6587\u5b57"},style:{font:"\u5fae\u8f6f\u96c5\u9ed1",fontSize:60,lineHeight:1.2,color:"#000",textAlign:"left",fontWeight:400,underline:!1},opacity:1,zIndex:t.length?t[t.length-1].zIndex+1:1,isSelected:!0,isEditing:!0,isLocked:!1,scale:1};i(),n(o),a(o.id)},children:"\u6dfb\u52a0\u6587\u672c"})})),ne=Object(_.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,i=J.resetSelectStatus,a=function(a,o,r){var c={id:String(Date.now()),type:"image",width:a,height:o,position:{x:(e.global.width-a)/2,y:(e.global.height-o)/2},rotate:0,reverse:{x:1,y:1},source:{imageUrl:r},opacity:1,zIndex:t.length?t[t.length-1].zIndex+1:1,isSelected:!0,isEditing:!1,isLocked:!1,scale:1};i(),n(c)};return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(ie,{htmlFor:"uploadImage",children:Object(m.jsx)(f.a,{size:"large",children:"\u9009\u62e9\u672c\u5730\u56fe\u7247"})}),Object(m.jsx)("input",{type:"file",id:"uploadImage",accept:"image/*",style:{display:"none"},onChange:function(e){var t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;if("string"===typeof n){var i=new Image;i.src=n,i.onload=function(){a(i.width,i.height,n)}}}}})]})})),ie=u.a.label(W||(W=Object(c.a)(["\n  display: block;\n  width: 100%;\n  margin-bottom: 16px;\n  cursor: pointer;\n\n  button {\n    width: 100%;\n    pointer-events: none;\n  }\n"]))),ae=B.a.Panel,oe=T.a.Search,re=!1,ce=!1;function se(){var e=Object(i.useState)([]),t=Object(h.a)(e,2),n=t[0],a=t[1],o=Object(i.useState)({page:1,per_page:20,image_type:"all",q:"",orientation:"all",safesearch:!0}),r=Object(h.a)(o,2),c=r[0],s=r[1],l=Object(i.useState)(!1),d=Object(h.a)(l,2),u=d[0],x=d[1];Object(i.useEffect)((function(){var e;(e=c,S({url:"/",params:Object(k.a)({key:"24178889-8dbe9fccf0c585814c1dcb342",lang:"zh"},e)})).then((function(e){a(ce?function(t){return t.concat(e.hits)}:e.hits)})).finally((function(){re=!1}))}),[c]);return Object(m.jsx)(fe,{children:Object(m.jsxs)(B.a,{defaultActiveKey:["1"],collapsible:"header",children:[Object(m.jsx)(ae,{header:Object(m.jsx)("div",{style:{width:"300px"},children:"\u56fe\u7247"}),extra:function(){var e=function(e,t){t.preventDefault(),e&&(ce=!1,s(Object.assign({},c,{q:e,page:1})))};return Object(m.jsx)(z.a,{content:function(){return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(oe,{placeholder:"\u641c\u7d22",onSearch:e,style:{width:200}})})},title:"\u7b5b\u9009",trigger:"click",visible:u,onVisibleChange:function(e){return x(e)},children:Object(m.jsx)(I.a,{onClick:function(e){e.stopPropagation(),x(!0)}})})}(),children:Object(m.jsxs)(xe,{children:[Object(m.jsx)(ne,{}),n.map((function(e){return Object(m.jsx)($,{image:e},e.id)})),Object(m.jsx)(f.a,{style:{width:"100%",marginTop:"20px"},onClick:function(){if(!re){re=!0;var e=c.page;ce=!0,s(Object.assign({},c,{page:e?e+1:1}))}},children:"\u52a0\u8f7d\u66f4\u591a"})]})},"1"),Object(m.jsx)(ae,{header:Object(m.jsx)("div",{style:{width:"300px"},children:"\u6587\u5b57"}),children:Object(m.jsx)(xe,{children:Object(m.jsx)(te,{})})},"2")]})})}var le,de,he,ue,fe=u.a.aside(G||(G=Object(c.a)(["\n  flex: none;\n  display: flex;\n  flex-direction: column;\n  width: 400px;\n  height: 100%;\n  background-color: #fff;\n  border-right: 1px solid #ddd;\n  overflow-y: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #fff;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n\n  .ant-collapse {\n    border: 0;\n    background-color: #fff;\n  }\n"]))),xe=u.a.div(q||(q=Object(c.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  padding-left: 10px;\n  user-select: none;\n\n  &:after {\n    content: '';\n    display: block;\n    flex-grow: 99999;\n  }\n"]))),be=n(332),pe=Y(),ge=pe.undo,ye=pe.redo,je=Object(_.a)((function(e){var t=e.scale,n=e.setScale,i=J.canUseUndo,a=J.canUseRedo;return Object(m.jsxs)(ve,{children:[Object(m.jsxs)(Oe,{children:[Object(m.jsx)(be.a,{className:"slider",tipFormatter:null,defaultValue:100*t,min:10,max:500,onChange:function(e){n(e/100)}}),Object(m.jsxs)("div",{className:"scale",children:[Math.round(100*t),"%"]})]}),Object(m.jsxs)(me,{children:[Object(m.jsx)(we,{className:i?"active":"",onClick:ge,children:Object(m.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArRJREFUWEfFl09rE1EQwGfyB/SgKOjBQz1IIeBBEPsB6tFL8uZBCiIIgiiKigcpiKDtwYJ4kFpQiAh68WDovrdRWMGDfoAW9KBURRCUigoe9BJD3o5syZbNZje7G5P4IITMmzfzezPzZgjCf16Yxj8RXQWAeWae11rPpTmTVicRQAhxGREXfIPDhugLQESXAOBm8DaI+MCyrBNpb5ikFwtARBcAYDFk4I3rujO2bb9NMpx2PxJACHEGEe+M2rlnvwdASnmSme+Nw3kPABEdB4CHEeHzIvKtIzfM7HqrUCgY79v7DQCe/Hur1friOM6vzCkQQhxFxEdpDyborSGicl13WWu92k93IwXVanWy3W5/GJLzLjOIWDPGLMYV7mYNENFjj2UUEAAQ+3q6ijAOwms+acAQcQIASp3PrjSF3PMKoiAG6X5CiNuIeD4JIrIPDBFiGhFfhDppzbKs076sXyeMqolZpVRXa05KTblcLuXz+bWgHjNP+a8jaRb0QLiue8y27UzPVQgxi4g3Nm+NeMWyrI0BlzgNw+kYdBgR0U8A2NmBeKWUOpgKwFMKQDxn5lNa609JoQ/vE9EKABzy5caY7Y1G43diBPwDQoi5YrG4UK/XW1mdhy7hHy8ppd6nBhjEafCMdwFEvObLmPmw1vrl2ACIaBkAZABgUmv9cWwAUsrXzHzAB2g2m1scx/kzFoBKpTKRy+XeAcDWDsAzpdSR1K/gX/MvpVxi5nOB8J/VWt8dCwAReRPWa2j+WkfEKcuyvo4cQEp5i5kvhtpw13+LodeAEGJHoVDYb4y5DgDTofTVlVIzQVlmgGq1utsYc5+Zt0XUxl4A2BdTMz3OB0qBEKJnxKYo0kjn4wBYZeaa1roWB5k5BVLKPcy8HmPwBwB8RsQVZn6ilHqaFJ3MAEkGs+7/BQfySDDlTlsQAAAAAElFTkSuQmCC",alt:""})}),Object(m.jsx)(we,{className:a?"active":"",onClick:ye,children:Object(m.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAqtJREFUWEfFljGrE0EQx2duQ0yjiKA2TxBEfWjhg2dno1gdaLJzD2MlKOLDRkUtLCx8tqIgPEGwULASD243ATvB9wVEsBCEh4qChQqKFlpcMrIhd1wul9wuOXEhhGRn5v+7uZ2ZRfjPC6vWl1KuIOINAGgrpcKy+JUCZMQT3VKISgGCIHjEzKdzTz0VolKAVqu1z/O8pwCw3xaiUgAj6gpROYArhBOA7/ub6vX6HCJuAwCBiJ5ZcRwL821+m/8NBDNvB4D7BVUwciZKAaSUi57nLTEzAcB8WVlZ7qcQEwHMuxRCXGLmZcugTma1Wm13GIbrhQDDg/QMAHY6RbU3DpVSbWM+BiClPIyILwpifQOAt+bDzJ9stIYdMW+aio8BSCkXhuKbs17MvKq1vmgjmtgUdEWzNSI+BkBEpomcyIkf0VqvuYgT0RUAuJPzGRMfASCiMwDwMOvU6/Xmu92uSbv1IqJzAPDARnwEIAiCx8x8KnFk5mta61vWygAQBMFJZn5iK57PwPvMqf+ulNriIm5sC4ZRYdqzcQdV0Gw2NwohfmY2XiqlDroC5OZAqXiaASLaMyyxRNPKuQjQQCBiW2u9YvMAgwzka5+Zb9oGsBGZZpMA7ELE9YxhpJRamjW4jf8AwPf9DY1G40/igIivoyg6YBNgVpu0FRPRKwBYGAb83e/393Y6HauWOwtEFsDM7vOZLNyLoujCLMFtfFMAKeVRRHyecyq91dqIlB7CxEBKeRsRr440CsS7URRdnlVokv/YOM6dhcRvTQhxPY7jN1rrH1XCFF5IiOgLAGydIPQOAD7m9xDxlxDibBiGX10AJ17JikZzWWBmdh7dUy+lUsplRDR3wsUycbNfOUAiSkTHEPE4M5sBtWPC6/nMzIe01h9sYNNydzH+F7Z/AWqi/yEtgkl8AAAAAElFTkSuQmCC",alt:""})})]})]})})),ve=u.a.footer(le||(le=Object(c.a)(["\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  width: 100%;\n  height: 44px;\n  padding: 0 40px;\n  background-color: #fff;\n  border-top: 1px solid #ddd;\n\n  .slider {\n    width: 240px;\n  }\n\n  .scale {\n    width: 100px;\n    padding-left: 20px;\n  }\n"]))),Oe=u.a.div(de||(de=Object(c.a)(["\n  display: flex;\n  align-items: center;\n"]))),me=u.a.div(he||(he=Object(c.a)(["\n  display: flex;\n  justify-content: space-around;\n  width: 120px;\n\n  img {\n    width: 22px;\n    height: 22px;\n    pointer-events: none;\n    user-select: none;\n  }\n"]))),we=u.a.div(ue||(ue=Object(c.a)(["\n  display: flex;\n  align-items: center;\n  padding: 6px 8px;\n  border-radius: 4px;\n  cursor: not-allowed;\n  opacity: .5;\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  &.active {\n    opacity: 1;\n    cursor: pointer;\n  }\n"]))),Ae=Object(i.createContext)(1),Ce=Object(i.createContext)(null),ke=n(170),Me=function e(t,n,i){var a=this;Object(ke.a)(this,e),this.handleMove=function(e){},this.handleUp=function(){},this.startCoords={x:0,y:0},this.preCoords={x:0,y:0},this.mouseUp=function(){document.onmousemove=null,document.onmouseup=null,a.handleUp()},this.mouseMove=function(e){var t=e.clientX-a.preCoords.x,n=e.clientY-a.preCoords.y;a.preCoords={x:e.clientX,y:e.clientY},a.handleMove({diff:{x:t,y:n},startCoords:a.startCoords,curCoords:a.preCoords})},this.mouseDown=function(e){a.startCoords={x:e.clientX,y:e.clientY},a.preCoords={x:e.clientX,y:e.clientY},document.onmousemove=a.mouseMove,document.onmouseup=a.mouseUp},this.mouseDown(t),this.handleMove=n,i&&(this.handleUp=i)};var Le,Ee,Se,Be,Ie,Te,ze,De,Re,Ue,Ne,Fe=n.p+"static/media/rotate.a7cc796d.svg",Pe=n.p+"static/media/lock.7263c59f.svg";!function(e){e.TL="topLeft",e.TR="topRight",e.BL="bottomLeft",e.BR="bottomRight",e.T="top",e.B="bottom",e.L="left",e.R="right"}(Ne||(Ne={}));var Ye,Ke=10,Qe=10,Je=[0,45,90,135],Ve=[{start:0,end:23,cursor:"nwse-resize"},{start:338,end:360,cursor:"nwse-resize"},{start:23,end:68,cursor:"ns-resize"},{start:68,end:113,cursor:"nesw-resize"},{start:113,end:158,cursor:"ew-resize"},{start:158,end:203,cursor:"nwse-resize"},{start:203,end:248,cursor:"ns-resize"},{start:248,end:293,cursor:"nesw-resize"},{start:293,end:338,cursor:"ew-resize"}],Xe=Object(_.a)((function(e){var t=e.info,n=Object(i.useContext)(Ae),a=J.layers,o=J.setLayer,r=J.isMoving,c=J.setIsMoving,s=Object(i.useState)([]),l=Object(h.a)(s,2),d=l[0],u=l[1],f=function(e,i){e.stopPropagation(),0===t.rotate?function(e,i){var r=a.findIndex((function(e){return e.id===t.id}));r>-1&&new Me(e,(function(e){var t=Object(U.cloneDeep)(a[r]),s=e.diff,l=s.x,d=s.y,h=t.width/t.height,u=t.position,f=u.x,x=u.y,b=t.width,p=t.height;switch(i){case Ne.TL:var g=t.height;f+=l/n,x-=(p=(b-=l/n)/h)-g;break;case Ne.TR:var y=t.height;x-=(p=(b+=l/n)/h)-y;break;case Ne.BL:f+=l/n,p=(b-=l/n)/h;break;case Ne.BR:p=(b+=l/n)/h;break;case Ne.T:p-=d/n,x+=d/n;break;case Ne.B:p+=d/n;break;case Ne.L:b-=l/n,f+=l/n;break;case Ne.R:b+=l/n}(b>Ke&&p>Qe||b>t.width||p>t.height)&&("text"===t.type&&t.height!==p&&t.scale&&(t.scale*=p/t.height),t.width=b,t.height=p,t.position.x=f,t.position.y=x),o(t),c(!0)}),(function(){c(!1)}))}(e,i):function(e,i){var r,s,l=(t.position.x+t.width/2)*n,d=(t.position.y+t.height/2)*n,h=null===(r=e.target)||void 0===r?void 0:r.getBoundingClientRect(),u=null===(s=document.querySelector("#layerControl"))||void 0===s?void 0:s.getBoundingClientRect(),f={x:h.left-Number(u.left)+h.width/2,y:h.top-Number(u.top)+h.height/2},x={x:l-(f.x-l),y:d-(f.y-d)},b=t.width/t.height,y=a.findIndex((function(e){return e.id===t.id}));new Me(e,(function(e){var r=e.curCoords,s=Object(U.cloneDeep)(a[y]),l={x:r.x-Number(u.left),y:r.y-Number(u.top)},d=s.height;switch(i){case Ne.TL:var h=p(l,x),j=g(l,h,-t.rotate),v=g(x,h,-t.rotate),O=v.x-j.x,m=v.y-j.y;O/m>b?j.x+=Math.abs(O-m*b):j.y+=Math.abs(m-O/b);var w=g(j,h,t.rotate);h=p(w,x),j=g(w,h,-t.rotate),O=(v=g(x,h,-t.rotate)).x-j.x,m=v.y-j.y,O/n>Ke&&m/n>Qe&&(s.width=O/n,s.height=m/n,s.position.y=j.y/n,s.position.x=j.x/n);break;case Ne.TR:var A=p(l,x),C=g(l,A,-t.rotate),k=g(x,A,-t.rotate),M=C.x-k.x,L=k.y-C.y;M/L>b?C.x-=Math.abs(M-L*b):C.y+=Math.abs(L-M/b);var E=g(C,A,t.rotate);A=p(E,x),C=g(E,A,-t.rotate),k=g(x,A,-t.rotate),M=C.x-k.x,L=k.y-C.y,M/n>Ke&&L/n>Qe&&(s.width=M/n,s.height=L/n,s.position.y=C.y/n,s.position.x=k.x/n);break;case Ne.BR:var S=p(l,x),B=g(l,S,-t.rotate),I=g(x,S,-t.rotate),T=B.x-I.x,z=B.y-I.y;T/z>b?B.x-=Math.abs(T-z*b):B.y-=Math.abs(z-T/b);var D=g(B,S,t.rotate);S=p(D,x),B=g(D,S,-t.rotate),I=g(x,S,-t.rotate),T=B.x-I.x,z=B.y-I.y,T/n>Ke&&z/n>Qe&&(s.width=T/n,s.height=z/n,s.position.y=I.y/n,s.position.x=I.x/n);break;case Ne.BL:var R=p(l,x),N=g(l,R,-t.rotate),F=g(x,R,-t.rotate),P=F.x-N.x,Y=N.y-F.y;P/Y>b?N.x+=Math.abs(P-Y*b):N.y-=Math.abs(Y-P/b);var K=g(N,R,t.rotate);R=p(K,x),N=g(K,R,-t.rotate),P=(F=g(x,R,-t.rotate)).x-N.x,Y=N.y-F.y,P/n>Ke&&Y/n>Qe&&(s.width=P/n,s.height=Y/n,s.position.y=F.y/n,s.position.x=N.x/n);break;case Ne.T:case Ne.B:var Q=g(l,f,-t.rotate),J=g({x:f.x,y:Q.y},f,t.rotate),V=Math.sqrt(Math.pow(J.x-x.x,2)+Math.pow(J.y-x.y,2)),X={x:J.x-(J.x-x.x)/2,y:J.y+(x.y-J.y)/2},Z=!1,H=(t.rotate+360)%360;i===Ne.T&&(H>=0&&H<=90||H>=270&&H<=360?J.y>=x.y&&(Z=!0):J.y<=x.y&&(Z=!0)),i===Ne.B&&(H>=90&&H<=270?J.y>=x.y&&(Z=!0):J.y<=x.y&&(Z=!0)),V/n>Qe&&!Z&&(s.height=V/n,s.position.y=(X.y-V/2)/n,s.position.x=X.x/n-s.width/2);break;case Ne.L:case Ne.R:var W=g(l,f,-t.rotate),G=g({x:W.x,y:f.y},f,t.rotate),q=Math.sqrt(Math.pow(G.x-x.x,2)+Math.pow(G.y-x.y,2)),_={x:G.x-(G.x-x.x)/2,y:G.y+(x.y-G.y)/2},$=!1,ee=(t.rotate+360)%360;i===Ne.L&&(ee>=0&&ee<=90||ee>=270&&ee<=360?G.x>=x.x&&($=!0):G.x<=x.x&&($=!0)),i===Ne.R&&(ee>=90&&ee<=270?G.x>=x.x&&($=!0):G.x<=x.x&&($=!0)),q/n>Ke&&!$&&(s.width=q/n,s.position.y=_.y/n-s.height/2,s.position.x=(_.x-q/2)/n)}"text"===s.type&&s.height!==d&&s.scale&&(s.scale*=s.height/d),o(s),c(!0)}),(function(){c(!1)}))}(e,i)},x=Object(i.useCallback)((function(){var e=t.rotate;e<0&&(e+=360);var n=[];Je.forEach((function(t){var i=(t+e)%360,a=Ve.find((function(e){return e.start<=i&&e.end>=i}));a&&n.push(a.cursor)})),u(n)}),[t.rotate]);return Object(i.useEffect)((function(){x()}),[x]),Object(m.jsx)(Ze,{style:{width:t.width*n,height:t.height*n,transform:"translate(".concat(t.position.x*n,"px, ").concat(t.position.y*n,"px) rotate(").concat(t.rotate,"deg)")},className:["border-control",r?"moving":""].join(" "),children:t.isLocked?Object(m.jsx)(at,{icon:Pe,rotate:t.rotate}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(_e,{style:{cursor:d[0]},onMouseDown:function(e){return f(e,Ne.BR)}}),t.width*n>30&&t.height*n>30&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(We,{style:{cursor:d[0]},onMouseDown:function(e){return f(e,Ne.TL)}}),Object(m.jsx)(Ge,{style:{cursor:d[2]},onMouseDown:function(e){return f(e,Ne.TR)}}),Object(m.jsx)(qe,{style:{cursor:d[2]},onMouseDown:function(e){return f(e,Ne.BL)}}),Object(m.jsx)(tt,{style:{cursor:d[3]},onMouseDown:function(e){return f(e,Ne.L)}}),Object(m.jsx)(nt,{style:{cursor:d[3]},onMouseDown:function(e){return f(e,Ne.R)}}),"text"!==t.type&&Object(m.jsx)($e,{style:{cursor:d[1]},onMouseDown:function(e){return f(e,Ne.T)}}),"text"!==t.type&&Object(m.jsx)(et,{style:{cursor:d[1]},onMouseDown:function(e){return f(e,Ne.B)}})]}),Object(m.jsx)(it,{className:"rotate-point",icon:Fe,onMouseDown:function(e){e.stopPropagation();var n=e.target.closest(".border-control");if(n){var i=n.getBoundingClientRect(),r={x:i.left+i.width/2,y:i.top+i.height/2};new Me(e,(function(e){var n=e.curCoords,i=n.y-r.y,s=n.x-r.x,l=180*Math.atan2(i,s)/Math.PI,d=a.findIndex((function(e){return e.id===t.id})),h=Object(U.cloneDeep)(a[d]);h.rotate=(l-90+360)%360,o(h),c(!0)}),(function(){c(!1)}))}}})]})})})),Ze=u.a.div(Le||(Le=Object(c.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n\n  &.moving .rotate-point {\n    opacity: 0;\n  }\n\n  &.moving span {\n    opacity: 0;\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    right: -1px;\n    bottom: -1px;\n    border: 2px solid #00c4cc;\n  }\n"]))),He=u.a.span(Ee||(Ee=Object(c.a)(["\n  position: absolute;\n  display: block;\n  background: transparent;\n  z-index: 1;\n  pointer-events: auto;\n  width: 18px;\n  height: 18px;\n  user-select: none;\n  transition: opacity 200ms;\n\n  ::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    border-radius: 6px;\n    background: #fff;\n    box-shadow: 0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(53 71 90 / 20%);\n  }\n"]))),We=Object(u.a)(He)(Se||(Se=Object(c.a)(["\n  top: -9px;\n  left: -9px;\n  cursor: nwse-resize;\n"]))),Ge=Object(u.a)(He)(Be||(Be=Object(c.a)(["\n  top: -9px;\n  right: -9px;\n  cursor: nesw-resize;\n"]))),qe=Object(u.a)(He)(Ie||(Ie=Object(c.a)(["\n  bottom: -9px;\n  left: -9px;\n  cursor: nesw-resize;\n"]))),_e=Object(u.a)(He)(Te||(Te=Object(c.a)(["\n  bottom: -9px;\n  right: -9px;\n  cursor: nwse-resize;\n"]))),$e=Object(u.a)(He)(ze||(ze=Object(c.a)(["\n  width: calc(100% - 24px);\n  height: 12px;\n  top: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n"]))),et=Object(u.a)(He)(De||(De=Object(c.a)(["\n  width: calc(100% - 24px);\n  height: 12px;\n  bottom: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n"]))),tt=Object(u.a)(He)(Re||(Re=Object(c.a)(["\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  left: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n"]))),nt=Object(u.a)(He)(Ue||(Ue=Object(c.a)(["\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  right: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n"]))),it=u.a.div({position:"absolute",left:"50%",bottom:"-50px",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",transform:"translate(-50%, -50%)",pointerEvents:"auto",borderRadius:"50%",boxShadow:"0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)",userSelect:"none",cursor:"grab"},(function(e){return{background:"#fff url(".concat(e.icon,") no-repeat center / 18px 18px")}})),at=u.a.div({position:"absolute",right:"0",bottom:"0",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto",borderRadius:"50%",boxShadow:"0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)",userSelect:"none",zIndex:"1"},(function(e){return{background:"#fff url(".concat(e.icon,") no-repeat center / 13px 13px"),transform:"translate(50%, 50%) rotate(".concat(-e.rotate,"deg)")}}));function ot(e){var t=e.info,n=Object(i.useContext)(Ae);return Object(m.jsx)(st,{style:{width:t.width*n,height:t.height*n,transform:"translate(".concat(t.position.x*n,"px, ").concat(t.position.y*n,"px) rotate(").concat(t.rotate,"deg)")}})}var rt,ct,st=u.a.div(Ye||(Ye=Object(c.a)(["\nposition: absolute;\ntop: 0;\nleft: 0;\npointer-events: none;\n\n&:after {\n  content: '';\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n}\n"]))),lt=Object(_.a)((function(e){var t,n,a=e.children,o=e.info,r=Object(i.useContext)(Ae),c=J.template,s=J.layers,l=J.setLayer,d=J.selectLayer,h=J.hoverLayer,u=J.isMoving,f=J.setIsMoving,x=Object(i.useContext)(Ce).setIsSelectedBackground,b=function(){var e={x:0,y:0,width:0,height:0,rotate:0},t={x:0,y:0,width:0,height:0},n="",i=[],a=1,o={width:0,height:0},r=4,c=document.querySelector("#verticalLine"),s=document.querySelector("#horizontalLine"),l=0,d=0,h=function(n,i){Math.abs(n-(t.x+t.width))<=r&&(i.x=n-e.width,i.x+=(e.width-t.width)/2,l=2),Math.abs(n-(t.x+t.width/2))<=r&&(i.x=n-e.width/2,l=1),Math.abs(n-t.x)<=r&&(i.x=n,i.x-=(e.width-t.width)/2,l=0)},u=function(n,i){Math.abs(n-(t.y+t.height))<=r&&(i.y=n-e.height,i.y-=(t.height-e.height)/2,d=2),Math.abs(n-(t.y+t.height/2))<=r&&(i.y=n-e.height/2,d=1),Math.abs(n-t.y)<=r&&(i.y=n,i.y+=(t.height-e.height)/2,d=0)},f=function(n){if(c&&s){if(n.x!==e.x){var i=0;0===l&&(i=n.x+(e.width-t.width)/2),1===l&&(i=n.x+e.width/2),2===l&&(i=n.x+(e.width-t.width)/2+t.width),c.style.transform="translateX(".concat(i*a,"px)"),c.style.visibility="visible"}else c.style.visibility="hidden";if(n.y!==e.y){var o=0;0===d&&(o=n.y-(t.height-e.height)/2),1===d&&(o=n.y+e.height/2),2===d&&(o=n.y-(t.height-e.height)/2+t.height),s.style.transform="translateY(".concat(o*a,"px)"),s.style.visibility="visible"}else s.style.visibility="hidden"}};return{getRect:function(){return e},init:function(c,s,l,d,h){n=s,i=l,r=4/(a=d),o=h;var u=(e=c).rotate*Math.PI/180,f=Math.abs(e.width*Math.cos(u))+Math.abs(e.height*Math.sin(u)),x=Math.abs(e.height*Math.cos(u))+Math.abs(e.width*Math.sin(u));t.width=f,t.height=x,t.x=e.x+(e.width-f)/2,t.y=e.y-(x-e.height)/2},move:function(a){var r=a.x,c=a.y;e.x=r,e.y=c;var s={x:e.x,y:e.y};return t.x=e.x+(e.width-t.width)/2,t.y=e.y-(t.height-e.height)/2,i.forEach((function(e){var t=e.rotate*Math.PI/180,i=Math.abs(e.width*Math.cos(t))+Math.abs(e.height*Math.sin(t)),a=Math.abs(e.height*Math.cos(t))+Math.abs(e.width*Math.sin(t)),o=e.position.x+(e.width-i)/2,r=e.position.y-(a-e.height)/2;e.id!==n&&(h(o+i,s),h(o+i/2,s),h(o,s),u(r+a,s),u(r+a/2,s),u(r,s))})),h(o.width,s),h(o.width/2,s),h(0,s),u(o.height,s),u(o.height/2,s),u(0,s),f(s),s}}}(),p=b.getRect,g=b.init,y=b.move,j=function(e){var t=e.diff,n=Object(U.cloneDeep)(o),i=y({x:p().x+t.x/r,y:p().y+t.y/r});n.position=i,l(n),f(!0)},v=function(){document.querySelector("#verticalLine").style.visibility="hidden",document.querySelector("#horizontalLine").style.visibility="hidden",f(!1)};return Object(m.jsxs)(jt,{style:{width:o.width,height:o.height,transform:"translate(".concat(o.position.x,"px, ").concat(o.position.y,"px) rotate(").concat(o.rotate,"deg)"),opacity:o.opacity,zIndex:o.zIndex},onMouseDown:function(e){e.stopPropagation(),o.isEditing||(d(o.id),x(!1),o.isLocked||(new Me(e,j,v),g(Object(k.a)(Object(k.a)({},o.position),{},{width:o.width,height:o.height,rotate:o.rotate}),o.id,s,r,Object(k.a)({},c.global))))},onMouseEnter:function(e){e.stopPropagation(),h(o.id)},onMouseOut:function(e){e.stopPropagation(),h()},className:[u?"moving":"",o.isEditing?"edit":""].join(" "),children:[Object(m.jsx)(vt,{style:{transform:"scale(".concat((null===(t=o.reverse)||void 0===t?void 0:t.x)||1,", ").concat((null===(n=o.reverse)||void 0===n?void 0:n.y)||1,")")},children:a}),o.isSelected&&Object(m.jsx)(dt,{children:Object(m.jsx)(Xe,{info:o})}),!o.isSelected&&!u&&o.isHover&&Object(m.jsx)(dt,{children:Object(m.jsx)(ot,{info:o})})]})}));function dt(e){var t=e.children;return Object(o.createPortal)(t,document.querySelector("#layerControl"))}var ht,ut,ft,xt,bt,pt,gt,yt,jt=u.a.div(rt||(rt=Object(c.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n  user-select: none;\n  cursor: default;\n\n  &.moving {\n    cursor: all-scroll;\n  }\n\n  &.edit {\n    cursor: text;\n  }\n"]))),vt=u.a.div(ct||(ct=Object(c.a)(["\n  width: 100%;\n  height: 100%;\n  transition: transform 250ms;\n"]))),Ot=(n(260),n(261),n(171)),mt=n.n(Ot),wt=Object(_.a)((function(e){var t,n=e.layer,a=Object(i.useRef)(null),o=J.editTextLayer,r=J.setLayer,c=J.needUpdateLayerHeight,s=J.setNeedUpdateLayerHeight,l=J.isMoving,d=Object(i.useContext)(Ae),u=Object(i.useState)(null),f=Object(h.a)(u,2),x=f[0],b=f[1],p=null===(t=document.querySelector("#textControl"))||void 0===t?void 0:t.getBoundingClientRect(),g=Object(i.useCallback)((function(){if(x){var e=Object(U.cloneDeep)(n),t=x.getText();if(e.source.content=t,a.current){var i=a.current.getBoundingClientRect(),o=n.rotate%180*Math.PI/180,c=Math.abs((i.height-n.width*d*Math.sin(o))/Math.cos(o));if(c/d!==n.height){e.height=c/d;var s={x:i.left+i.width/2-p.left,y:i.top+i.height/2-p.top},l=s.x/d-n.width/2,h=(s.y-c/2)/d;e.position={x:l,y:h}}}r(e)}}),[x,n,r,d,p]);Object(i.useEffect)((function(){if(c&&a.current){var e=Object(U.cloneDeep)(n),t=a.current.getBoundingClientRect(),i=n.rotate%180*Math.PI/180,o=Math.abs((t.height-n.width*d*Math.sin(i))/Math.cos(i));if(o/d!==n.height){e.height=o/d;var l={x:t.left+t.width/2-p.left,y:t.top+t.height/2-p.top},h=l.x/d-n.width/2,u=(l.y-o/2)/d;e.position={x:h,y:u},r(e)}s(!1)}}),[p,n,c,d,r,s]),Object(i.useEffect)((function(){if(l&&a.current){var e=a.current.getBoundingClientRect(),t=n.rotate%180*Math.PI/180,i=Math.abs((e.height-n.width*d*Math.sin(t))/Math.cos(t));if(Math.abs(i/d-n.height)>1){var o=Object(U.cloneDeep)(n);o.height=i/d,r(o)}}}),[n,d,l,p,r]);return Object(i.useEffect)((function(){if(a.current&&!x){var e=new mt.a(a.current);b(e)}}),[x]),Object(i.useEffect)((function(){x&&n.source.content&&x.getText()!==n.source.content&&x.setText(n.source.content)}),[x,n.source.content]),Object(i.useEffect)((function(){x&&(x.enable(n.isEditing),n.isEditing&&x.setSelection(0,1e3))}),[x,n.isEditing]),Object(i.useEffect)((function(){return x&&x.on("text-change",g),function(){null===x||void 0===x||x.off("text-change",g)}}),[x,g]),Object(m.jsx)(At,{style:{transform:"scale(".concat(n.scale,")"),width:"".concat(n.width/(n.scale||1),"px"),height:"".concat(n.height/(n.scale||1),"px")},children:Object(m.jsx)(Ct,{data:n.style,onDoubleClick:function(){o(n.id)},children:Object(m.jsx)(kt,{ref:a,spellCheck:"false"})})})})),At=u.a.div(ht||(ht=Object(c.a)(["\n  transform-origin: 0 0;\n"]))),Ct=u.a.div({},(function(e){return{fontFamily:'"'.concat(e.data.font,'"'),fontSize:e.data.fontSize,color:e.data.color,lineHeight:e.data.lineHeight,textAlign:e.data.textAlign,fontWeight:e.data.fontWeight,textDecorationLine:e.data.underline?"underline":"none"}})),kt=u.a.div(ut||(ut=Object(c.a)(["\n  font-family: inherit;\n  font-size: inherit;\n\n  .ql-editor {\n    padding: 0;\n    overflow: visible;\n    font-family: inherit;\n    line-height: inherit;\n    text-align: inherit;\n    white-space: break-spaces;\n    /* user-select: text; */\n    line-break: anywhere;\n\n    &>* {\n      cursor: inherit;\n    }\n  }\n"]))),Mt={x:0,y:0},Lt=Object(_.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,a=J.resetSelectStatus,o=J.setLayerType,r=e.global,c=e.background,s=Object(i.useContext)(Ae),l=Object(i.useContext)(Ce),d=l.isSelectedBackground,h=l.setIsSelectedBackground;return Object(m.jsxs)(Ft,{width:r.width,height:r.height,scale:s,children:[Object(m.jsxs)(Pt,{id:"canvasContent",style:{width:r.width,height:r.height,transform:"scale(".concat(s,")")},onDrop:function(e){e.preventDefault();var i=function(e,i,o){var r,c=null===(r=document.querySelector("#layerControl"))||void 0===r?void 0:r.getBoundingClientRect(),l=Mt.x-c.left,d=Mt.y-c.top,h={id:String(Date.now()),type:"image",width:e,height:i,position:{x:l/s-e/2,y:d/s-i/2},rotate:0,reverse:{x:1,y:1},source:{imageUrl:o},opacity:1,zIndex:t.length?t[t.length-1].zIndex+1:1,isSelected:!0,isEditing:!1,isLocked:!1,scale:1};a(),n(h)};if(e.dataTransfer.files.length>0){var o=e.dataTransfer.files;if(!/image\//.test(o[0].type))return;var r=new FileReader;r.readAsDataURL(o[0]),r.onload=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;if("string"===typeof n){var a=new Image;a.src=n,a.onload=function(){i(a.width,a.height,n)}}}}else{var c=null;try{var l;c=JSON.parse(null===(l=e.dataTransfer)||void 0===l?void 0:l.getData("image"))}catch(e){}c&&i(c.webformatWidth,c.webformatHeight,c.webformatURL)}},onDragOver:function(e){e.preventDefault(),Mt.x=e.pageX,Mt.y=e.pageY},children:[Object(m.jsx)(Nt,{color:c.color,onClick:function(e){e.stopPropagation(),h(!0),a(),o(E.BACKGROUND)}}),e.layers.map((function(e){return"image"===e.type?Object(m.jsx)(lt,{info:e,children:Object(m.jsx)(Ut,{src:Object(D.q)(e.source.imageUrl),draggable:"false"})},e.id):"text"===e.type?e.isEditing?Object(m.jsx)(Et,{children:Object(m.jsx)(lt,{info:e,children:Object(m.jsx)(wt,{layer:Object(D.q)(e)})})},e.id):Object(m.jsx)(lt,{info:e,children:Object(m.jsx)(wt,{layer:Object(D.q)(e)})},e.id):Object(m.jsx)(m.Fragment,{})}))]}),Object(m.jsxs)(Kt,{id:"layerControl",width:r.width,height:r.height,scale:s,children:[d&&Object(m.jsx)(Qt,{}),Object(m.jsx)(Jt,{id:"verticalLine"}),Object(m.jsx)(Vt,{id:"horizontalLine"})]}),Object(m.jsx)(Yt,{id:"textControl",style:{width:r.width,height:r.height,transform:"scale(".concat(s,")")}})]})}));function Et(e){var t=e.children;return Object(o.createPortal)(t,document.querySelector("#textControl"))}var St,Bt,It,Tt,zt,Dt,Rt,Ut=u.a.img(ft||(ft=Object(c.a)(["\n  width: 100%;\n  height: 100%;\n"]))),Nt=u.a.div({position:"relative",zIndex:-1,width:"100%",height:"100%"},(function(e){return{backgroundColor:e.color}})),Ft=u.a.div({flex:"none",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"auto",pointerEvents:"none"},(function(e){return{width:e.width*e.scale+100,height:e.height*e.scale+100}})),Pt=u.a.div(xt||(xt=Object(c.a)(["\n  flex: none;\n  position: relative;\n  overflow: hidden;\n  background-color: #fff;\n  user-select: none;\n  pointer-events: auto;\n"]))),Yt=Object(u.a)(Pt)(bt||(bt=Object(c.a)(["\n  position: absolute;\n  top: 50;\n  left: 50;\n  z-index: 1;\n  pointer-events: none;\n  overflow: visible;\n  background-color: transparent;\n"]))),Kt=u.a.div({position:"absolute",top:50,left:50,zIndex:2,pointerEvents:"none"},(function(e){return{width:e.width*e.scale,height:e.height*e.scale}})),Qt=u.a.div(pt||(pt=Object(c.a)(["\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n  background: transparent;\n  pointer-events: none;\n"]))),Jt=u.a.div(gt||(gt=Object(c.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 0;\n  height: 100%;\n  border-left: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n"]))),Vt=u.a.div(yt||(yt=Object(c.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 0;\n  border-top: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n"]))),Xt=n(333),Zt=n(338),Ht=n(339),Wt=n(334),Gt=n(341),qt=n(335),_t=n(340),$t=n(343),en=n(344),tn=n(345),nn=n(346),an=n(347),on=n(348),rn=n(349),cn=n(350),sn=n(351),ln=n.p+"static/media/opacity.6dad8d31.svg",dn=n(178),hn=[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft Yahei"},{name:"\u6977\u4f53",value:"KaiTi"},{name:"\u534e\u6587\u6977\u4f53",value:"STKaiti"},{name:"\u7fe9\u7fe9\u4f53-\u7b80",value:"Hanzipen SC"},{name:"\u5a03\u5a03\u4f53-\u7b80",value:"Wawati SC"},{name:"\u5706\u4f53-\u7b80",value:"Yuanti SC"},{name:"\u5170\u4ead\u9ed1-\u7b80",value:"Lantinghei SC"}],un=[6,8,10,12,14,16,18,20,22,24,28,32,36,42,48,56,64,72,80,88,96,104,120,144],fn=[{width:1280,height:720,label:"1280px \xd7 720px",value:"1"},{width:720,height:1280,label:"720px \xd7 1280px",value:"2"},{width:1024,height:768,label:"1024px \xd7 768px",value:"3"},{width:768,height:1024,label:"768px \xd7 1024px",value:"4"},{width:1920,height:1080,label:"1920px \xd7 1080px",value:"5"}],xn=Xt.a.Option,bn=Object(_.a)((function(){var e,t,n,a,o,r,c=J.template,s=J.layerType,l=J.layers,d=J.setCanvasSize,u=J.setLayer,f=J.setLayers,x=J.setLayerLevel,b=J.removeLayer,p=J.setLayerLock,g=J.setBackgroundColor,y=J.setNeedUpdateLayerHeight,j=Object(i.useState)("1"),v=Object(h.a)(j,2),O=v[0],w=v[1],A=l.find((function(e){return e.isSelected})),C=(null===A||void 0===A?void 0:A.scale)||1,k="";s===E.TEXT?k=(null===A||void 0===A||null===(r=A.style)||void 0===r?void 0:r.color)||"":s===E.BACKGROUND&&(k=c.background.color);var M=(null===A||void 0===A||null===(e=A.style)||void 0===e?void 0:e.font)||"",L=(null===A||void 0===A||null===(t=A.style)||void 0===t?void 0:t.fontSize)||0,S=(null===A||void 0===A||null===(n=A.style)||void 0===n?void 0:n.textAlign)||"left",B=(null===A||void 0===A||null===(a=A.style)||void 0===a?void 0:a.fontWeight)||400,I=(null===A||void 0===A||null===(o=A.style)||void 0===o?void 0:o.underline)||!1,T=null===A||void 0===A?void 0:A.opacity,D=(null===A||void 0===A?void 0:A.isLocked)||!1,R={min:1,max:100,current:1};A&&(R.current=l.findIndex((function(e){return e.id===A.id}))+1,R.max=l.length);var N=c.global.width,F=c.global.height;Object(i.useEffect)((function(){var e=fn.find((function(e){return e.width===N&&e.height===F&&e.value!==O}));e?w(e.value):"6"!==O&&w("6")}),[]);var P=function(e){var t=Object(U.cloneDeep)(A);(null===t||void 0===t?void 0:t.reverse)&&("x"===e&&(t.reverse.x=1===t.reverse.x?-1:1),"y"===e&&(t.reverse.y=1===t.reverse.y?-1:1),u(t))},Y=Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(Zt.a.Group,{onChange:function(e){w(e.target.value);var t=fn.find((function(t){return t.value===e.target.value}));t&&d({width:t.width,height:t.height})},value:O,children:Object(m.jsxs)(Ht.b,{direction:"vertical",children:[fn.map((function(e){return Object(m.jsx)(Zt.a,{value:e.value,children:e.label},e.value)})),Object(m.jsxs)(Zt.a,{value:"6",children:["\u81ea\u5b9a\u4e49","6"===O?Object(m.jsxs)("div",{style:{marginTop:10},children:[Object(m.jsx)(Wt.a,{value:N,size:"small",placeholder:"\u5bbd",style:{width:100,marginRight:10},onChange:function(e){Object(U.isNumber)(e)&&e>0&&d({width:e,height:F})}}),"\xd7",Object(m.jsx)(Wt.a,{value:F,size:"small",placeholder:"\u9ad8",style:{width:100,marginLeft:10,marginRight:10},onChange:function(e){Object(U.isNumber)(e)&&e>0&&d({width:N,height:e})}})," \u50cf\u7d20"]}):null]})]})})});return Object(m.jsxs)(pn,{children:[Object(m.jsxs)(gn,{className:D?"locked":"",children:[[E.EMPTY].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(z.a,{content:Y,trigger:"click",placement:"bottomLeft",children:Object(m.jsx)("span",{className:"text",children:"\u753b\u5e03\u5c3a\u5bf8"})})}),[E.BACKGROUND,E.TEXT].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(z.a,{content:Object(m.jsx)(dn.a,{color:k,onChange:function(e){var t="rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")");if(s===E.TEXT){var n=Object(U.cloneDeep)(A);"text"===(null===n||void 0===n?void 0:n.type)&&n.style&&(n.style.color=t,u(n))}s===E.BACKGROUND&&g(t)}}),trigger:"click",placement:"bottomLeft",children:Object(m.jsx)(jn,{style:{backgroundColor:k}})})}),[E.TEXT].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(Xt.a,{value:M,style:{width:140},placeholder:"\u9009\u62e9\u5b57\u4f53",onChange:function(e){var t=Object(U.cloneDeep)(A);"text"===(null===t||void 0===t?void 0:t.type)&&t.style&&(t.style.font=e,u(t))},children:hn.map((function(e){return Object(m.jsx)(xn,{value:e.value,children:Object(m.jsx)("span",{style:{fontFamily:e.value},children:e.name})},e.value)}))})}),[E.TEXT].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(Xt.a,{value:(L*C).toFixed(0),style:{width:100,textAlign:"center"},placeholder:"\u5b57\u4f53\u5927\u5c0f",onChange:function(e){var t=Number(e);if(!isNaN(t)){var n=Object(U.cloneDeep)(A);"text"===(null===n||void 0===n?void 0:n.type)&&n.style&&(n.style.fontSize=t/C,u(n),y(!0))}},children:un.map((function(e){return Object(m.jsx)(xn,{value:e,children:e},e)}))})}),[E.TEXT].includes(s)&&Object(m.jsx)(yn,{className:700===B?"active":"",onClick:function(){var e=Object(U.cloneDeep)(A);"text"===(null===e||void 0===e?void 0:e.type)&&e.style&&(e.style.fontWeight=700===e.style.fontWeight?400:700,u(e))},children:Object(m.jsx)($t.a,{style:{fontSize:24}})}),[E.TEXT].includes(s)&&Object(m.jsx)(yn,{className:I?"active":"",onClick:function(){var e=Object(U.cloneDeep)(A);"text"===(null===e||void 0===e?void 0:e.type)&&e.style&&(e.style.underline=!e.style.underline,u(e))},children:Object(m.jsx)(en.a,{style:{fontSize:24}})}),[E.TEXT].includes(s)&&Object(m.jsxs)(yn,{onClick:function(){var e="left";"left"===S&&(e="center"),"center"===S&&(e="right"),"right"===S&&(e="left");var t=Object(U.cloneDeep)(A);"text"===(null===t||void 0===t?void 0:t.type)&&t.style&&(t.style.textAlign=e,u(t))},children:["left"===S&&Object(m.jsx)(tn.a,{style:{fontSize:24}}),"center"===S&&Object(m.jsx)(nn.a,{style:{fontSize:24}}),"right"===S&&Object(m.jsx)(an.a,{style:{fontSize:24}})]}),[E.IMAGE].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(Gt.a,{overlay:Object(m.jsxs)(qt.a,{style:{width:120},children:[Object(m.jsx)(qt.a.Item,{style:{padding:"10px"},icon:Object(m.jsx)(on.a,{}),onClick:function(){return P("x")},children:"\u6c34\u5e73\u7ffb\u8f6c"},"x"),Object(m.jsx)(qt.a.Item,{style:{padding:"10px"},icon:Object(m.jsx)(on.a,{style:{transform:"rotate(90deg)"}}),onClick:function(){return P("y")},children:"\u5782\u76f4\u7ffb\u8f6c"},"y")]}),trigger:["click"],children:Object(m.jsx)("span",{className:"text",children:"\u7ffb\u8f6c"})})})]}),Object(m.jsxs)(gn,{className:D?"locked":"",children:[[E.IMAGE,E.TEXT].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(z.a,{content:Object(m.jsx)(be.a,{value:R.current,min:R.min,max:R.max,style:{width:180},onChange:function(e){e>R.current?(l.forEach((function(t,n){n+1>R.current&&n+1<=e&&x(t.id,t.zIndex-1)})),A&&x(A.id,A.zIndex+(e-R.current))):(l.forEach((function(t,n){n+1>=e&&n+1<R.current&&x(t.id,t.zIndex+1)})),A&&x(A.id,A.zIndex-(R.current-e))),f(Object(U.cloneDeep)(l).sort((function(e,t){return e.zIndex-t.zIndex})))}}),trigger:"click",placement:"bottomRight",children:Object(m.jsx)("span",{className:"text",children:"\u5c42\u7ea7\u8c03\u6574"})})}),[E.IMAGE,E.TEXT].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(z.a,{content:Object(m.jsx)(be.a,{value:T,min:0,max:1,step:.01,style:{width:180},onChange:function(e){var t=Object(U.cloneDeep)(A);t&&(t.opacity=e,u(t))}}),trigger:"click",placement:"bottomRight",children:Object(m.jsx)("img",{src:ln,width:"24",height:"24",alt:""})})}),[E.TEXT,E.IMAGE].includes(s)&&Object(m.jsx)(yn,{className:["item-lock",D?"active":""].join(" "),onClick:function(){A&&p(A.id,!A.isLocked)},children:D?Object(m.jsx)(rn.a,{style:{fontSize:24}}):Object(m.jsx)(cn.a,{style:{fontSize:24}})}),[E.IMAGE,E.TEXT].includes(s)&&Object(m.jsx)(yn,{onClick:function(){var e=l.find((function(e){return e.isSelected}));e&&b(e.id)},children:Object(m.jsx)(sn.a,{style:{fontSize:24}})}),[E.EMPTY].includes(s)&&Object(m.jsx)(yn,{children:Object(m.jsx)(_t.a,{placement:"bottomRight",title:"\u786e\u5b9a\u6e05\u7a7a\u753b\u5e03\uff1f",onConfirm:function(){f([])},okText:"\u6e05\u7a7a",cancelText:"\u53d6\u6d88",children:Object(m.jsx)("span",{className:"text",children:"\u6e05\u7a7a\u753b\u5e03"})})})]})]})})),pn=u.a.div(St||(St=Object(c.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  height: 46px;\n  padding: 0 10px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n  user-select: none;\n"]))),gn=u.a.div(Bt||(Bt=Object(c.a)(["\n  display: flex;\n  align-items: center;\n\n  &.locked>div:not(.item-lock) {\n    display: none;\n  }\n"]))),yn=u.a.div(It||(It=Object(c.a)(['\n  display: flex;\n  align-items: center;\n  margin-right: 10px;\n  padding: 4px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &.active {\n    background-color: rgba(57,76,96,.15);\n  }\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  .text {\n    padding: 0 10px;\n    font-size: 16px;\n  }\n\n  input[type="search"] {\n    text-align: center;\n  }\n']))),jn=u.a.div(Tt||(Tt=Object(c.a)(["\n  width: 28px;\n  height: 28px;\n  border: 2px solid #666;\n  border-radius: 4px;\n"]))),vn=Y(),On=vn.undo,mn=vn.redo,wn={},An=Object(_.a)((function(){var e=Object(i.useState)(1),t=Object(h.a)(e,2),n=t[0],a=t[1],o=Object(i.useRef)(null),r=J.template,c=J.resetSelectStatus,s=J.removeLayer,l=J.addLayer,d=Object(i.useState)(!1),u=Object(h.a)(d,2),f=u[0],x=u[1];Object(i.useEffect)((function(){var e=o.current,t=r.global.width,n=r.global.height,i=1;e&&e.clientWidth<t+100&&(i=(e.clientWidth-100)/t),e&&e.clientHeight<n*i+100&&(i=(e.clientHeight-100)/n),a(i)}),[r.global.width,r.global.height]);var b=Object(i.useCallback)((function(e){if(document.activeElement===document.body||null===document.activeElement){if("Backspace"===e.key||"Delete"===e.key){var t=r.layers.find((function(e){return e.isSelected}));t&&s(t.id)}if("c"===e.key&&(e.metaKey||e.ctrlKey)){var n=r.layers.find((function(e){return e.isSelected}));n&&!r.layers.some((function(e){return e.isEditing}))&&(wn=Object(U.cloneDeep)(n))}"v"===e.key&&(e.metaKey||e.ctrlKey)&&(r.layers.some((function(e){return e.isEditing}))||wn&&(wn.position&&(wn.position.x+=10),wn.position&&(wn.position.y+=10),wn.id=String(Date.now()),wn.zIndex=r.layers.length?r.layers[r.layers.length-1].zIndex+1:1,c(),l(wn))),"z"!==e.key||!e.metaKey&&!e.ctrlKey||e.shiftKey||On(),"z"===e.key&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&mn()}}),[l,s,c,r.layers]);Object(i.useEffect)((function(){return document.addEventListener("keydown",b),function(){document.removeEventListener("keydown",b)}}),[b]);return Object(m.jsxs)(Cn,{children:[Object(m.jsx)(bn,{}),Object(m.jsx)(kn,{ref:o,id:"CanvasWrapper",onMouseDown:function(e){"CanvasWrapper"===e.target.id&&(c(),x(!1))},children:Object(m.jsx)(Ce.Provider,{value:{isSelectedBackground:f,setIsSelectedBackground:x},children:Object(m.jsx)(Ae.Provider,{value:n,children:Object(m.jsx)(Lt,{})})})}),Object(m.jsx)(je,{scale:n,setScale:function(e){return a(e)}})]})})),Cn=u.a.div(zt||(zt=Object(c.a)(["\n  position: relative;\n  flex: 1;\n  overflow: hidden;\n"]))),kn=u.a.div(Dt||(Dt=Object(c.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  height: calc(100% - 88px);\n  overflow: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #eef2f8;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n"])));function Mn(){return Object(m.jsxs)(Ln,{children:[Object(m.jsx)(se,{}),Object(m.jsx)(An,{})]})}var Ln=u.a.main(Rt||(Rt=Object(c.a)(["\n  display: flex;\n  height: calc(100vh - 56px);\n  background-color: #eef2f8;\n  overflow: hidden;\n"])));n(325);var En=function(){return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(w,{}),Object(m.jsx)(Mn,{})]})},Sn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,352)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),i(e),a(e),o(e),r(e)}))};n(326);r.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(En,{})}),document.getElementById("root")),Sn()}},[[327,1,2]]]);
//# sourceMappingURL=main.2f860cb2.chunk.js.map