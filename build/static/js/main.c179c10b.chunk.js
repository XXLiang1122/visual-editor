(this["webpackJsonpvisual-editor"]=this["webpackJsonpvisual-editor"]||[]).push([[0],{191:function(e,t,n){},327:function(e,t,n){},329:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r=n(30),c=n.n(r),a=(n(191),n(10)),l=n(72),s=n.n(l),d=n(93),h=n(35),u=n(9),p=n(48),b=n(167),f=n.n(b),g=function(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}},x=function(e,t,n){return n/=180/Math.PI,{x:(e.x-t.x)*Math.cos(n)-(e.y-t.y)*Math.sin(n)+t.x,y:(e.x-t.x)*Math.sin(n)+(e.y-t.y)*Math.cos(n)+t.y}};function j(e){return v.apply(this,arguments)}function v(){return(v=Object(d.a)(s.a.mark((function e(t){var n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.querySelector(t),(i=n.cloneNode(!0)).style.transform="",i.style.position="fixed",i.style.left="-9999px",document.body.appendChild(i),i.querySelectorAll("img").forEach((function(e){e.setAttribute("crossOrigin","anonymous")})),o={width:i.offsetWidth,height:i.offsetHeight,backgroundColor:null,useCORS:!0},e.abrupt("return",new Promise((function(e,t){f()(i,o).then((function(t){var n=t.toDataURL("image/png");e(n)})).catch((function(e){t(e)})).finally((function(){document.body.removeChild(i)}))})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y,O,m=n(1);function w(){var e=Object(i.useState)(!1),t=Object(h.a)(e,2),n=t[0],o=t[1],r=function(){var e=Object(d.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,j("#canvasContent");case 4:t=e.sent,(n=document.createElement("a")).href=t,n.setAttribute("download","".concat(Date.now(),".png")),n.click(),n.remove(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:o(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(m.jsxs)(A,{children:[Object(m.jsx)("a",{href:"https://github.com/XXLiang1122/visual-editor",children:Object(m.jsx)(C,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH5QwYBS0oyVSCHgAAFVRJREFUaN7lmndwHNd9x7/vbbnecDgcDodyqAQoFrCJAkmJKpQlUZQs07KKzQwjO4rVxmPJTmxHGYXjOE7iOI6L4iiiE9mmZVndtFhEiqRMiyQoEiRAdBL1ABzKAbhe9m5338sfoOiWSJAJxcnozdzczN7e7vezv32/936F4EMyRvZxUBFm8Y8t5H9rMACMA/SPLeR/bXCAM+BDY2EKgJMPkYU5mXutPzzAfO77QwM8R/0BzuH7cT86A2OQUiboxhw0rl36jYJAgIi0EygaJjiQfu0DZyUU4PQDsnCT72a8vaIfmqLhls9uwPGxY9aZydnqXDa3IhlPLzkfGvAeC+2hLl3CrDGLdaWbYYLpgyVmAOEAWXBY/2ak4xn464oxNRz21y6pumvR8ppby6v91a5Cp5VpXA+PT4e7WntPtp7s/Gnz6P63VhRcp8tmA+zTFG/k9n0gvCP7OBiFeUGB1/s2I6/qWLKxAt3NwU1XrF70tZXrlq7ylLgpFQkkSeZOl4N4vUXUYDDgbPO5yM9/su/pw2+89Y/Fhd6YZJJQNerEz/D8ggMP7+fgdAF3Wo1YitRECv5VJeg5GbylvrHmqZrFgbLB3qDefOQMy2XzRJQEuAodzB/wsdrFVVjVtLygorrsSyazyf3S7j2PVRSUpkbKkigcLcQMZhYUmHAAHBAW6oJ1lWsh2kUkIqnqphvW7LQ7bXXdZ/t0LacjGU0hNDwpRKfjdCIYpsMXRklkOkbS6YxeXR+g9Utrl4+dH4/e8/mPNZ85cg6FzlLISYYoogsG/OindgAE0oIBl5pqcXxsL/a/cuiLhJI7mcbZ2qtXkUQsSUaGQpTpjBBKQCiBrupkMhQm8dkEISLRicBpOp1deuC5I9HmseZOOW1iJSUBjCT7Fgz485/cAU4gL8gcdmMLav06dFXzmh2mA7UNVctv2HwNP7LvONpbughAQH7jTjUNVbyg0IEzze2kvKZE//h9t3JZNggUNL3/5cOfe/Jn//DMhuLN8E2ZkIaASdghwIYWfPsP1njRaVkWaA5nwCGBirRaySiVtQ1VGO4fRefZHkLIbz9TQaBYs2E5ygJ+DF0Y4bIsE7vTjvoltSir8FtnJmYf8JD63TX+ykgokMGK9UvB2ofhKGDItV2PjviRy1K6IOvwTagDBwPAPZRSkyCKvLejH7qu/965us7Q3tKNM83neCyaAACuZHM8m1b47FQEus58pS6fMxSaKGV5dt/YhYm/VHNaXXw2hY74m5etdUEsLCKDuSWdMMYYD49P86nxacIZh850gACEkEufjjM9ZDYc5XaHFcH+UfS29mEyGOaVNeUY7h9JFZd5P3X3n9/xCdkgNVhsZnGgO1j3T8/s+OyGki36sfE9f3zgH+PHuAo3AwQhTddTXW29Lp1prGpxBarqKlB7RSWUTA6v/ngfTcRShBACXdMJYwzhyBTpONvFS8v9/MSRU8xiNZfdvu2mx+/99FZDa0uH7vMVYaQv5MbcjlS/XK2XDeyBBwF/I3TGkMvm0nVLqhI1V1QWbLhxLdZfv5ba7DYIAiW6zviFrkF+/OApIogiJifCSOVjgMDgKSqEmtdI/bJafObRbdbOtm6mKDm+7po1tPVkB+9p7zv5va/vVJ/79kuXbZzLBp7GNCp1gtbJdtMD9/7plx55/M8q0pkMt9mt1OlyXPJYyViSJ6JJXYeOvJblGTVFc5pC6ivqmd1hh65rfPsj95DCogKUlvtJf+8gLyv30188d+BsX+fA8+OjkwgXR4Dw5em9bKcVQBUMZhkrS5Yt/8hHr/1Y3RXVpMDtxPjoJAeAfE7loeEJtuv7L+gtZ1pILD9N4rmIkNMUUuB0syVLl/DZ6QhWNC0jxf4iCgCVNeVkYnSKfuPxJ3tPHDn1hYaVi4anQzO4oX3N5cq9fAsHsRpXOAg0i6nMV1ZsA4CyCj+50DXA9r14SFcyCvnlwWP86C/fovFMTODgIJxwX1EJW71yJY/NxrFs9WLykTuuowAQi8T5yV+26McOvv2rk2+2fLm+sfb0yUNn4Cvx4gfj3/+DdTI+lwS4bGALYsikzdBUbTY6E1MAWKhA4Sly41/+5ikeHBrB2NQYYdCJUTYxp8OBirIK7nIWIB5Jkg0fuQp3f+ZjNK/k8fbRM3p323kycH449qsDJx+3OS2nTx5qhddfhOOhy4uiGAM4FmAvnYcRXtmMkdFQzCjLa/wBX01BoRNWu5X4yopQv6QOVqMVdouDB8oDrLa2Fm53AfEUu/kd2zaT2++5mZqtJrL3pUNs34uH8NF7byar1i03dp7paS6r8bd5eox4PfnKpfttKL4VpYYaBNwNKLfXoa6wETlFQVJ79333o9t2gNAF2EtvxGKkXYC3yKP0dw2dDQ6Meacmpn2ZdNboLnTRtdesIo1rl8DldnBHoZ1bHWbm9hYgnc4in8+jyFdIXW4nScSTCE9Mw1tShCKfR+g40zP71EvffM1RUobRi3vqJXQZ6ptU6BQ40lcsjyTcsLAwL3IWIJJ4DCr2/o86H9u2A1gI4CCCWCQvRuXGAFLT6Zmjzc17x7rH3+xqPX/2xJFT07JJahgfmaSpdAaLltbSa25sEmobKimlAlHzKjpaejA5HubZTBbFJUV469BJzgmnbW93ZDKD5GWL3ZwbTfYDAGoCa5GKClAyYt29t858e0lZeN3QkPS2LHPl31LfxU/ezcKf2gFOIC3I1vLozF5M7ZtANqegtrgqIxvF48Vlnu+ree3EYG9Q1BkjV25YSQs9LjoVz+KJZ97Ujh1vZ2dPnONllSWw262Izyb4sTfeZulkBouXL4IoisWCRB2MMwDAeuNDyMZ1HB18jCxdpnz2wftn7910XeLBoqL8Boczi13YNi+t83Jaqws3QjabwBlACAdnFByANyRiN+YScK9HX4Yn6kEZPg0BLbBfY0NsNmksrywlOUVhHq9bOPlWC9MNZpaJZwnhnAhUIM1HWri/ooQvXrGIrFy/nO785i7++kuHGaVUtjlsRgaOh/AQWgr7YJUYGum3l228Jv3xQFkOo0FiLPaqVz30YN+ex79gwnxyBvOysNFagJzCkE7qRYrCG8dDmjGZ0DFVquFhPHTpvGlMQ8QR0Hoz2s90Y2ZyZnKgZ1gNDU9BzanwFnuQGB0nd68oEfxFLsoYR0VNGbnv8/cKN2y5WmxYVies33QlBQPx+b35TCarEBC0+geRTUl4a8htuPba9Oc2rs9UgAMmE0eBS1uycfuNMjfMb3bOC1hXcwiG87bbtrq+++UnSt64dpPpsa5kiCYiHGf9w5fOewSPgJYWIp/Ioae9z7du05X3PfzXnzFe/ZGryHP/8Yr+5r7jGBuaILFYAoXFbmy+axP5xH23U6vNcknH+hvWkshsTBu8EHy1J3NuXCACwuMyHvx8GFsaZ+++4/bkJ3xeFYzNBSR2Oyv1IWZl4Av3SnPO4BCpp3GFce2dd9kLrVb2xfCUv/+T9+OFrz7G0FRyC5rH96ObXoCW42iZPmX83Ccf/ur2R+6+paDQifXXXynUL63hnHFOCCGaqgPgECUJZutvp2c9xW7iLHQMvfnL40+u9jZpJ0J+fLypDz/a6V734APRJ9ZfmbEBAudMhJqnxGLmDqeFWQESWTBgnWuQTJIsihERygA2XVvlikTc33j6OzOJhx+3vf7v30ihqXQzcmMMLq8VG+0bmzbfecNd1fWVAOYsQQnFyHCIRGdjJBlPQckooAJFQaELi5bVcH+FjwCAIAjwV/isTqPdRAjF1rV96L9gaNy+Pf6drbfFq1NJo36m1aU77RJRtRQlVJdFSZf4PDPO8wImIOBc4NAjHOoUJCT41tvrKjTN+6+7nol+oTtz4OcrCm/CyNZW7LrvWby6c9/VixsX2d/5v5LN8a7W86S3vS8/0DvUNRWaPpVOZYKUUKPH577m2lvWr7/+tqvFVDKN4OAYHwuOWwq9BQWB6iz6eg1Xbd8e/+72T8ZWEy6yg4dcGuGi0NdHWGmFzJmuMEIIn2+ual7AlIjIZaiiZHI5cALOM8REOvk9W2uq7PaCp+7acFtVx2x258bOxuTmLTdi/64jHsYYdF2HIAjQVI2cO9U5u/eFN3Z0dZx/YRTnwl/+869CMkh4+nu7fIqivCyZxCa3t4AFqsuImleFn+86YEtGyV0PfDbyta23JWodDobeXqu+ojEmejwafW2fV08kGdF15HJZmreY353hnRk+PwsTYJKJyWhUiOqMgBKAc50YyAV89Ca/t9Tv/7vqV8zrjhyM/jMhpPmuaz8TPXmshbvO2zWBiMhmFKH1VEfb6x2v/mBt8fVKBQ3g7aePIuezYgrdk5TePLiqqbHJX+6jADAZCku+Uutff+oT44u33JwskAQOrlEeKFeoJCv0/KBFYwI4ZYqQV+XItCIkC6C9KwO7CD1PC1MocCenwuFgViFrLKZ3nhcHZaNYsyxuqKkMfHzNGu+6N49sfSk4khIWL13EFy2pEXNKHulkhpw4eFoCHKIoCgB0KH4JnOfw8o+e53ueP55MxlJA+dxVV65dZnj8m1/Z0Hn0CS2d6mJ2OyghjFDKcX7QpfZcsPBMKiOWeBhSaTEYQWFaxNR7WnjewMho2P/MSfWFZwvbZyLCndYyhoxCeSwhspERkc9GOIqLhrDlRlvx2iu9D+/8DyE7G45BlmUiyzKUjAJCqN2OCufxMUkFZMGKnFxs0Jzf/MpTZV6/29/e0guHy8nMVhNRsjmeTuX56IiRt7cbsGZ1nptMnESTEpuaNvB4JC2WefOCkpMRicpt3/pit3bg6aL3MNpcUXxewJ6IEf/0dQ9UlZ7o6RETgXLVfiEoa6ExgZkEXTCKoG2tEsLTMd1fmsLypi8am65bQzgHYrMx3vZ2FxKzQ4E/vcPzI84zWYMckWw21W6xcLfZyDyUJqzdJ36k9Z45zEVJhJaLwygEycorwjQQ0Iksc8I54HamxJKiPFPTskAJQWhSik1MCCf37LZiccKAA+8BzOYLfBrnUZoKIDghtjU3G7tXNOaviicoq63Mk5oKVczlCbdZOdq7BCgKeCg+jIOvHGDpZBLDfUE+MdyBQPGg+YoG7TqfL09KfHlYLDooBXJ5gmiU8kS8m2ez3SAU3G7jcLsZtds4ZHnOARMCZLMU4QmRcgYwShAaFzq6BuT2gE9HDs55vazzAv4HPI5/5y/g73a0zu75ReXu06dzV8p2CrOZCFQAJImDCIyLMuENDRpxT/yUTAZfRDpNGE1zdueWvOj3M7HApcNq5TyjUG4ycgoARgOHw8YIv7iQEgowBq4ohBMBIBQEHMirhPf1y8hkKKEUiKcEvX9Q+vnff3Uq+p9P+rATO+cFPO9Sy/rAtWCahHSa1nx0S2TvhqvV2qRC88sWK0Iio/LxEOUWm4jqck4rSvIiZ0BbryE/GJT1xgZFqixXBUpBkinC+oOivrxelX6nKAFCgakZQT9x0qTPzIAbTSA11Yw21OXJ4ICImWlRAABB5Ghpkzt/8hP3bVYbGxZkB44Pvfiu+kden6sPzzs8TA/fAJ6zYM++N/o7u40/mAhRVmDTxeFRSZ+eMeg2h8RLixn1F6niXFQF+L1M4JySth6j9savTPm3mg251i6DWuxhlP7OnQkFhkZkffceC8umqFhewmWvi0vne40412PQR0IEnAOUArMxId/aZtr5nafPD7OsEZmheRTdLrrp91VMayq7BbrKMDsrFm65NfrcjddlN/l8Kg9U5rnDzohAQfhv7OEJAcbDkj4wKmt2m0bKizXRYmJElvjvnRdPCuyVX1j0Mp8m1NWpxOmYm+NDQZkNhmRNVVRqMwgSFYHDR817d/3U/SfFHjUqGAhOj+1/T+0je+cs/L6SeFWjBRismsCiotzM2TbLE8XFvFqUUJlOUwQq8yj2alwSfw3NOVDiVQWPW6NKjnCbeS6Q5r8b2BCgb1BkngKNXrVWIVYLI+8cL/JqGAnLPBkRiMfJcbbTeOHYW5YdS5ekotGkgG3BLpx+HwzvK+PxLJ6FmJBxvtOJv/iryeZjJ8x/dWHQOJ1VBNLbYyTt7SZMhUWu6eCEABwE8aTAjh2XtPOtEguPSUzV6O/HcQTIKZzX1eZgtTLCLz4UTSN8KiKx2WlQlwNC37Bh8tAb1q/cvS3c0tvpgTlpwOcwMS/tnM7Rvu+c1kimH4t8AezZXYATY5u6ZCU44yhgTR63ZkmnKJmeFkk0JkDVCGaiot4zIKseN6NLFqvizKTIZ+IC8xTplGBuWmka4YpCQSXwdI7yQienAgUhAhBLSuxUi0EXwKVIXJp6bY/tS3vOHX5+4PQ+eIsVHAvPP3X76La5nNYflJd2jwugpRxL6FG+++z2H6raD5PKdfzrSxvytQBHNCKQeFRAIi2ASxxMB3O7OZvJE11VwQf6ZapqIIpCkc1QKAqB1a7DYAXCUeh2s07HJwXW0SUyrjNxImw4f/CA9Sv7Ow/tbjDfBqeLwRV6n7V8vgBtS+tKb0VkVsADjw3gxV0lq9ZfnfmbVStyN3pcmlFXATVPeGhKVkUjY4Kgc9kASOCiSYZI6a8jOkIAVQVXVJ3pgM40AlGCoGlCrr3T/PqRw5a/3XzbTNuzP/TD7dHQPA8n9bsjeNFpXVaadlmiFsTLcWBvOfyl8YkDh1370wkSAoXP7mSFNhsTHVZdUBVK1BylIohoMXFBFH87fCUEkGUQm41Qu40InAjawKCp9fBh29d+ttf19UCJEjx4oAK+4gxWhEpxGmfft9ZH5/LSC9PjcZV7K4gljnxWxrY/G8O/favCv2JVekt9Q+6OyoDa6PVohWYTEwV60UNzXCyScxAC6Iwgq9B8eFqc6R+UznR1Gl49dcqy//4HJiZffbEIokmDPW3AocgfXgwf3svBKSwL1pi2GPXwlNdCzLmRopPYuCmKb+wqtTSVJhdVVORXFfv0pQUuPWCxMLcoMxMArqs0k0rRmdmIMDQxLrYPDcpnT085+h7+2Gj2VLMDVuaAIiexeqwK38OTl6UvuNDA74xKfAvVFa+iIFSJkaIZiFIeS5dn8P3dJ0DINgNFwmgHkziAOKQ84FA4/2H+0zddjQs9JjBdwj3jDuwpTaNvTMcwLq/F4RLwvg8I+DfHLfg0ZGSQB0XKlwQXGDSmXUq3UEIhEgFU46CTKZhggBFWvIJXLuu+/y3wB2Xh/6sjeLFP60PTIE4ufj40wO9ESx8aYHaxI14cfG1uLaQXHwIhAPl/OLP5fxeF/RYxAAKIVIKZ87mmD2DuICcL3yn/wROD8/eqp3GY/wvP2BTh17xE+QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0xMi0yNFQwNTo0NTozOSswMDowMFqiqiAAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMTItMjRUMDU6NDU6MzkrMDA6MDAr/xKcAAAAAElFTkSuQmCC"})}),Object(m.jsx)(p.a,{loading:n,type:"primary",onClick:r,children:"\u5bfc\u51fa\u56fe\u7247"})]})}var A=u.a.header(y||(y=Object(a.a)(["\n  height: 56px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 20px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n"]))),C=u.a.img(O||(O=Object(a.a)(["\n  width: 48px;\n  height: 48px;\n  object-fit: cover;\n  cursor: pointer;\n"]))),k=n(54),L=n(169),I=n.n(L).a.create({baseURL:"https://pixabay.com/api",timeout:1e4});I.interceptors.response.use((function(e){return e.data}));var M,S,E=I,B=n(339),T=n(344),z=n(337),D=n(333),R=n(13),U={global:{width:1280,height:720},background:{color:"#fff"},layers:[{id:"1",type:"image",width:510,height:340,position:{x:100,y:100},rotate:0,reverse:{x:1,y:1},source:{imageUrl:"https://cdn.pixabay.com/photo/2014/04/13/20/49/cat-323262__340.jpg"},opacity:1,zIndex:1},{id:"2",type:"text",width:380,height:72,position:{x:100,y:500},rotate:0,source:{content:"\u53cc\u51fb\u7f16\u8f91\u6587\u5b57"},style:{font:"Microsoft Yahei",fontSize:60,lineHeight:1.2,color:"#000",textAlign:"left",fontWeight:400,underline:!1},opacity:1,zIndex:2}]};!function(e){e.EMPTY="empty",e.IMAGE="image",e.TEXT="text",e.RECT="rect",e.CIRCLE="circle",e.BACKGROUND="background"}(M||(M={})),function(e){e.TL="topLeft",e.TR="topRight",e.BL="bottomLeft",e.BR="bottomRight",e.T="top",e.B="bottom",e.L="left",e.R="right"}(S||(S={}));var N=n(14),F=[],P=0,Y=!1;function K(){var e=J.setCanUseUndo,t=J.setCanUseRedo;return{init:function(e){F.push(e)},pushHistory:function(){if(Y)Y=!1;else{var n=Object(N.cloneDeep)(J.template);n.layers=n.layers.map((function(e){return e.isSelected=!1,e.isEditing=!1,e.isHover=!1,e})),P++,F[P]=n,F.splice(P+1,F.length),e(!0),t(!1),F.length>50&&(F.shift(),P--)}},undo:function(){if(F[P-1]){Y=!0,P--;var n=F[P];J.setTemplate(Object(N.cloneDeep)(n)),J.setLayerType(M.EMPTY),t(!0),F[P-1]||e(!1)}},redo:function(){if(F[P+1]){Y=!0,P++;var n=F[P];J.setTemplate(Object(N.cloneDeep)(n)),J.setLayerType(M.EMPTY),e(!0),F[P+1]||t(!1)}}}}var W=Object.assign(U,{layers:U.layers.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{isSelected:!1,isEditing:!1,isHover:!1,isLocked:!1,scale:1})}))}),Q=localStorage.getItem("TEMPLATE");Q&&(W=JSON.parse(Q));var J=Object(R.n)({template:W,layerType:M.EMPTY,needUpdateLayerHeight:!1,isMoving:!1,canUseUndo:!1,canUseRedo:!1,get layers(){return this.template.layers},get activeLayer(){return this.layers.find((function(e){return e.isSelected}))},getTemplate:function(){var e=Object(N.cloneDeep)(J.template);return e.layers=e.layers.map((function(e){var t;return"text"===e.type&&e.style&&e.scale&&(e.style.fontSize*=e.scale),delete e.isSelected,delete e.isEditing,delete e.scale,null===(t=e.clip)||void 0===t||delete t.pre,e})),e},setTemplate:function(e){this.template=e},setCanvasSize:function(e){this.template.global.width=e.width,this.template.global.height=e.height},setLayers:function(e){this.template.layers=e},setLayer:function(e){var t=this.layers.findIndex((function(t){return t.id===e.id}));t>-1&&!this.layers[t].isLocked&&(this.layers[t]=e)},addLayer:function(e){this.layers.push(e),this.updateLayerType(e)},removeLayer:function(e){var t=this.layers.findIndex((function(t){return t.id===e}));t>-1&&!this.layers[t].isLocked&&(this.layers.splice(t,1),this.setLayerType(M.EMPTY))},setLayerLevel:function(e,t){var n=this.layers.findIndex((function(t){return t.id===e}));n>-1&&(this.layers[n].zIndex=t)},selectLayer:function(e){var t=this;this.layers.forEach((function(n){n.isSelected=n.id===e,n.isSelected&&t.updateLayerType(n)})),document.dispatchEvent(new Event("mousedown"))},hoverLayer:function(e){this.layers.forEach((function(t){t.isHover=!!e&&t.id===e}))},updateLayerType:function(e){switch(e.type){case"image":this.setLayerType(M.IMAGE);break;case"text":this.setLayerType(M.TEXT);break;case"rect":this.setLayerType(M.RECT);break;case"circle":this.setLayerType(M.CIRCLE)}},setLayerType:function(e){this.layerType=e},setEditStatus:function(e){this.layers.some((function(t){return t.id===e&&t.isLocked}))||this.layers.forEach((function(t){t.isEditing=t.id===e}))},setLayerLock:function(e,t){var n=this.layers.findIndex((function(t){return t.id===e}));n>-1&&(this.layers[n].isLocked=t,this.layers[n].isEditing=!1)},resetSelectStatus:function(){this.layers.forEach((function(e){e.isSelected=!1})),this.setLayerType(M.EMPTY)},resetEditStatus:function(){this.layers.forEach((function(e){e.isEditing=!1}))},setBackgroundColor:function(e){this.template.background.color=e},setNeedUpdateLayerHeight:function(e){this.needUpdateLayerHeight=e},setIsMoving:function(e){this.isMoving=e},setCanUseUndo:function(e){this.canUseUndo=e},setCanUseRedo:function(e){this.canUseRedo=e}},{setTemplate:R.f.bound,getTemplate:R.f.bound,setCanvasSize:R.f.bound,setLayers:R.f.bound,setLayer:R.f.bound,addLayer:R.f.bound,removeLayer:R.f.bound,selectLayer:R.f.bound,setLayerLevel:R.f.bound,hoverLayer:R.f.bound,updateLayerType:R.f.bound,setLayerType:R.f.bound,setEditStatus:R.f.bound,setLayerLock:R.f.bound,resetSelectStatus:R.f.bound,resetEditStatus:R.f.bound,setBackgroundColor:R.f.bound,setNeedUpdateLayerHeight:R.f.bound,setIsMoving:R.f.bound,setCanUseUndo:R.f.bound,setCanUseRedo:R.f.bound}),V=K(),Z=V.init,H=V.pushHistory;Z(W),Object(R.o)((function(){return J.layers.map((function(e){return e.isSelected})).join("")}),(function(){J.resetEditStatus();var e=J.layers.findIndex((function(e){var t;return"text"===e.type&&!(null===(t=e.source.content)||void 0===t?void 0:t.replaceAll(/\n/g,""))}));e>-1&&J.removeLayer(J.layers[e].id)}));Object(R.o)((function(){var e=Object(N.cloneDeep)(J.template);return e.layers=e.layers.map((function(e){return delete e.isSelected,delete e.isEditing,delete e.isHover,e})),JSON.stringify(e)}),(function(){!function(){var e=Object(N.cloneDeep)(J.template);e.layers=e.layers.map((function(e){return e.isSelected=!1,e.isEditing=!1,e.isHover=!1,e})),localStorage.setItem("TEMPLATE",JSON.stringify(e))}(),H()}),{delay:500});var X,q,G,_,$,ee,te=n(12),ne=function(e,t,n,i,o){return{id:String(Date.now()),type:"image",width:e,height:t,position:i,rotate:0,reverse:{x:1,y:1},source:{imageUrl:n},clip:{width:e,height:t,top:0,left:0,right:0,bottom:0,pre:{width:e,height:t,top:0,left:0,right:0,bottom:0}},opacity:1,zIndex:o,isSelected:!0,isEditing:!1,isLocked:!1,scale:1}},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return{id:String(Date.now()),type:"rect",width:e,height:t,position:n,source:{},rotate:0,opacity:1,rectInfo:{fill:"#fff",borderWidth:6,borderColor:"#000",borderStyle:"solid"},zIndex:i,isSelected:!0,isEditing:!1,isLocked:!1}},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return{id:String(Date.now()),type:"circle",width:e,height:t,position:n,source:{},rotate:0,opacity:1,circleInfo:{fill:"#fff",borderWidth:6,borderColor:"#000",borderStyle:"solid"},zIndex:i,isSelected:!0,isEditing:!1,isLocked:!1}},re=Object(te.a)((function(e){var t=e.image,n=J.template,i=J.layers,o=J.addLayer,r=J.resetSelectStatus;return Object(m.jsx)(ce,{style:{flexBasis:"".concat(100*t.webformatWidth/t.webformatHeight,"px")},draggable:"true",onClick:function(){var e={x:(n.global.width-t.webformatWidth)/2,y:(n.global.height-t.webformatHeight)/2},c=i.length?i[i.length-1].zIndex+1:1,a=ne(t.webformatWidth,t.webformatHeight,t.webformatURL,e,c);r(),o(a)},onDragStartCapture:function(e){e.dataTransfer.setData("image",JSON.stringify(t))},children:Object(m.jsx)("img",{src:t.webformatURL,alt:"",draggable:"false"})})})),ce=u.a.div(X||(X=Object(a.a)(["\n  position: relative;\n  margin: 0 10px 10px 0;\n  background-color: #f0f1f4;\n  overflow: hidden;\n  flex-grow: 1;\n  cursor: pointer;\n\n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #000;\n    opacity: 0;\n    transition: opacity 100ms;\n  }\n\n  &:hover::before {\n    opacity: .2;\n  }\n\n  &:active::before {\n    opacity: 0;\n  }\n\n  img {\n    min-width: 100%;\n    height: 100px;\n    object-fit: cover;\n  }\n"]))),ae=Object(te.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,i=J.resetSelectStatus,o=J.setEditStatus,r=function(r){var c={width:600,height:114,fontWeight:700,fontSize:95};"subTitle"===r&&(c={width:380,height:72,fontWeight:700,fontSize:60}),"text"===r&&(c={width:300,height:48,fontWeight:400,fontSize:40});var a=function(e,t,n){var i=n.width,o=n.height,r=n.fontWeight,c=n.fontSize;return{id:String(Date.now()),type:"text",width:i,height:o,position:e,rotate:0,source:{content:"\u53cc\u51fb\u7f16\u8f91\u6587\u5b57"},style:{font:"\u5fae\u8f6f\u96c5\u9ed1",fontSize:c,lineHeight:1.2,color:"#000",textAlign:"left",fontWeight:r,underline:!1},opacity:1,zIndex:t,isSelected:!0,isEditing:!0,isLocked:!1,scale:1}}({x:(e.global.width-c.width)/2,y:(e.global.height-c.height)/2},t.length?t[t.length-1].zIndex+1:1,c);i(),n(a),o(a.id)};return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(p.a,{size:"large",style:{width:"100%",height:40,fontWeight:700},onClick:function(){return r("title")},children:"\u6dfb\u52a0\u6807\u9898"}),Object(m.jsx)(p.a,{size:"middle",style:{width:"100%",height:36,fontWeight:500,marginTop:20},onClick:function(){return r("subTitle")},children:"\u6dfb\u52a0\u526f\u6807\u9898"}),Object(m.jsx)(p.a,{size:"small",style:{width:"100%",height:32,marginTop:20},onClick:function(){return r("text")},children:"\u6dfb\u52a0\u6b63\u6587"})]})})),le=Object(te.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,i=J.resetSelectStatus;return Object(m.jsx)(de,{draggable:"true",onClick:function(){var o={x:(e.global.width-200)/2,y:(e.global.height-200)/2},r=t.length?t[t.length-1].zIndex+1:1,c=ie(200,200,o,r);i(),n(c)},onDragStartCapture:function(e){e.dataTransfer.setData("rect","1")}})})),se=Object(te.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,i=J.resetSelectStatus;return Object(m.jsx)(he,{draggable:"true",onClick:function(){var o={x:(e.global.width-200)/2,y:(e.global.height-200)/2},r=t.length?t[t.length-1].zIndex+1:1,c=oe(200,200,o,r);i(),n(c)},onDragStartCapture:function(e){e.dataTransfer.setData("circle","1")}})})),de=u.a.div(q||(q=Object(a.a)(["\n  position: relative;\n  width: 60px;\n  height: 60px;\n  margin-right: 10px;\n  border: 4px solid #000;\n  background-color: transparent;\n  cursor: pointer;\n\n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #000;\n    opacity: 0;\n    transition: opacity 100ms;\n  }\n\n  &:hover::before {\n    opacity: .15;\n  }\n\n  &:active::before {\n    opacity: 0;\n  }\n"]))),he=Object(u.a)(de)(G||(G=Object(a.a)(["\n  border-radius: 50%;\n  &::before {\n    border-radius: 50%;\n  }\n"]))),ue=Object(te.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,i=J.resetSelectStatus,o=function(o,r,c){var a={x:(e.global.width-o)/2,y:(e.global.height-r)/2},l=t.length?t[t.length-1].zIndex+1:1,s=ne(o,r,c,a,l);i(),n(s)};return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(pe,{htmlFor:"uploadImage",children:Object(m.jsx)(p.a,{size:"large",children:"\u9009\u62e9\u672c\u5730\u56fe\u7247"})}),Object(m.jsx)("input",{type:"file",id:"uploadImage",accept:"image/*",style:{display:"none"},onChange:function(e){var t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;if("string"===typeof n){var i=new Image;i.src=n,i.onload=function(){o(i.width,i.height,n)}}}}})]})})),pe=u.a.label(_||(_=Object(a.a)(["\n  display: block;\n  width: 100%;\n  margin-bottom: 16px;\n  cursor: pointer;\n\n  button {\n    width: 100%;\n    pointer-events: none;\n  }\n"]))),be=B.a.Panel,fe=z.a.Search,ge=!1,xe=!1;function je(){var e=Object(i.useState)([]),t=Object(h.a)(e,2),n=t[0],o=t[1],r=Object(i.useState)({page:1,per_page:20,image_type:"all",q:"",orientation:"all",safesearch:!0}),c=Object(h.a)(r,2),a=c[0],l=c[1],s=Object(i.useState)(!1),d=Object(h.a)(s,2),u=d[0],b=d[1];Object(i.useEffect)((function(){var e;(e=a,E({url:"/",params:Object(k.a)({key:"24178889-8dbe9fccf0c585814c1dcb342",lang:"zh"},e)})).then((function(e){o(xe?function(t){return t.concat(e.hits)}:e.hits)})).finally((function(){ge=!1}))}),[a]);return Object(m.jsx)(we,{children:Object(m.jsxs)(B.a,{defaultActiveKey:["1"],collapsible:"header",children:[Object(m.jsx)(be,{header:Object(m.jsx)("div",{style:{width:"300px"},children:"\u56fe\u7247"}),extra:function(){var e=function(e,t){t.preventDefault(),e&&(xe=!1,l(Object.assign({},a,{q:e,page:1})))};return Object(m.jsx)(D.a,{content:function(){return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(fe,{placeholder:"\u641c\u7d22",onSearch:e,style:{width:200}})})},title:"\u7b5b\u9009",trigger:"click",visible:u,onVisibleChange:function(e){return b(e)},children:Object(m.jsx)(T.a,{onClick:function(e){e.stopPropagation(),b(!0)}})})}(),children:Object(m.jsxs)(Ae,{children:[Object(m.jsx)(ue,{}),n.map((function(e){return Object(m.jsx)(re,{image:e},e.id)})),Object(m.jsx)(p.a,{style:{width:"100%",marginTop:"20px"},onClick:function(){if(!ge){ge=!0;var e=a.page;xe=!0,l(Object.assign({},a,{page:e?e+1:1}))}},children:"\u52a0\u8f7d\u66f4\u591a"})]})},"1"),Object(m.jsx)(be,{header:Object(m.jsx)("div",{style:{width:"300px"},children:"\u6587\u5b57"}),children:Object(m.jsx)(Ae,{children:Object(m.jsx)(ae,{})})},"2"),Object(m.jsx)(be,{header:Object(m.jsx)("div",{style:{width:"300px"},children:"\u5f62\u72b6"}),children:Object(m.jsxs)(Ae,{children:[Object(m.jsx)(le,{}),Object(m.jsx)(se,{})]})},"3")]})})}var ve,ye,Oe,me,we=u.a.aside($||($=Object(a.a)(["\n  flex: none;\n  display: flex;\n  flex-direction: column;\n  width: 400px;\n  height: 100%;\n  background-color: #fff;\n  border-right: 1px solid #ddd;\n  overflow-y: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #fff;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n\n  .ant-collapse {\n    border: 0;\n    background-color: #fff;\n  }\n"]))),Ae=u.a.div(ee||(ee=Object(a.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  padding-left: 10px;\n  user-select: none;\n\n  &:after {\n    content: '';\n    display: block;\n    flex-grow: 99999;\n  }\n"]))),Ce=n(334),ke=K(),Le=ke.undo,Ie=ke.redo,Me=Object(te.a)((function(e){var t=e.scale,n=e.setScale,i=e.responsive,o=J.canUseUndo,r=J.canUseRedo;return Object(m.jsxs)(Se,{children:[Object(m.jsxs)(Ee,{children:[Object(m.jsx)(Ce.a,{className:"slider",tipFormatter:null,value:100*t,min:10,max:500,onChange:function(e){n(e/100)}}),Object(m.jsxs)(Te,{className:"scale active",onClick:i,children:[Math.round(100*t),"%"]})]}),Object(m.jsxs)(Be,{children:[Object(m.jsx)(Te,{className:o?"active":"",onClick:Le,children:Object(m.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArRJREFUWEfFl09rE1EQwGfyB/SgKOjBQz1IIeBBEPsB6tFL8uZBCiIIgiiKigcpiKDtwYJ4kFpQiAh68WDovrdRWMGDfoAW9KBURRCUigoe9BJD3o5syZbNZje7G5P4IITMmzfzezPzZgjCf16Yxj8RXQWAeWae11rPpTmTVicRQAhxGREXfIPDhugLQESXAOBm8DaI+MCyrBNpb5ikFwtARBcAYDFk4I3rujO2bb9NMpx2PxJACHEGEe+M2rlnvwdASnmSme+Nw3kPABEdB4CHEeHzIvKtIzfM7HqrUCgY79v7DQCe/Hur1friOM6vzCkQQhxFxEdpDyborSGicl13WWu92k93IwXVanWy3W5/GJLzLjOIWDPGLMYV7mYNENFjj2UUEAAQ+3q6ijAOwms+acAQcQIASp3PrjSF3PMKoiAG6X5CiNuIeD4JIrIPDBFiGhFfhDppzbKs076sXyeMqolZpVRXa05KTblcLuXz+bWgHjNP+a8jaRb0QLiue8y27UzPVQgxi4g3Nm+NeMWyrI0BlzgNw+kYdBgR0U8A2NmBeKWUOpgKwFMKQDxn5lNa609JoQ/vE9EKABzy5caY7Y1G43diBPwDQoi5YrG4UK/XW1mdhy7hHy8ppd6nBhjEafCMdwFEvObLmPmw1vrl2ACIaBkAZABgUmv9cWwAUsrXzHzAB2g2m1scx/kzFoBKpTKRy+XeAcDWDsAzpdSR1K/gX/MvpVxi5nOB8J/VWt8dCwAReRPWa2j+WkfEKcuyvo4cQEp5i5kvhtpw13+LodeAEGJHoVDYb4y5DgDTofTVlVIzQVlmgGq1utsYc5+Zt0XUxl4A2BdTMz3OB0qBEKJnxKYo0kjn4wBYZeaa1roWB5k5BVLKPcy8HmPwBwB8RsQVZn6ilHqaFJ3MAEkGs+7/BQfySDDlTlsQAAAAAElFTkSuQmCC",alt:""})}),Object(m.jsx)(Te,{className:r?"active":"",onClick:Ie,children:Object(m.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAqtJREFUWEfFljGrE0EQx2duQ0yjiKA2TxBEfWjhg2dno1gdaLJzD2MlKOLDRkUtLCx8tqIgPEGwULASD243ATvB9wVEsBCEh4qChQqKFlpcMrIhd1wul9wuOXEhhGRn5v+7uZ2ZRfjPC6vWl1KuIOINAGgrpcKy+JUCZMQT3VKISgGCIHjEzKdzTz0VolKAVqu1z/O8pwCw3xaiUgAj6gpROYArhBOA7/ub6vX6HCJuAwCBiJ5ZcRwL821+m/8NBDNvB4D7BVUwciZKAaSUi57nLTEzAcB8WVlZ7qcQEwHMuxRCXGLmZcugTma1Wm13GIbrhQDDg/QMAHY6RbU3DpVSbWM+BiClPIyILwpifQOAt+bDzJ9stIYdMW+aio8BSCkXhuKbs17MvKq1vmgjmtgUdEWzNSI+BkBEpomcyIkf0VqvuYgT0RUAuJPzGRMfASCiMwDwMOvU6/Xmu92uSbv1IqJzAPDARnwEIAiCx8x8KnFk5mta61vWygAQBMFJZn5iK57PwPvMqf+ulNriIm5sC4ZRYdqzcQdV0Gw2NwohfmY2XiqlDroC5OZAqXiaASLaMyyxRNPKuQjQQCBiW2u9YvMAgwzka5+Zb9oGsBGZZpMA7ELE9YxhpJRamjW4jf8AwPf9DY1G40/igIivoyg6YBNgVpu0FRPRKwBYGAb83e/393Y6HauWOwtEFsDM7vOZLNyLoujCLMFtfFMAKeVRRHyecyq91dqIlB7CxEBKeRsRr440CsS7URRdnlVokv/YOM6dhcRvTQhxPY7jN1rrH1XCFF5IiOgLAGydIPQOAD7m9xDxlxDibBiGX10AJ17JikZzWWBmdh7dUy+lUsplRDR3wsUycbNfOUAiSkTHEPE4M5sBtWPC6/nMzIe01h9sYNNydzH+F7Z/AWqi/yEtgkl8AAAAAElFTkSuQmCC",alt:""})})]})]})})),Se=u.a.footer(ve||(ve=Object(a.a)(["\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  width: 100%;\n  height: 44px;\n  padding: 0 40px;\n  background-color: #fff;\n  border-top: 1px solid #ddd;\n\n  .slider {\n    width: 240px;\n  }\n\n  .scale {\n    /* width: 100px; */\n    margin: 0 20px;\n  }\n"]))),Ee=u.a.div(ye||(ye=Object(a.a)(["\n  display: flex;\n  align-items: center;\n"]))),Be=u.a.div(Oe||(Oe=Object(a.a)(["\n  display: flex;\n  justify-content: space-around;\n  width: 120px;\n\n  img {\n    width: 22px;\n    height: 22px;\n    pointer-events: none;\n    user-select: none;\n  }\n"]))),Te=u.a.div(me||(me=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  padding: 6px 8px;\n  border-radius: 4px;\n  cursor: not-allowed;\n  opacity: .5;\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  &.active {\n    opacity: 1;\n    cursor: pointer;\n  }\n"]))),ze=Object(i.createContext)(1),De=Object(i.createContext)(null),Re=n(172),Ue=function e(t,n,i){var o=this;Object(Re.a)(this,e),this.handleMove=function(e){},this.handleUp=function(){},this.startCoords={x:0,y:0},this.preCoords={x:0,y:0},this.mouseUp=function(){document.onmousemove=null,document.onmouseup=null,o.handleUp()},this.mouseMove=function(e){var t=e.clientX-o.preCoords.x,n=e.clientY-o.preCoords.y,i={x:o.preCoords.x,y:o.preCoords.y};o.handleMove({diff:{x:t,y:n},startCoords:o.startCoords,curCoords:o.preCoords,preCoords:i}),o.preCoords={x:e.clientX,y:e.clientY}},this.mouseDown=function(e){o.startCoords={x:e.clientX,y:e.clientY},o.preCoords={x:e.clientX,y:e.clientY},document.onmousemove=o.mouseMove,document.onmouseup=o.mouseUp},this.mouseDown(t),this.handleMove=n,i&&(this.handleUp=i)};var Ne=10,Fe=10;function Pe(e,t,n,i,o){var r=e.width/e.height,c=e.position,a=c.x,l=c.y,s=e.width,d=e.height,h=n.x,u=n.y;switch(t){case S.TL:s-=h/i,a+=h/i,o?d=s/r:d-=u/i,l-=d-e.height;break;case S.TR:s+=h/i,o?d=s/r:d-=u/i,l-=d-e.height;break;case S.BL:s-=h/i,a+=h/i,o?d=s/r:d+=u/i;break;case S.BR:s+=h/i,o?d=s/r:d+=u/i;break;case S.T:d-=u/i,l+=u/i;break;case S.B:d+=u/i;break;case S.L:s-=h/i,a+=h/i;break;case S.R:s+=h/i}return(s>Ne&&d>Fe||s>e.width||d>e.height)&&(s>Ne&&(e.width=s,e.position.x=a),d>Fe&&(e.height=d,e.position.y=l)),e}function Ye(e,t,n,i,o,r,c,a,l){switch(e){case S.TL:var s=g(t,n),d=x(t,s,-o.rotate),h=x(n,s,-o.rotate),u=h.x-d.x,p=h.y-d.y;if(l){u/p>c?d.x+=Math.abs(u-p*c):d.y+=Math.abs(p-u/c);var b=x(d,s,o.rotate);s=g(b,n),d=x(b,s,-o.rotate),u=(h=x(n,s,-o.rotate)).x-d.x,p=h.y-d.y}u/a>Ne&&p/a>Fe&&(r.width=u/a,r.height=p/a,r.position.y=d.y/a,r.position.x=d.x/a);break;case S.TR:var f=g(t,n),j=x(t,f,-o.rotate),v=x(n,f,-o.rotate),y=j.x-v.x,O=v.y-j.y;if(l){y/O>c?j.x-=Math.abs(y-O*c):j.y+=Math.abs(O-y/c);var m=x(j,f,o.rotate);f=g(m,n),j=x(m,f,-o.rotate),v=x(n,f,-o.rotate),y=j.x-v.x,O=v.y-j.y}y/a>Ne&&O/a>Fe&&(r.width=y/a,r.height=O/a,r.position.y=j.y/a,r.position.x=v.x/a);break;case S.BR:var w=g(t,n),A=x(t,w,-o.rotate),C=x(n,w,-o.rotate),k=A.x-C.x,L=A.y-C.y;if(l){k/L>c?A.x-=Math.abs(k-L*c):A.y-=Math.abs(L-k/c);var I=x(A,w,o.rotate);w=g(I,n),A=x(I,w,-o.rotate),C=x(n,w,-o.rotate),k=A.x-C.x,L=A.y-C.y}k/a>Ne&&L/a>Fe&&(r.width=k/a,r.height=L/a,r.position.y=C.y/a,r.position.x=C.x/a);break;case S.BL:var M=g(t,n),E=x(t,M,-o.rotate),B=x(n,M,-o.rotate),T=B.x-E.x,z=E.y-B.y;if(l){T/z>c?E.x+=Math.abs(T-z*c):E.y-=Math.abs(z-T/c);var D=x(E,M,o.rotate);M=g(D,n),E=x(D,M,-o.rotate),T=(B=x(n,M,-o.rotate)).x-E.x,z=E.y-B.y}T/a>Ne&&z/a>Fe&&(r.width=T/a,r.height=z/a,r.position.y=B.y/a,r.position.x=E.x/a);break;case S.T:case S.B:var R=x(t,i,-o.rotate),U=x({x:i.x,y:R.y},i,o.rotate),N=Math.sqrt(Math.pow(U.x-n.x,2)+Math.pow(U.y-n.y,2)),F={x:U.x-(U.x-n.x)/2,y:U.y+(n.y-U.y)/2},P=!1,Y=(o.rotate+360)%360;e===S.T&&(Y>=0&&Y<=90||Y>=270&&Y<=360?U.y>=n.y&&(P=!0):U.y<=n.y&&(P=!0)),e===S.B&&(Y>=90&&Y<=270?U.y>=n.y&&(P=!0):U.y<=n.y&&(P=!0)),N/a>Fe&&!P&&(r.height=N/a,r.position.y=(F.y-N/2)/a,r.position.x=F.x/a-r.width/2);break;case S.L:case S.R:var K=x(t,i,-o.rotate),W=x({x:K.x,y:i.y},i,o.rotate),Q=Math.sqrt(Math.pow(W.x-n.x,2)+Math.pow(W.y-n.y,2)),J={x:W.x-(W.x-n.x)/2,y:W.y+(n.y-W.y)/2},V=!1,Z=(o.rotate+360)%360;e===S.L&&(Z>=0&&Z<=90||Z>=270&&Z<=360?W.x>=n.x&&(V=!0):W.x<=n.x&&(V=!0)),e===S.R&&(Z>=90&&Z<=270?W.x>=n.x&&(V=!0):W.x<=n.x&&(V=!0)),Q/a>Ne&&!V&&(r.width=Q/a,r.position.y=J.y/a-r.height/2,r.position.x=(J.x-Q/2)/a)}return r}var Ke,We,Qe,Je,Ve,Ze,He,Xe,qe,Ge,_e,$e=function(e,t,n,i){var o,r;if(-1===(null===(o=e.reverse)||void 0===o?void 0:o.x)&&(t===S.L?t=S.R:t===S.R&&(t=S.L)),-1===(null===(r=e.reverse)||void 0===r?void 0:r.y)&&(t===S.T?t=S.B:t===S.B&&(t=S.T)),e.clip){var c=e.clip.pre.width/e.clip.pre.height;switch(t){case S.BR:case S.BL:case S.TL:case S.TR:var a=e.width/n;e.clip.width*=a,e.clip.height*=a,e.clip.top*=a,e.clip.left*=a,e.clip.right*=a,e.clip.bottom*=a;break;case S.R:if(e.width+e.clip.left>e.clip.pre.width){e.clip.left*=e.width/n,e.clip.top*=e.width/n;var l=e.clip.left+e.width;e.clip.width=l,e.clip.height=l/c}else e.clip.left=e.clip.pre.left,e.clip.top=e.clip.pre.top,e.clip.width=e.clip.pre.width,e.clip.height=e.clip.pre.height;break;case S.L:if(e.width+e.clip.right>e.clip.pre.width){e.clip.right*=e.width/n;var s=e.clip.right+e.width;e.clip.width=s,e.clip.left=0,e.clip.top*=e.width/n,e.clip.height=s/c}else e.clip.left=e.clip.pre.width-e.clip.pre.right-e.width,e.clip.top=e.clip.pre.top,e.clip.width=e.clip.pre.width,e.clip.height=e.clip.pre.height,e.clip.right=e.clip.pre.right,e.clip.bottom=e.clip.pre.bottom;break;case S.B:if(e.height+e.clip.top>e.clip.pre.height){e.clip.top*=e.height/i,e.clip.left*=e.height/i;var d=e.clip.top+e.height;e.clip.height=d,e.clip.width=d*c}else e.clip.left=e.clip.pre.left,e.clip.top=e.clip.pre.top,e.clip.width=e.clip.pre.width,e.clip.height=e.clip.pre.height;break;case S.T:if(e.height+e.clip.bottom>e.clip.pre.height){e.clip.bottom*=e.height/i;var h=e.clip.bottom+e.height;e.clip.height=h,e.clip.top=0,e.clip.left*=e.height/i,e.clip.width=h*c}else e.clip.top=e.clip.pre.height-e.clip.pre.bottom-e.height,e.clip.left=e.clip.pre.left,e.clip.width=e.clip.pre.width,e.clip.height=e.clip.pre.height,e.clip.right=e.clip.pre.right,e.clip.bottom=e.clip.pre.bottom}}return e},et=function(e){return e.clip&&(e.clip.pre.left=e.clip.left,e.clip.pre.top=e.clip.top,e.clip.pre.right=e.clip.width-e.clip.left-e.width,e.clip.pre.bottom=e.clip.height-e.clip.top-e.height,e.clip.pre.width=e.clip.width,e.clip.pre.height=e.clip.height,e.clip.right=e.clip.pre.right,e.clip.bottom=e.clip.pre.bottom),e},tt=n.p+"static/media/rotate.a7cc796d.svg",nt=n.p+"static/media/lock.7263c59f.svg",it=[0,45,90,135],ot=[{start:0,end:23,cursor:"nwse-resize"},{start:338,end:360,cursor:"nwse-resize"},{start:23,end:68,cursor:"ns-resize"},{start:68,end:113,cursor:"nesw-resize"},{start:113,end:158,cursor:"ew-resize"},{start:158,end:203,cursor:"nwse-resize"},{start:203,end:248,cursor:"ns-resize"},{start:248,end:293,cursor:"nesw-resize"},{start:293,end:338,cursor:"ew-resize"}],rt=Object(te.a)((function(e){var t=e.info,n=Object(i.useContext)(ze),o=J.layers,r=J.setLayer,c=J.isMoving,a=J.setIsMoving,l=Object(i.useState)([]),s=Object(h.a)(l,2),d=s[0],u=s[1],p=function(e,i){e.stopPropagation(),0===t.rotate?function(e,i){var c=o.findIndex((function(e){return e.id===t.id}));c>-1&&new Ue(e,(function(e){var t=Object(N.cloneDeep)(o[c]),l=t.height,s=t.width,d=Pe(t,i,e.diff,n,!0);"text"===d.type&&d.height!==l&&d.scale&&(d.scale*=d.height/l),"image"===d.type&&(d=$e(d,i,s,l)),r(d),a(!0)}),(function(){var e=Object(N.cloneDeep)(o[c]);"image"===e.type&&(e=et(e),r(e)),a(!1)}))}(e,i):function(e,i){var c,l,s=(t.position.x+t.width/2)*n,d=(t.position.y+t.height/2)*n,h=null===(c=e.target)||void 0===c?void 0:c.getBoundingClientRect(),u=null===(l=document.querySelector("#layerControl"))||void 0===l?void 0:l.getBoundingClientRect(),p={x:h.left-Number(u.left)+h.width/2,y:h.top-Number(u.top)+h.height/2},b={x:s-(p.x-s),y:d-(p.y-d)},f=t.width/t.height,g=o.findIndex((function(e){return e.id===t.id}));new Ue(e,(function(e){var c=e.curCoords,l=Object(N.cloneDeep)(o[g]),s={x:c.x-Number(u.left),y:c.y-Number(u.top)},d=l.height,h=l.width,x=Ye(i,s,b,p,t,l,f,n,!0);"text"===x.type&&x.height!==d&&x.scale&&(x.scale*=x.height/d),"image"===x.type&&(x=$e(x,i,h,d)),r(x),a(!0)}),(function(){var e=Object(N.cloneDeep)(o[g]);"image"===e.type&&(e=et(e),r(e)),a(!1)}))}(e,i)},b=Object(i.useCallback)((function(){var e=t.rotate;e<0&&(e+=360);var n=[];it.forEach((function(t){var i=(t+e)%360,o=ot.find((function(e){return e.start<=i&&e.end>=i}));o&&n.push(o.cursor)})),u(n)}),[t.rotate]);return Object(i.useEffect)((function(){b()}),[b]),Object(m.jsx)(ct,{style:{width:t.width*n,height:t.height*n,transform:"translate(".concat(t.position.x*n,"px, ").concat(t.position.y*n,"px) rotate(").concat(t.rotate,"deg)")},className:["border-control",c?"moving":""].join(" "),children:t.isLocked?Object(m.jsx)(xt,{icon:nt,rotate:t.rotate}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(ht,{style:{cursor:d[0]},onMouseDown:function(e){return p(e,S.BR)}}),t.width*n>30&&t.height*n>30&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(lt,{style:{cursor:d[0]},onMouseDown:function(e){return p(e,S.TL)}}),Object(m.jsx)(st,{style:{cursor:d[2]},onMouseDown:function(e){return p(e,S.TR)}}),Object(m.jsx)(dt,{style:{cursor:d[2]},onMouseDown:function(e){return p(e,S.BL)}}),Object(m.jsx)(bt,{style:{cursor:d[3]},onMouseDown:function(e){return p(e,S.L)}}),Object(m.jsx)(ft,{style:{cursor:d[3]},onMouseDown:function(e){return p(e,S.R)}}),"text"!==t.type&&Object(m.jsx)(ut,{style:{cursor:d[1]},onMouseDown:function(e){return p(e,S.T)}}),"text"!==t.type&&Object(m.jsx)(pt,{style:{cursor:d[1]},onMouseDown:function(e){return p(e,S.B)}})]}),Object(m.jsx)(gt,{className:"rotate-point",icon:tt,onMouseDown:function(e){e.stopPropagation();var n=e.target.closest(".border-control");if(n){var i=n.getBoundingClientRect(),c={x:i.left+i.width/2,y:i.top+i.height/2};new Ue(e,(function(e){var n=e.curCoords,i=n.y-c.y,l=n.x-c.x,s=180*Math.atan2(i,l)/Math.PI,d=o.findIndex((function(e){return e.id===t.id})),h=Object(N.cloneDeep)(o[d]);h.rotate=(s-90+360)%360,r(h),a(!0)}),(function(){a(!1)}))}}})]})})})),ct=u.a.div(Ke||(Ke=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n\n  &.moving .rotate-point {\n    opacity: 0;\n  }\n\n  &.moving span {\n    opacity: 0;\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    right: -1px;\n    bottom: -1px;\n    border: 2px solid #00c4cc;\n  }\n"]))),at=u.a.span(We||(We=Object(a.a)(["\n  position: absolute;\n  display: block;\n  background: transparent;\n  z-index: 1;\n  pointer-events: auto;\n  width: 18px;\n  height: 18px;\n  user-select: none;\n  transition: opacity 200ms;\n\n  ::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    border-radius: 6px;\n    background: #fff;\n    box-shadow: 0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(53 71 90 / 20%);\n  }\n"]))),lt=Object(u.a)(at)(Qe||(Qe=Object(a.a)(["\n  top: -9px;\n  left: -9px;\n  cursor: nwse-resize;\n"]))),st=Object(u.a)(at)(Je||(Je=Object(a.a)(["\n  top: -9px;\n  right: -9px;\n  cursor: nesw-resize;\n"]))),dt=Object(u.a)(at)(Ve||(Ve=Object(a.a)(["\n  bottom: -9px;\n  left: -9px;\n  cursor: nesw-resize;\n"]))),ht=Object(u.a)(at)(Ze||(Ze=Object(a.a)(["\n  bottom: -9px;\n  right: -9px;\n  cursor: nwse-resize;\n"]))),ut=Object(u.a)(at)(He||(He=Object(a.a)(["\n  width: calc(100% - 24px);\n  height: 12px;\n  top: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n"]))),pt=Object(u.a)(at)(Xe||(Xe=Object(a.a)(["\n  width: calc(100% - 24px);\n  height: 12px;\n  bottom: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n"]))),bt=Object(u.a)(at)(qe||(qe=Object(a.a)(["\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  left: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n"]))),ft=Object(u.a)(at)(Ge||(Ge=Object(a.a)(["\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  right: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n"]))),gt=u.a.div({position:"absolute",left:"50%",bottom:"-50px",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",transform:"translate(-50%, -50%)",pointerEvents:"auto",borderRadius:"50%",boxShadow:"0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)",userSelect:"none",cursor:"grab"},(function(e){return{background:"#fff url(".concat(e.icon,") no-repeat center / 18px 18px")}})),xt=u.a.div({position:"absolute",right:"0",bottom:"0",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto",borderRadius:"50%",boxShadow:"0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)",userSelect:"none",zIndex:"1"},(function(e){return{background:"#fff url(".concat(e.icon,") no-repeat center / 13px 13px"),transform:"translate(50%, 50%) rotate(".concat(-e.rotate,"deg)")}}));function jt(e){var t=e.info,n=Object(i.useContext)(ze);return Object(m.jsx)(Ot,{style:{width:t.width*n,height:t.height*n,transform:"translate(".concat(t.position.x*n,"px, ").concat(t.position.y*n,"px) rotate(").concat(t.rotate,"deg)")}})}var vt,yt,Ot=u.a.div(_e||(_e=Object(a.a)(["\nposition: absolute;\ntop: 0;\nleft: 0;\npointer-events: none;\n\n&:after {\n  content: '';\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n}\n"]))),mt=Object(te.a)((function(e){var t,n,o=e.children,r=e.info,c=Object(i.useContext)(ze),a=J.template,l=J.layers,s=J.setLayer,d=J.selectLayer,h=J.hoverLayer,u=J.isMoving,p=J.setIsMoving,b=Object(i.useContext)(De).setIsSelectedBackground,f=function(){var e={x:0,y:0,width:0,height:0,rotate:0},t={x:0,y:0,width:0,height:0},n="",i=[],o=1,r={width:0,height:0},c=4,a=document.querySelector("#verticalLine"),l=document.querySelector("#horizontalLine"),s=0,d=0,h=function(n,i){Math.abs(n-(t.x+t.width))<=c&&(i.x=n-e.width,i.x+=(e.width-t.width)/2,s=2),Math.abs(n-(t.x+t.width/2))<=c&&(i.x=n-e.width/2,s=1),Math.abs(n-t.x)<=c&&(i.x=n,i.x-=(e.width-t.width)/2,s=0)},u=function(n,i){Math.abs(n-(t.y+t.height))<=c&&(i.y=n-e.height,i.y-=(t.height-e.height)/2,d=2),Math.abs(n-(t.y+t.height/2))<=c&&(i.y=n-e.height/2,d=1),Math.abs(n-t.y)<=c&&(i.y=n,i.y+=(t.height-e.height)/2,d=0)},p=function(n){if(a&&l){if(n.x!==e.x){var i=0;0===s&&(i=n.x+(e.width-t.width)/2),1===s&&(i=n.x+e.width/2),2===s&&(i=n.x+(e.width-t.width)/2+t.width),a.style.transform="translateX(".concat(i*o,"px)"),a.style.visibility="visible"}else a.style.visibility="hidden";if(n.y!==e.y){var r=0;0===d&&(r=n.y-(t.height-e.height)/2),1===d&&(r=n.y+e.height/2),2===d&&(r=n.y-(t.height-e.height)/2+t.height),l.style.transform="translateY(".concat(r*o,"px)"),l.style.visibility="visible"}else l.style.visibility="hidden"}};return{getRect:function(){return e},init:function(a,l,s,d,h){n=l,i=s,c=4/(o=d),r=h;var u=(e=a).rotate*Math.PI/180,p=Math.abs(e.width*Math.cos(u))+Math.abs(e.height*Math.sin(u)),b=Math.abs(e.height*Math.cos(u))+Math.abs(e.width*Math.sin(u));t.width=p,t.height=b,t.x=e.x+(e.width-p)/2,t.y=e.y-(b-e.height)/2},move:function(o){var c=o.x,a=o.y;e.x=c,e.y=a;var l={x:e.x,y:e.y};return t.x=e.x+(e.width-t.width)/2,t.y=e.y-(t.height-e.height)/2,i.forEach((function(e){var t=e.rotate*Math.PI/180,i=Math.abs(e.width*Math.cos(t))+Math.abs(e.height*Math.sin(t)),o=Math.abs(e.height*Math.cos(t))+Math.abs(e.width*Math.sin(t)),r=e.position.x+(e.width-i)/2,c=e.position.y-(o-e.height)/2;e.id!==n&&(h(r+i,l),h(r+i/2,l),h(r,l),u(c+o,l),u(c+o/2,l),u(c,l))})),h(r.width,l),h(r.width/2,l),h(0,l),u(r.height,l),u(r.height/2,l),u(0,l),p(l),l}}}(),g=f.getRect,x=f.init,j=f.move,v=function(e){var t=e.diff,n=Object(N.cloneDeep)(r),i=j({x:g().x+t.x/c,y:g().y+t.y/c});n.position=i,s(n),p(!0)},y=function(){document.querySelector("#verticalLine").style.visibility="hidden",document.querySelector("#horizontalLine").style.visibility="hidden",p(!1)};return Object(m.jsxs)(Ht,{style:{width:r.width,height:r.height,transform:"translate(".concat(r.position.x,"px, ").concat(r.position.y,"px) rotate(").concat(r.rotate,"deg)"),opacity:r.opacity,zIndex:r.zIndex},onMouseDown:function(e){e.stopPropagation(),r.isEditing||(d(r.id),b(!1),r.isLocked||(new Ue(e,v,y),x(Object(k.a)(Object(k.a)({},r.position),{},{width:r.width,height:r.height,rotate:r.rotate}),r.id,l,c,Object(k.a)({},a.global))))},onMouseEnter:function(e){e.stopPropagation(),h(r.id)},onMouseOut:function(e){e.stopPropagation(),h()},className:[u?"moving":"",r.isEditing?"edit":""].join(" "),children:[Object(m.jsx)(Xt,{style:{transform:"scale(".concat((null===(t=r.reverse)||void 0===t?void 0:t.x)||1,", ").concat((null===(n=r.reverse)||void 0===n?void 0:n.y)||1,")")},children:o}),r.isSelected&&Object(m.jsx)(wt,{children:Object(m.jsx)(rt,{info:r})}),!r.isSelected&&!u&&r.isHover&&Object(m.jsx)(wt,{children:Object(m.jsx)(jt,{info:r})})]})}));function wt(e){var t=e.children;return Object(r.createPortal)(t,document.querySelector("#layerControl"))}var At,Ct,kt,Lt,It,Mt,St,Et,Bt,Tt,zt,Dt,Rt,Ut,Nt,Ft,Pt,Yt,Kt,Wt,Qt,Jt,Vt,Zt,Ht=u.a.div(vt||(vt=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n  user-select: none;\n  cursor: default;\n\n  &.moving {\n    cursor: all-scroll;\n  }\n\n  &.edit {\n    cursor: text;\n  }\n"]))),Xt=u.a.div(yt||(yt=Object(a.a)(["\n  width: 100%;\n  height: 100%;\n  transition: transform 250ms;\n"]))),qt=(n(262),n(263),n(173)),Gt=n.n(qt),_t=Object(te.a)((function(e){var t,n=e.layer,o=Object(i.useRef)(null),r=J.setEditStatus,c=J.setLayer,a=J.needUpdateLayerHeight,l=J.setNeedUpdateLayerHeight,s=J.isMoving,d=Object(i.useContext)(ze),u=Object(i.useState)(null),p=Object(h.a)(u,2),b=p[0],f=p[1],g=null===(t=document.querySelector("#textControl"))||void 0===t?void 0:t.getBoundingClientRect(),x=Object(i.useCallback)((function(){if(b){var e=Object(N.cloneDeep)(n),t=b.getText();if(e.source.content=t,o.current){var i=o.current.getBoundingClientRect(),r=n.rotate%180*Math.PI/180,a=Math.abs((i.height-n.width*d*Math.sin(r))/Math.cos(r));if(a/d!==n.height){e.height=a/d;var l={x:i.left+i.width/2-g.left,y:i.top+i.height/2-g.top},s=l.x/d-n.width/2,h=(l.y-a/2)/d;e.position={x:s,y:h}}}c(e)}}),[b,n,c,d,g]);Object(i.useEffect)((function(){if(a&&o.current){var e=Object(N.cloneDeep)(n),t=o.current.getBoundingClientRect(),i=n.rotate%180*Math.PI/180,r=Math.abs((t.height-n.width*d*Math.sin(i))/Math.cos(i));if(r/d!==n.height){e.height=r/d;var s={x:t.left+t.width/2-g.left,y:t.top+t.height/2-g.top},h=s.x/d-n.width/2,u=(s.y-r/2)/d;e.position={x:h,y:u},c(e)}l(!1)}}),[g,n,a,d,c,l]),Object(i.useEffect)((function(){if(s&&o.current){var e=o.current.getBoundingClientRect(),t=n.rotate%180*Math.PI/180,i=Math.abs((e.height-n.width*d*Math.sin(t))/Math.cos(t));if(Math.abs(i/d-n.height)>1){var r=Object(N.cloneDeep)(n);r.height=i/d,c(r)}}}),[n,d,s,g,c]);return Object(i.useEffect)((function(){if(o.current&&!b){var e=new Gt.a(o.current);f(e)}}),[b]),Object(i.useEffect)((function(){b&&n.source.content&&b.getText()!==n.source.content&&b.setText(n.source.content)}),[b,n.source.content]),Object(i.useEffect)((function(){b&&(b.enable(n.isEditing),n.isEditing&&b.setSelection(0,1e3))}),[b,n.isEditing]),Object(i.useEffect)((function(){return b&&b.on("text-change",x),function(){null===b||void 0===b||b.off("text-change",x)}}),[b,x]),Object(m.jsx)($t,{style:{transform:"scale(".concat(n.scale,")"),width:"".concat(n.width/(n.scale||1),"px"),height:"".concat(n.height/(n.scale||1),"px")},children:Object(m.jsx)(en,{data:n.style,onDoubleClick:function(){r(n.id)},children:Object(m.jsx)(tn,{ref:o,spellCheck:"false"})})})})),$t=u.a.div(At||(At=Object(a.a)(["\n  transform-origin: 0 0;\n"]))),en=u.a.div({},(function(e){return{fontFamily:'"'.concat(e.data.font,'"'),fontSize:e.data.fontSize,color:e.data.color,lineHeight:e.data.lineHeight,textAlign:e.data.textAlign,fontWeight:e.data.fontWeight,textDecorationLine:e.data.underline?"underline":"none"}})),tn=u.a.div(Ct||(Ct=Object(a.a)(["\n  font-family: inherit;\n  font-size: inherit;\n\n  .ql-editor {\n    padding: 0;\n    overflow: visible;\n    font-family: inherit;\n    line-height: inherit;\n    text-align: inherit;\n    white-space: break-spaces;\n    /* user-select: text; */\n    line-break: anywhere;\n\n    &>* {\n      cursor: inherit;\n    }\n  }\n"]))),nn=Object(te.a)((function(e){var t,n,i,o,r=e.layer,c=J.setEditStatus;return Object(m.jsx)(on,{onDoubleClick:function(e){e.stopPropagation(),c(r.id)},children:Object(m.jsx)("div",{style:{position:"absolute",width:"".concat(null===(t=r.clip)||void 0===t?void 0:t.width,"px"),height:"".concat(null===(n=r.clip)||void 0===n?void 0:n.height,"px"),transform:"translate(-".concat(null===(i=r.clip)||void 0===i?void 0:i.left,"px, -").concat(null===(o=r.clip)||void 0===o?void 0:o.top,"px)")},children:Object(m.jsx)(rn,{src:r.source.imageUrl,draggable:"false"})})})})),on=u.a.div(kt||(kt=Object(a.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n"]))),rn=u.a.img(Lt||(Lt=Object(a.a)(["\n  width: 100%;\n  height: 100%;\n"]))),cn=n.p+"static/media/resize.771f2b8f.svg",an=n(184),ln=n(185),sn={},dn=Object(te.a)((function(e){var t,n,o,r,c,a,l,s,d,u,p,b,f=e.info,g=J.template,x=J.setLayer,j=J.resetEditStatus,v=Object(i.useContext)(ze),y=Object(i.useState)(f),O=Object(h.a)(y,2),w=O[0],A=O[1],C=function(e){e.stopPropagation(),x(w),j()};Object(i.useEffect)((function(){A(f)}),[f]);var k=function(e,t){var n=function(){if(e.clip){var t,n=e.clip.height-e.height-e.clip.bottom;if(n>=0)e.clip.top=n,e.clip.pre.top=n;else e.height=sn.height,e.position.y=null===(t=sn.position)||void 0===t?void 0:t.y}},i=function(){if(e.clip){var t,n=e.clip.width-e.width-e.clip.right;if(n>=0)e.clip.left=n,e.clip.pre.left=n;else e.width=sn.width,e.position.x=null===(t=sn.position)||void 0===t?void 0:t.x}},o=function(){if(e.clip){var t=e.clip.width-e.width-e.clip.left;t>=0?(e.clip.right=t,e.clip.pre.right=t):e.width=e.clip.width-e.clip.left}},r=function(){if(e.clip){var t=e.clip.height-e.height-e.clip.top;t>=0?(e.clip.bottom=t,e.clip.pre.bottom=t):e.height=e.clip.height-e.clip.top}};if(e.clip)switch(t){case S.BR:r(),o();break;case S.BL:r(),i();break;case S.TL:n(),i();break;case S.TR:n(),o()}return e},L=function(e,t){e.stopPropagation(),0===f.rotate?function(e,t){var n=Object(N.cloneDeep)(w);new Ue(e,(function(e){sn=Object(N.cloneDeep)(n);var i=Pe(n,t,e.diff,v,!1),o=k(i,t);A(Object.assign({},o))}),(function(){}))}(e,t):function(e,t){var n,i,o=Object(N.cloneDeep)(w),r=(o.position.x+o.width/2)*v,c=(o.position.y+o.height/2)*v,a=null===(n=e.target)||void 0===n?void 0:n.getBoundingClientRect(),l=null===(i=document.querySelector("#layerControl"))||void 0===i?void 0:i.getBoundingClientRect(),s={x:a.left-Number(l.left)+a.width/2,y:a.top-Number(l.top)+a.height/2},d={x:r-(s.x-r),y:c-(s.y-c)},h=o.width/o.height;new Ue(e,(function(e){var n=e.curCoords,i={x:n.x-Number(l.left),y:n.y-Number(l.top)};sn=Object(N.cloneDeep)(w);var r=Ye(t,i,d,s,o,w,h,v,!1),c=k(r,t);A(Object.assign({},c))}),(function(){}))}(e,t)};return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(vn,{id:"clipImageMask",onMouseDown:function(e){e.stopPropagation(),"clipImageMask"===e.target.id&&C(e)},children:Object(m.jsxs)(yn,{style:{width:g.global.width*v,height:g.global.height*v},children:[Object(m.jsx)(On,{style:{width:g.global.width,height:g.global.height,transform:"scale(".concat(v,")")},children:Object(m.jsx)(mn,{style:{width:w.width,height:w.height,transform:"translate(".concat(w.position.x,"px, ").concat(w.position.y,"px) rotate(").concat(w.rotate,"deg) scale(").concat((null===(t=w.reverse)||void 0===t?void 0:t.x)||1,", ").concat((null===(n=w.reverse)||void 0===n?void 0:n.y)||1,")")},children:Object(m.jsx)(wn,{children:Object(m.jsx)("div",{style:{position:"absolute",width:"".concat(null===(o=w.clip)||void 0===o?void 0:o.width,"px"),height:"".concat(null===(r=w.clip)||void 0===r?void 0:r.height,"px"),transform:"translate(-".concat(null===(c=w.clip)||void 0===c?void 0:c.left,"px, -").concat(null===(a=w.clip)||void 0===a?void 0:a.top,"px)")},children:Object(m.jsx)(An,{src:w.source.imageUrl,draggable:"false"})})})})}),Object(m.jsxs)(Cn,{style:{width:g.global.width*v,height:g.global.height*v},children:[Object(m.jsxs)(kn,{className:-1===(null===(l=w.reverse)||void 0===l?void 0:l.x)||-1===(null===(s=w.reverse)||void 0===s?void 0:s.y)?"hidden":"",style:{width:w.width*v,height:w.height*v,transform:"translate(".concat(w.position.x*v,"px, ").concat(w.position.y*v,"px) rotate(").concat(w.rotate,"deg)")},children:[-1!==(null===(d=w.reverse)||void 0===d?void 0:d.x)&&-1!==(null===(u=w.reverse)||void 0===u?void 0:u.y)&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Tn,{onMouseDown:function(e){return L(e,S.TL)},children:Object(m.jsx)("img",{src:cn,alt:""})}),Object(m.jsx)(zn,{onMouseDown:function(e){return L(e,S.TR)},children:Object(m.jsx)("img",{src:cn,alt:""})}),Object(m.jsx)(Dn,{onMouseDown:function(e){return L(e,S.BL)},children:Object(m.jsx)("img",{src:cn,alt:""})}),Object(m.jsx)(Rn,{onMouseDown:function(e){return L(e,S.BR)},children:Object(m.jsx)("img",{src:cn,alt:""})})]}),Object(m.jsx)(In,{}),Object(m.jsx)(Mn,{}),Object(m.jsx)(Sn,{}),Object(m.jsx)(En,{})]}),Object(m.jsx)(mn,{style:{width:w.width*v,height:w.height*v,transform:"translate(".concat(w.position.x*v,"px, ").concat(w.position.y*v,"px) rotate(").concat(w.rotate,"deg) scale(").concat((null===(p=w.reverse)||void 0===p?void 0:p.x)||1,", ").concat((null===(b=w.reverse)||void 0===b?void 0:b.y)||1,")")},onMouseDown:function(e){e.stopPropagation(),new Ue(e,(function(e){var t=e.diff,n=w.clip;if(n){var i,o,r,c,a=n.top-t.y/v*((null===(i=w.reverse)||void 0===i?void 0:i.y)||1),l=n.left-t.x/v*((null===(o=w.reverse)||void 0===o?void 0:o.x)||1),s=n.right+t.x/v*((null===(r=w.reverse)||void 0===r?void 0:r.x)||1),d=n.bottom+t.y/v*((null===(c=w.reverse)||void 0===c?void 0:c.y)||1);a>=0&&d>=0&&(n.top=a,n.bottom=d,n.pre.top=a,n.pre.bottom=d,A(Object.assign({},w))),s>=0&&l>=0&&(n.left=l,n.right=s,n.pre.left=l,n.pre.right=s,A(Object.assign({},w)))}}))},children:Object(m.jsx)(wn,{style:{overflow:"visible"},children:Object(m.jsx)("div",{style:{position:"absolute",width:"".concat(w.clip&&w.clip.width*v,"px"),height:"".concat(w.clip&&w.clip.height*v,"px"),transform:"translate(-".concat(w.clip&&w.clip.left*v,"px, -").concat(w.clip&&w.clip.top*v,"px)"),border:"2px dashed #00c4cc",cursor:"move"},children:Object(m.jsx)(An,{src:w.source.imageUrl,draggable:"false",style:{opacity:.5}})})})})]})]})}),Object(m.jsx)(hn,{children:Object(m.jsxs)(Un,{children:[Object(m.jsxs)(Nn,{onMouseDown:C,children:[Object(m.jsx)(an.a,{}),"\u5b8c\u6210"]}),Object(m.jsxs)(Nn,{onMouseDown:function(e){e.stopPropagation(),j()},children:[Object(m.jsx)(ln.a,{}),"\u53d6\u6d88"]})]})})]})}));function hn(e){var t=e.children;return Object(r.createPortal)(t,document.querySelector("#toolBar"))}var un,pn,bn,fn,gn,xn,jn,vn=u.a.div(It||(It=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(0,0,0,.3);\n"]))),yn=u.a.div(Mt||(Mt=Object(a.a)(["\n  flex: none;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  pointer-events: none;\n"]))),On=u.a.div(St||(St=Object(a.a)(["\n  flex: none;\n  position: relative;\n  overflow: visible;\n  background-color: transparent;\n  user-select: none;\n  pointer-events: none;\n"]))),mn=u.a.div(Et||(Et=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n  user-select: none;\n  cursor: default;\n\n  &.moving {\n    cursor: all-scroll;\n  }\n"]))),wn=u.a.div(Bt||(Bt=Object(a.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n"]))),An=u.a.img(Tt||(Tt=Object(a.a)(["\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n"]))),Cn=Object(u.a)(On)(zt||(zt=Object(a.a)(["\n position: absolute;\n top: 0;\n left: 0;\n"]))),kn=u.a.div(Dt||(Dt=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n  z-index: 1;\n\n  &.hidden {\n    &:after {\n      opacity: 0;\n    }\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    right: -1px;\n    bottom: -1px;\n    border: 2px solid #00c4cc;\n  }\n"]))),Ln=u.a.div(Rt||(Rt=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  background-color: #fff;\n"]))),In=Object(u.a)(Ln)(Ut||(Ut=Object(a.a)(["\n  left: 33%;\n  transform: scaleX(.7);\n"]))),Mn=Object(u.a)(Ln)(Nt||(Nt=Object(a.a)(["\n  left: 66%;\n  transform: scaleX(.7);\n"]))),Sn=Object(u.a)(Ln)(Ft||(Ft=Object(a.a)(["\n  top: 33%;\n  width: 100%;\n  height: 1px;\n  transform: scaleY(.7);\n"]))),En=Object(u.a)(Ln)(Pt||(Pt=Object(a.a)(["\n  top: 66%;\n  width: 100%;\n  height: 1px;\n  transform: scaleY(.7);\n"]))),Bn=u.a.span(Yt||(Yt=Object(a.a)(["\n  position: absolute;\n  display: block;\n  background: transparent;\n  z-index: 1;\n  pointer-events: auto;\n  width: 22px;\n  height: 22px;\n  user-select: none;\n\n  img {\n    width: 14px;\n    height: 14px;\n    pointer-events: none;\n  }\n"]))),Tn=Object(u.a)(Bn)(Kt||(Kt=Object(a.a)(["\n  top: -11px;\n  left: -11px;\n  transform: rotate(180deg);\n  cursor: nwse-resize;\n"]))),zn=Object(u.a)(Bn)(Wt||(Wt=Object(a.a)(["\n  top: -11px;\n  right: -11px;\n  transform: rotate(-90deg);\n  cursor: nesw-resize;\n"]))),Dn=Object(u.a)(Bn)(Qt||(Qt=Object(a.a)(["\n  left: -11px;\n  bottom: -11px;\n  transform: rotate(90deg);\n  cursor: nesw-resize;\n"]))),Rn=Object(u.a)(Bn)(Jt||(Jt=Object(a.a)(["\n  bottom: -11px;\n  right: -11px;\n  cursor: nwse-resize;\n"]))),Un=u.a.div(Vt||(Vt=Object(a.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  padding-left: 10px;\n  z-index: 1;\n  background-color: #fff;\n"]))),Nn=u.a.div(Zt||(Zt=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  margin-right: 10px;\n  padding: 4px 10px;\n  font-size: 16px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  span {\n    margin-right: 8px;\n  }\n"]))),Fn=Object(te.a)((function(e){var t,n,i,o,r=e.layer;return Object(m.jsx)(Pn,{style:{borderWidth:null===(t=r.rectInfo)||void 0===t?void 0:t.borderWidth,borderColor:null===(n=r.rectInfo)||void 0===n?void 0:n.borderColor,borderStyle:null===(i=r.rectInfo)||void 0===i?void 0:i.borderStyle,backgroundColor:null===(o=r.rectInfo)||void 0===o?void 0:o.fill}})})),Pn=u.a.div(un||(un=Object(a.a)(["\n  width: 100%;\n  height: 100%;\n  border-style: solid;\n"]))),Yn=Object(te.a)((function(e){var t,n,i,o,r=e.layer;return Object(m.jsx)(Kn,{style:{borderWidth:null===(t=r.circleInfo)||void 0===t?void 0:t.borderWidth,borderColor:null===(n=r.circleInfo)||void 0===n?void 0:n.borderColor,borderStyle:null===(i=r.circleInfo)||void 0===i?void 0:i.borderStyle,backgroundColor:null===(o=r.circleInfo)||void 0===o?void 0:o.fill}})})),Kn=u.a.div(pn||(pn=Object(a.a)(["\n  width: 100%;\n  height: 100%;\n  border-style: solid;\n  border-radius: 50%;\n"]))),Wn={x:0,y:0},Qn=Object(te.a)((function(){var e=J.template,t=J.layers,n=J.addLayer,o=J.resetSelectStatus,r=J.setLayerType,c=e.global,a=e.background,l=Object(i.useContext)(ze),s=Object(i.useContext)(De),d=s.isSelectedBackground,h=s.setIsSelectedBackground;return Object(m.jsxs)(ri,{width:c.width,height:c.height,scale:l,children:[Object(m.jsxs)(ci,{id:"canvasContent",style:{width:c.width,height:c.height,transform:"scale(".concat(l,")")},onDrop:function(e){e.preventDefault();var i=function(e,t){var n,i=null===(n=document.querySelector("#layerControl"))||void 0===n?void 0:n.getBoundingClientRect(),o=Wn.x-i.left,r=Wn.y-i.top;return{x:o/l-e/2,y:r/l-t/2}},r=function(e,r,c){var a=i(e,r),l=t.length?t[t.length-1].zIndex+1:1,s=ne(e,r,c,a,l);o(),n(s)};if(e.dataTransfer.files.length>0){var c=e.dataTransfer.files;if(!/image\//.test(c[0].type))return;var a=new FileReader;a.readAsDataURL(c[0]),a.onload=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;if("string"===typeof n){var i=new Image;i.src=n,i.onload=function(){r(i.width,i.height,n)}}}}else{var s,d,h,u=null;if(null===(s=e.dataTransfer)||void 0===s?void 0:s.getData("image"))try{var p;u=JSON.parse(null===(p=e.dataTransfer)||void 0===p?void 0:p.getData("image"))}catch(e){console.log(e)}u&&r(u.webformatWidth,u.webformatHeight,u.webformatURL),!!(null===(d=e.dataTransfer)||void 0===d?void 0:d.getData("rect"))&&function(){var e=200,r=200,c=i(e,r),a=t.length?t[t.length-1].zIndex+1:1,l=ie(e,r,c,a);o(),n(l)}(),!!(null===(h=e.dataTransfer)||void 0===h?void 0:h.getData("circle"))&&function(){var e=200,r=200,c=i(e,r),a=t.length?t[t.length-1].zIndex+1:1,l=oe(e,r,c,a);o(),n(l)}()}},onDragOver:function(e){e.preventDefault(),Wn.x=e.pageX,Wn.y=e.pageY},children:[Object(m.jsx)(oi,{color:a.color,onClick:function(e){e.stopPropagation(),h(!0),o(),r(M.BACKGROUND)}}),e.layers.map((function(e){return"image"===e.type?e.isEditing?Object(m.jsx)(Vn,{children:Object(m.jsx)(dn,{info:Object(R.q)(e)})},e.id):Object(m.jsx)(mt,{info:e,children:Object(m.jsx)(nn,{layer:Object(R.q)(e)})},e.id):"text"===e.type?e.isEditing?Object(m.jsx)(Jn,{children:Object(m.jsx)(mt,{info:e,children:Object(m.jsx)(_t,{layer:Object(R.q)(e)})})},e.id):Object(m.jsx)(mt,{info:e,children:Object(m.jsx)(_t,{layer:Object(R.q)(e)})},e.id):"rect"===e.type?Object(m.jsx)(mt,{info:e,children:Object(m.jsx)(Fn,{layer:Object(R.q)(e)})},e.id):"circle"===e.type?Object(m.jsx)(mt,{info:e,children:Object(m.jsx)(Yn,{layer:Object(R.q)(e)})},e.id):Object(m.jsx)(m.Fragment,{})}))]}),Object(m.jsxs)(li,{id:"layerControl",width:c.width,height:c.height,scale:l,children:[d&&Object(m.jsx)(si,{}),Object(m.jsx)(di,{id:"verticalLine"}),Object(m.jsx)(hi,{id:"horizontalLine"})]}),Object(m.jsx)(ai,{id:"textControl",style:{width:c.width,height:c.height,transform:"scale(".concat(l,")")}})]})}));function Jn(e){var t=e.children;return Object(r.createPortal)(t,document.querySelector("#textControl"))}function Vn(e){var t=e.children;return Object(r.createPortal)(t,document.querySelector("#editorContainer"))}var Zn,Hn,Xn,qn,Gn,_n,$n,ei,ti,ni,ii,oi=u.a.div({position:"relative",zIndex:-1,width:"100%",height:"100%"},(function(e){return{backgroundColor:e.color}})),ri=u.a.div({flex:"none",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"auto",pointerEvents:"none"},(function(e){return{width:e.width*e.scale+100,height:e.height*e.scale+100}})),ci=u.a.div(bn||(bn=Object(a.a)(["\n  flex: none;\n  position: relative;\n  overflow: hidden;\n  background-color: #fff;\n  user-select: none;\n  pointer-events: auto;\n"]))),ai=Object(u.a)(ci)(fn||(fn=Object(a.a)(["\n  position: absolute;\n  top: 50;\n  left: 50;\n  z-index: 1;\n  pointer-events: none;\n  overflow: visible;\n  background-color: transparent;\n"]))),li=u.a.div({position:"absolute",top:50,left:50,zIndex:2,pointerEvents:"none"},(function(e){return{width:e.width*e.scale,height:e.height*e.scale}})),si=u.a.div(gn||(gn=Object(a.a)(["\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n  background: transparent;\n  pointer-events: none;\n"]))),di=u.a.div(xn||(xn=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 0;\n  height: 100%;\n  border-left: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n"]))),hi=u.a.div(jn||(jn=Object(a.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 0;\n  border-top: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n"]))),ui=u.a.div(Zn||(Zn=Object(a.a)(['\n  display: flex;\n  align-items: center;\n  margin-right: 10px;\n  padding: 4px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &.active {\n    background-color: rgba(57,76,96,.15);\n  }\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  .text {\n    padding: 0 10px;\n    font-size: 16px;\n  }\n\n  input[type="search"] {\n    text-align: center;\n  }\n']))),pi=u.a.div(Hn||(Hn=Object(a.a)(["\n  width: 28px;\n  height: 28px;\n  border: 2px solid #666;\n  border-radius: 4px;\n"]))),bi=n(340),fi=n(341),gi=n(335),xi=[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft Yahei"},{name:"\u6977\u4f53",value:"KaiTi"},{name:"\u534e\u6587\u6977\u4f53",value:"STKaiti"},{name:"\u7fe9\u7fe9\u4f53-\u7b80",value:"Hanzipen SC"},{name:"\u5a03\u5a03\u4f53-\u7b80",value:"Wawati SC"},{name:"\u5706\u4f53-\u7b80",value:"Yuanti SC"},{name:"\u5170\u4ead\u9ed1-\u7b80",value:"Lantinghei SC"}],ji=[6,8,10,12,14,16,18,20,22,24,28,32,36,42,48,56,64,72,80,88,96,104,120,144],vi=[{width:1280,height:720,label:"1280px \xd7 720px",value:"1"},{width:720,height:1280,label:"720px \xd7 1280px",value:"2"},{width:1024,height:768,label:"1024px \xd7 768px",value:"3"},{width:768,height:1024,label:"768px \xd7 1024px",value:"4"},{width:1920,height:1080,label:"1920px \xd7 1080px",value:"5"}],yi=Object(te.a)((function(){var e=J.template,t=J.setCanvasSize,n=e.global.width,o=e.global.height,r=Object(i.useState)("1"),c=Object(h.a)(r,2),a=c[0],l=c[1];Object(i.useEffect)((function(){var e=vi.find((function(e){return e.width===n&&e.height===o&&e.value!==a}));e?l(e.value):"6"!==a&&l("6")}),[]);var s=Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(bi.a.Group,{onChange:function(e){l(e.target.value);var n=vi.find((function(t){return t.value===e.target.value}));n&&t({width:n.width,height:n.height})},value:a,children:Object(m.jsxs)(fi.b,{direction:"vertical",children:[vi.map((function(e){return Object(m.jsx)(bi.a,{value:e.value,children:e.label},e.value)})),Object(m.jsxs)(bi.a,{value:"6",children:["\u81ea\u5b9a\u4e49","6"===a?Object(m.jsxs)("div",{style:{marginTop:10},children:[Object(m.jsx)(gi.a,{value:n,size:"small",placeholder:"\u5bbd",style:{width:100,marginRight:10},onChange:function(e){Object(N.isNumber)(e)&&e>0&&t({width:e,height:o})}}),"\xd7",Object(m.jsx)(gi.a,{value:o,size:"small",placeholder:"\u9ad8",style:{width:100,marginLeft:10,marginRight:10},onChange:function(e){Object(N.isNumber)(e)&&e>0&&t({width:n,height:e})}})," \u50cf\u7d20"]}):null]})]})})});return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:s,trigger:"click",placement:"bottomLeft",children:Object(m.jsx)("span",{className:"text",children:"\u753b\u5e03\u5c3a\u5bf8"})})})})),Oi=n(342),mi=Object(te.a)((function(){var e=J.setLayers;return Object(m.jsx)(ui,{children:Object(m.jsx)(Oi.a,{placement:"bottomRight",title:"\u786e\u5b9a\u6e05\u7a7a\u753b\u5e03\uff1f",onConfirm:function(){e([])},okText:"\u6e05\u7a7a",cancelText:"\u53d6\u6d88",children:Object(m.jsx)("span",{className:"text",children:"\u6e05\u7a7a\u753b\u5e03"})})})})),wi=n(57),Ai=Object(te.a)((function(){var e=J.template,t=J.setBackgroundColor,n=e.background.color;return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:Object(m.jsx)(wi.a,{color:n,onChange:function(e){var n="rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")");t(n)}}),trigger:"click",placement:"bottomLeft",children:Object(m.jsx)(pi,{style:{backgroundColor:n}})})})})),Ci=Object(te.a)((function(){var e,t=J.activeLayer,n=J.setLayer,i=(null===t||void 0===t||null===(e=t.style)||void 0===e?void 0:e.color)||"";return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:Object(m.jsx)(wi.a,{color:i,onChange:function(e){var i="rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")"),o=Object(N.cloneDeep)(t);"text"===(null===o||void 0===o?void 0:o.type)&&o.style&&(o.style.color=i,n(o))}}),trigger:"click",placement:"bottomLeft",children:Object(m.jsx)(pi,{style:{backgroundColor:i}})})})})),ki=n(338),Li=ki.a.Option,Ii=Object(te.a)((function(){var e,t=J.activeLayer,n=J.setLayer,i=(null===t||void 0===t||null===(e=t.style)||void 0===e?void 0:e.font)||"";return Object(m.jsx)(ui,{children:Object(m.jsx)(ki.a,{value:i,style:{width:140},placeholder:"\u9009\u62e9\u5b57\u4f53",onChange:function(e){var i=Object(N.cloneDeep)(t);"text"===(null===i||void 0===i?void 0:i.type)&&i.style&&(i.style.font=e,n(i))},children:xi.map((function(e){return Object(m.jsx)(Li,{value:e.value,children:Object(m.jsx)("span",{style:{fontFamily:e.value},children:e.name})},e.value)}))})})})),Mi=ki.a.Option,Si=Object(te.a)((function(){var e,t=J.activeLayer,n=J.setLayer,i=J.setNeedUpdateLayerHeight,o=(null===t||void 0===t?void 0:t.scale)||1,r=(null===t||void 0===t||null===(e=t.style)||void 0===e?void 0:e.fontSize)||0;return Object(m.jsx)(ui,{children:Object(m.jsx)(ki.a,{value:(r*o).toFixed(0),style:{width:100,textAlign:"center"},placeholder:"\u5b57\u4f53\u5927\u5c0f",onChange:function(e){var r=Number(e);if(!isNaN(r)){var c=Object(N.cloneDeep)(t);"text"===(null===c||void 0===c?void 0:c.type)&&c.style&&(c.style.fontSize=r/o,n(c),i(!0))}},children:ji.map((function(e){return Object(m.jsx)(Mi,{value:e,children:e},e)}))})})})),Ei=n(345),Bi=Object(te.a)((function(){var e,t=J.activeLayer,n=J.setLayer,i=(null===t||void 0===t||null===(e=t.style)||void 0===e?void 0:e.fontWeight)||400;return Object(m.jsx)(ui,{className:700===i?"active":"",onClick:function(){var e=Object(N.cloneDeep)(t);"text"===(null===e||void 0===e?void 0:e.type)&&e.style&&(e.style.fontWeight=700===e.style.fontWeight?400:700,n(e))},children:Object(m.jsx)(Ei.a,{style:{fontSize:24}})})})),Ti=n(346),zi=Object(te.a)((function(){var e,t=J.activeLayer,n=J.setLayer,i=(null===t||void 0===t||null===(e=t.style)||void 0===e?void 0:e.underline)||!1;return Object(m.jsx)(ui,{className:i?"active":"",onClick:function(){var e=Object(N.cloneDeep)(t);"text"===(null===e||void 0===e?void 0:e.type)&&e.style&&(e.style.underline=!e.style.underline,n(e))},children:Object(m.jsx)(Ti.a,{style:{fontSize:24}})})})),Di=n(347),Ri=n(348),Ui=n(349),Ni=Object(te.a)((function(){var e,t=J.activeLayer,n=J.setLayer,i=(null===t||void 0===t||null===(e=t.style)||void 0===e?void 0:e.textAlign)||"left";return Object(m.jsxs)(ui,{onClick:function(){var e="left";"left"===i&&(e="center"),"center"===i&&(e="right"),"right"===i&&(e="left");var o=Object(N.cloneDeep)(t);"text"===(null===o||void 0===o?void 0:o.type)&&o.style&&(o.style.textAlign=e,n(o))},children:["left"===i&&Object(m.jsx)(Di.a,{style:{fontSize:24}}),"center"===i&&Object(m.jsx)(Ri.a,{style:{fontSize:24}}),"right"===i&&Object(m.jsx)(Ui.a,{style:{fontSize:24}})]})})),Fi=n(343),Pi=n(336),Yi=n(350),Ki=Object(te.a)((function(){var e=J.activeLayer,t=J.setLayer,n=function(n){var i=Object(N.cloneDeep)(e);(null===i||void 0===i?void 0:i.reverse)&&("x"===n&&(i.reverse.x=1===i.reverse.x?-1:1),"y"===n&&(i.reverse.y=1===i.reverse.y?-1:1),t(i))};return Object(m.jsx)(ui,{children:Object(m.jsx)(Fi.a,{overlay:Object(m.jsxs)(Pi.a,{style:{width:120},children:[Object(m.jsx)(Pi.a.Item,{style:{padding:"20px"},icon:Object(m.jsx)(Yi.a,{}),onClick:function(){return n("x")},children:"\u6c34\u5e73\u7ffb\u8f6c"},"x"),Object(m.jsx)(Pi.a.Item,{style:{padding:"20px"},icon:Object(m.jsx)(Yi.a,{style:{transform:"rotate(90deg)"}}),onClick:function(){return n("y")},children:"\u5782\u76f4\u7ffb\u8f6c"},"y")]}),trigger:["click"],children:Object(m.jsx)("span",{className:"text",children:"\u7ffb\u8f6c"})})})})),Wi=Object(te.a)((function(){var e=J.activeLayer,t=J.setEditStatus;return Object(m.jsx)(ui,{onClick:function(){t((null===e||void 0===e?void 0:e.id)||"")},children:Object(m.jsx)("span",{className:"text",children:"\u88c1\u526a"})})})),Qi=Object(te.a)((function(){var e=J.layerType,t=J.activeLayer,n=J.setLayer,i={};e===M.CIRCLE?i=null===t||void 0===t?void 0:t.circleInfo:e===M.RECT&&(i=null===t||void 0===t?void 0:t.rectInfo);return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:Object(m.jsx)(wi.a,{color:i.fill,onChange:function(i){var o="rgba(".concat(i.rgb.r,", ").concat(i.rgb.g,", ").concat(i.rgb.b,", ").concat(i.rgb.a,")");if(e===M.RECT){var r=Object(N.cloneDeep)(t);(null===r||void 0===r?void 0:r.rectInfo)&&(r.rectInfo.fill=o,n(r))}if(e===M.CIRCLE){var c=Object(N.cloneDeep)(t);(null===c||void 0===c?void 0:c.circleInfo)&&(c.circleInfo.fill=o,n(c))}}}),trigger:"click",placement:"bottomLeft",children:Object(m.jsx)(pi,{style:{backgroundColor:i.fill}})})})})),Ji=Object(te.a)((function(){var e=J.layerType,t=J.activeLayer,n=J.setLayer,i={};e===M.CIRCLE?i=null===t||void 0===t?void 0:t.circleInfo:e===M.RECT&&(i=null===t||void 0===t?void 0:t.rectInfo);return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:Object(m.jsx)(wi.a,{color:i.borderColor,onChange:function(i){var o="rgba(".concat(i.rgb.r,", ").concat(i.rgb.g,", ").concat(i.rgb.b,", ").concat(i.rgb.a,")");if(e===M.RECT){var r=Object(N.cloneDeep)(t);(null===r||void 0===r?void 0:r.rectInfo)&&(r.rectInfo.borderColor=o,n(r))}if(e===M.CIRCLE){var c=Object(N.cloneDeep)(t);(null===c||void 0===c?void 0:c.circleInfo)&&(c.circleInfo.borderColor=o,n(c))}}}),trigger:"click",placement:"bottomLeft",children:Object(m.jsx)(pi,{style:{backgroundColor:i.borderColor}})})})})),Vi=n.p+"static/media/border-weight.505b2f5f.svg",Zi=Object(te.a)((function(){var e=J.layerType,t=J.activeLayer,n=J.setLayer,i={};e===M.CIRCLE?i=null===t||void 0===t?void 0:t.circleInfo:e===M.RECT&&(i=null===t||void 0===t?void 0:t.rectInfo);return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:Object(m.jsx)(Ce.a,{value:i.borderWidth,min:0,max:50,step:1,style:{width:180},onChange:function(i){if(e===M.RECT){var o=Object(N.cloneDeep)(t);(null===o||void 0===o?void 0:o.rectInfo)&&(o.rectInfo.borderWidth=i,n(o))}if(e===M.CIRCLE){var r=Object(N.cloneDeep)(t);(null===r||void 0===r?void 0:r.circleInfo)&&(r.circleInfo.borderWidth=i,n(r))}}}),trigger:"click",placement:"bottomRight",children:Object(m.jsx)("img",{src:Vi,width:"24",height:"24",alt:""})})})})),Hi=n.p+"static/media/border-style.11c5ec46.svg",Xi=Object(te.a)((function(){var e=J.layerType,t=J.activeLayer,n=J.setLayer,i=function(i){if(e===M.RECT){var o=Object(N.cloneDeep)(t);(null===o||void 0===o?void 0:o.rectInfo)&&(o.rectInfo.borderStyle=i,n(o))}if(e===M.CIRCLE){var r=Object(N.cloneDeep)(t);(null===r||void 0===r?void 0:r.circleInfo)&&(r.circleInfo.borderStyle=i,n(r))}};return Object(m.jsx)(ui,{children:Object(m.jsx)(Fi.a,{overlay:Object(m.jsxs)(Pi.a,{style:{width:120},children:[Object(m.jsx)(Pi.a.Item,{style:{padding:"20px 10px"},onClick:function(){return i("solid")},children:Object(m.jsx)(qi,{})},"1"),Object(m.jsx)(Pi.a.Item,{style:{padding:"20px 10px"},onClick:function(){return i("dashed")},children:Object(m.jsx)(Gi,{})},"2"),Object(m.jsx)(Pi.a.Item,{style:{padding:"20px 10px"},onClick:function(){return i("dotted")},children:Object(m.jsx)(_i,{})},"3")]}),trigger:["click"],children:Object(m.jsx)("img",{src:Hi,width:"24",height:"24",alt:""})})})})),qi=u.a.div(Xn||(Xn=Object(a.a)(["\n  width: 100%;\n  height: 0;\n  border-top: 4px solid #000;\n"]))),Gi=u.a.div(qn||(qn=Object(a.a)(["\n  width: 100%;\n  height: 0;\n  border-top: 4px dashed #000;\n"]))),_i=u.a.div(Gn||(Gn=Object(a.a)(["\n  width: 100%;\n  height: 0;\n  border-top: 4px dotted #000;\n"]))),$i=Object(te.a)((function(){var e=J.activeLayer,t=J.layers,n=J.setLayerLevel,i=J.setLayers,o={min:1,max:100,current:1};e&&(o.current=t.findIndex((function(t){return t.id===e.id}))+1,o.max=t.length);return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:Object(m.jsx)(Ce.a,{value:o.current,min:o.min,max:o.max,style:{width:180},onChange:function(r){r>o.current?(t.forEach((function(e,t){t+1>o.current&&t+1<=r&&n(e.id,e.zIndex-1)})),e&&n(e.id,e.zIndex+(r-o.current))):(t.forEach((function(e,t){t+1>=r&&t+1<o.current&&n(e.id,e.zIndex+1)})),e&&n(e.id,e.zIndex-(o.current-r))),i(Object(N.cloneDeep)(t).sort((function(e,t){return e.zIndex-t.zIndex})))}}),trigger:"click",placement:"bottomRight",children:Object(m.jsx)("span",{className:"text",children:"\u5c42\u7ea7\u8c03\u6574"})})})})),eo=n.p+"static/media/opacity.6dad8d31.svg",to=Object(te.a)((function(){var e=J.activeLayer,t=J.setLayer,n=null===e||void 0===e?void 0:e.opacity;return Object(m.jsx)(ui,{children:Object(m.jsx)(D.a,{content:Object(m.jsx)(Ce.a,{value:n,min:0,max:1,step:.01,style:{width:180},onChange:function(n){var i=Object(N.cloneDeep)(e);i&&(i.opacity=n,t(i))}}),trigger:"click",placement:"bottomRight",children:Object(m.jsx)("img",{src:eo,width:"24",height:"24",alt:""})})})})),no=n(351),io=n(352),oo=Object(te.a)((function(){var e=J.activeLayer,t=J.setLayerLock,n=(null===e||void 0===e?void 0:e.isLocked)||!1;return Object(m.jsx)(ui,{className:["item-lock",n?"active":""].join(" "),onClick:function(){e&&t(e.id,!e.isLocked)},children:n?Object(m.jsx)(no.a,{style:{fontSize:24}}):Object(m.jsx)(io.a,{style:{fontSize:24}})})})),ro=n(353),co=Object(te.a)((function(){var e=J.activeLayer,t=J.removeLayer;return Object(m.jsx)(ui,{onClick:function(){e&&t(e.id)},children:Object(m.jsx)(ro.a,{style:{fontSize:24}})})})),ao=Object(te.a)((function(){var e=J.layerType,t=J.activeLayer,n=(null===t||void 0===t?void 0:t.isLocked)||!1;return Object(m.jsxs)(lo,{id:"toolBar",children:[Object(m.jsxs)(so,{className:n?"locked":"",children:[[M.EMPTY].includes(e)&&Object(m.jsx)(yi,{}),[M.BACKGROUND].includes(e)&&Object(m.jsx)(Ai,{}),[M.TEXT].includes(e)&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Ci,{}),Object(m.jsx)(Ii,{}),Object(m.jsx)(Si,{}),Object(m.jsx)(Bi,{}),Object(m.jsx)(zi,{}),Object(m.jsx)(Ni,{})]}),[M.IMAGE].includes(e)&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Ki,{}),Object(m.jsx)(Wi,{})]}),[M.RECT,M.CIRCLE].includes(e)&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Qi,{}),Object(m.jsx)(Ji,{}),Object(m.jsx)(Zi,{}),Object(m.jsx)(Xi,{})]})]}),Object(m.jsxs)(so,{className:n?"locked":"",children:[[M.IMAGE,M.TEXT,M.RECT,M.CIRCLE].includes(e)&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)($i,{}),Object(m.jsx)(to,{}),Object(m.jsx)(oo,{}),Object(m.jsx)(co,{})]}),[M.EMPTY].includes(e)&&Object(m.jsx)(mi,{})]})]})})),lo=u.a.div(_n||(_n=Object(a.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  height: 46px;\n  padding: 0 10px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n  user-select: none;\n"]))),so=u.a.div($n||($n=Object(a.a)(["\n  display: flex;\n  align-items: center;\n\n  &.locked>div:not(.item-lock) {\n    display: none;\n  }\n"]))),ho=K(),uo=ho.undo,po=ho.redo,bo={},fo=Object(te.a)((function(){var e=Object(i.useState)(1),t=Object(h.a)(e,2),n=t[0],o=t[1],r=Object(i.useRef)(null),c=J.template,a=J.resetSelectStatus,l=J.removeLayer,s=J.addLayer,d=Object(i.useState)(!1),u=Object(h.a)(d,2),p=u[0],b=u[1],f=Object(i.useCallback)((function(){var e=r.current,t=c.global.width,n=c.global.height,i=1;e&&e.clientWidth<t+100&&(i=(e.clientWidth-100)/t),e&&e.clientHeight<n*i+100&&(i=(e.clientHeight-100)/n),o(i)}),[c.global.height,c.global.width]);Object(i.useEffect)((function(){f()}),[f]);var g=Object(i.useCallback)((function(e){if(document.activeElement===document.body||null===document.activeElement){if("Backspace"===e.key||"Delete"===e.key){var t=c.layers.find((function(e){return e.isSelected}));t&&l(t.id)}if("c"===e.key&&(e.metaKey||e.ctrlKey)){var n=c.layers.find((function(e){return e.isSelected}));!n||c.layers.some((function(e){return e.isEditing}))||n.isLocked||(bo=Object(N.cloneDeep)(n))}"v"===e.key&&(e.metaKey||e.ctrlKey)&&(c.layers.some((function(e){return e.isEditing}))||bo.id&&(bo.position&&(bo.position.x+=10),bo.position&&(bo.position.y+=10),bo.id=String(Date.now()),bo.zIndex=c.layers.length?c.layers[c.layers.length-1].zIndex+1:1,a(),s(bo))),"z"!==e.key||!e.metaKey&&!e.ctrlKey||e.shiftKey||uo(),"z"===e.key&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&po()}}),[s,l,a,c.layers]);Object(i.useEffect)((function(){return document.addEventListener("keydown",g),function(){document.removeEventListener("keydown",g)}}),[g]);return Object(m.jsxs)(go,{children:[Object(m.jsx)(ao,{}),Object(m.jsx)(xo,{ref:r,children:Object(m.jsx)(jo,{id:"editorContainer",onMouseDown:function(e){"editorContainer"===e.target.id&&(a(),b(!1))},children:Object(m.jsx)(De.Provider,{value:{isSelectedBackground:p,setIsSelectedBackground:b},children:Object(m.jsx)(ze.Provider,{value:n,children:Object(m.jsx)(Qn,{})})})})}),Object(m.jsx)(Me,{scale:n,setScale:function(e){return o(e)},responsive:f})]})})),go=u.a.div(ei||(ei=Object(a.a)(["\n  position: relative;\n  flex: 1;\n  overflow: hidden;\n"]))),xo=u.a.div(ti||(ti=Object(a.a)(["\n  position: relative;\n  width: 100%;\n  height: calc(100% - 88px);\n  overflow: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #eef2f8;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n"]))),jo=u.a.div(ni||(ni=Object(a.a)(["\n  position: absolute;\n  display: flex;\n  align-items: center;\n  min-width: 100%;\n  min-height: 100%;\n"])));function vo(){return Object(m.jsxs)(yo,{children:[Object(m.jsx)(je,{}),Object(m.jsx)(fo,{})]})}var yo=u.a.main(ii||(ii=Object(a.a)(["\n  display: flex;\n  height: calc(100vh - 56px);\n  background-color: #eef2f8;\n  overflow: hidden;\n"])));n(327);var Oo=function(){return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(w,{}),Object(m.jsx)(vo,{})]})},mo=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,354)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),i(e),o(e),r(e),c(e)}))};n(328);c.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(Oo,{})}),document.getElementById("root")),mo()}},[[329,1,2]]]);
//# sourceMappingURL=main.c179c10b.chunk.js.map