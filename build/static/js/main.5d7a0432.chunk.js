(this["webpackJsonpvisual-editor"]=this["webpackJsonpvisual-editor"]||[]).push([[0],{185:function(e,t,n){},322:function(e,t,n){},324:function(e,t,n){"use strict";n.r(t);var i,o,a=n(0),r=n.n(a),c=n(31),s=n.n(c),l=(n(185),n(13)),d=n(11),h=n(3);function u(){return Object(h.jsx)(b,{children:Object(h.jsx)(x,{src:"/logo.png"})})}var b=d.a.header(i||(i=Object(l.a)(["\n  height: 56px;\n  display: flex;\n  align-items: center;\n  padding-left: 20px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n"]))),x=d.a.img(o||(o=Object(l.a)(["\n  width: 48px;\n  height: 48px;\n  object-fit: cover;\n"]))),f=n(39),p=n(53),g=n(162),y=n.n(g).a.create({baseURL:"https://pixabay.com/api",timeout:1e4});y.interceptors.response.use((function(e){return e.data}));var j,v=y,O=n(334),m=n(339),w=n(333),k=n(328),A=n(47),M=n(10),C={global:{width:1280,height:720},background:{color:"#fff"},layers:[{id:"1",type:"image",width:510,height:340,position:{x:100,y:100},rotate:0,reverse:{x:1,y:1},source:{imageUrl:"https://cdn.pixabay.com/photo/2014/04/13/20/49/cat-323262__340.jpg"},zIndex:1},{id:"2",type:"text",width:380,height:72,position:{x:100,y:500},rotate:0,source:{content:"\u53cc\u51fb\u7f16\u8f91\u6587\u5b57"},style:{font:"Microsoft Yahei",fontSize:60,lineHeight:1.2,color:"#000",textAlign:"left",fontWeight:400,underline:!1},zIndex:2}]};!function(e){e.EMPTY="empty",e.IMAGE="image",e.TEXT="text",e.BACKGROUND="background"}(j||(j={}));var E=n(24),L=[],S=0,z=!1;function T(){var e=R.setCanUseUndo,t=R.setCanUseRedo;return{init:function(e){L.push(e)},pushHistory:function(){if(z)z=!1;else{var n=Object(E.cloneDeep)(R.template);n.layers=n.layers.map((function(e){return e.isSelected=!1,e.isEditing=!1,e.isHover=!1,e})),S++,L[S]=n,L.splice(S+1,L.length),e(!0),t(!1),L.length>100&&(L.shift(),S--)}},undo:function(){if(L[S-1]){z=!0,S--;var n=L[S];R.setTemplate(Object(E.cloneDeep)(n)),R.setLayerType(j.EMPTY),t(!0),L[S-1]||e(!1)}},redo:function(){if(L[S+1]){z=!0,S++;var n=L[S];R.setTemplate(Object(E.cloneDeep)(n)),R.setLayerType(j.EMPTY),e(!0),L[S+1]||t(!1)}}}}var I=Object.assign(C,{layers:C.layers.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{isSelected:!1,isEditing:!1,isHover:!1,isLocked:!1,scale:1})}))}),B=localStorage.getItem("TEMPLATE");B&&(I=JSON.parse(B));var R=Object(M.n)({template:I,layerType:j.EMPTY,needUpdateLayerHeight:!1,isMoving:!1,canUseUndo:!1,canUseRedo:!1,get layers(){return this.template.layers},getTemplate:function(){var e=Object(E.cloneDeep)(R.template);return e.layers=e.layers.map((function(e){return"text"===e.type&&e.style&&e.scale&&(e.style.fontSize*=e.scale),delete e.isSelected,delete e.isEditing,delete e.scale,e})),e},setTemplate:function(e){this.template=e},setCanvasSize:function(e){this.template.global.width=e.width,this.template.global.height=e.height},setLayers:function(e){this.template.layers=e},setLayer:function(e){var t=this.layers.findIndex((function(t){return t.id===e.id}));t>-1&&!this.layers[t].isLocked&&(this.layers[t]=e)},addLayer:function(e){this.layers.push(e),"image"===e.type?this.setLayerType(j.IMAGE):"text"===e.type&&this.setLayerType(j.TEXT)},removeLayer:function(e){var t=this.layers.findIndex((function(t){return t.id===e}));t>-1&&!this.layers[t].isLocked&&(this.layers.splice(t,1),this.setLayerType(j.EMPTY))},setLayerLevel:function(e,t){var n=this.layers.findIndex((function(t){return t.id===e}));n>-1&&(this.layers[n].zIndex=t)},selectLayer:function(e){var t=this;this.layers.forEach((function(n){n.isSelected=n.id===e,n.isSelected&&("image"===n.type?t.setLayerType(j.IMAGE):"text"===n.type&&t.setLayerType(j.TEXT))})),document.dispatchEvent(new Event("mousedown"))},hoverLayer:function(e){this.layers.forEach((function(t){t.isHover=!!e&&t.id===e}))},setLayerType:function(e){this.layerType=e},editTextLayer:function(e){this.layers.some((function(t){return t.id===e&&t.isLocked}))||this.layers.forEach((function(t){t.isEditing=t.id===e}))},setLayerLock:function(e,t){var n=this.layers.findIndex((function(t){return t.id===e}));n>-1&&(this.layers[n].isLocked=t,this.layers[n].isEditing=!1)},resetSelectStatus:function(){this.layers.forEach((function(e){e.isSelected=!1})),this.setLayerType(j.EMPTY)},resetEditStatus:function(){this.layers.forEach((function(e){e.isEditing=!1}))},setBackgroundColor:function(e){this.template.background.color=e},setNeedUpdateLayerHeight:function(e){this.needUpdateLayerHeight=e},setIsMoving:function(e){this.isMoving=e},setCanUseUndo:function(e){this.canUseUndo=e},setCanUseRedo:function(e){this.canUseRedo=e}},{setTemplate:M.f.bound,getTemplate:M.f.bound,setCanvasSize:M.f.bound,setLayers:M.f.bound,setLayer:M.f.bound,addLayer:M.f.bound,removeLayer:M.f.bound,selectLayer:M.f.bound,setLayerLevel:M.f.bound,hoverLayer:M.f.bound,setLayerType:M.f.bound,editTextLayer:M.f.bound,setLayerLock:M.f.bound,resetSelectStatus:M.f.bound,resetEditStatus:M.f.bound,setBackgroundColor:M.f.bound,setNeedUpdateLayerHeight:M.f.bound,setIsMoving:M.f.bound,setCanUseUndo:M.f.bound,setCanUseRedo:M.f.bound});Object(M.o)((function(){return R.layers.map((function(e){return e.isSelected})).join("")}),(function(){R.resetEditStatus();var e=R.layers.findIndex((function(e){var t;return"text"===e.type&&!(null===(t=e.source.content)||void 0===t?void 0:t.replaceAll(/\n/g,""))}));e>-1&&R.removeLayer(R.layers[e].id)}));var D=T(),U=D.init,N=D.pushHistory;U(I);Object(M.o)((function(){var e=Object(E.cloneDeep)(R.template);return e.layers=e.layers.map((function(e){return delete e.isSelected,delete e.isEditing,delete e.isHover,e})),JSON.stringify(e)}),(function(){!function(){var e=Object(E.cloneDeep)(R.template);e.layers=e.layers.map((function(e){return e.isSelected=!1,e.isEditing=!1,e.isHover=!1,e})),localStorage.setItem("TEMPLATE",JSON.stringify(e))}(),N()}),{delay:500});var P,K,W,Y,H=n(30),F=Object(H.a)((function(e){var t=e.image,n=R.template,i=R.layers,o=R.addLayer,a=R.resetSelectStatus;return Object(h.jsx)(G,{style:{flexBasis:"".concat(100*t.webformatWidth/t.webformatHeight,"px")},onClick:function(){var e={id:String(Date.now()),type:"image",width:t.webformatWidth,height:t.webformatHeight,position:{x:(n.global.width-t.webformatWidth)/2,y:(n.global.height-t.webformatHeight)/2},rotate:0,reverse:{x:1,y:1},source:{imageUrl:t.webformatURL},zIndex:i.length?i[i.length-1].zIndex+1:1,isSelected:!0,isEditing:!1,isLocked:!1,scale:1};a(),o(e)},children:Object(h.jsx)("img",{src:t.webformatURL,alt:""})})})),G=d.a.div(P||(P=Object(l.a)(["\n  position: relative;\n  margin: 0 10px 10px 0;\n  background-color: #f0f1f4;\n  overflow: hidden;\n  flex-grow: 1;\n\n  img {\n    min-width: 100%;\n    height: 100px;\n    object-fit: cover;\n  }\n"]))),X=Object(H.a)((function(){var e=R.template,t=R.layers,n=R.addLayer,i=R.resetSelectStatus,o=R.editTextLayer;return Object(h.jsx)(A.a,{size:"large",style:{width:"100%"},onClick:function(){var a={id:String(Date.now()),type:"text",width:380,height:72,position:{x:(e.global.width-300)/2,y:(e.global.height-72)/2},rotate:0,source:{content:"\u53cc\u51fb\u7f16\u8f91\u6587\u5b57"},style:{font:"\u5fae\u8f6f\u96c5\u9ed1",fontSize:60,lineHeight:1.2,color:"#000",textAlign:"left",fontWeight:400,underline:!1},zIndex:t.length?t[t.length-1].zIndex+1:1,isSelected:!0,isEditing:!0,isLocked:!1,scale:1};i(),n(a),o(a.id)},children:"\u6dfb\u52a0\u6587\u672c"})})),Q=Object(H.a)((function(){var e=R.template,t=R.layers,n=R.addLayer,i=R.resetSelectStatus,o=function(o,a,r){var c={id:String(Date.now()),type:"image",width:o,height:a,position:{x:(e.global.width-o)/2,y:(e.global.height-a)/2},rotate:0,reverse:{x:1,y:1},source:{imageUrl:r},zIndex:t.length?t[t.length-1].zIndex+1:1,isSelected:!0,isEditing:!1,isLocked:!1,scale:1};i(),n(c)};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(q,{htmlFor:"uploadImage",children:Object(h.jsx)(A.a,{size:"large",children:"\u9009\u62e9\u672c\u5730\u56fe\u7247"})}),Object(h.jsx)("input",{type:"file",id:"uploadImage",accept:"image/*",style:{display:"none"},onChange:function(e){var t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;if("string"===typeof n){var i=new Image;i.src=n,i.onload=function(){o(i.width,i.height,n)}}}}})]})})),q=d.a.label(K||(K=Object(l.a)(["\n  display: block;\n  width: 100%;\n  margin-bottom: 16px;\n  cursor: pointer;\n\n  button {\n    width: 100%;\n    pointer-events: none;\n  }\n"]))),V=O.a.Panel,J=w.a.Search,Z=!1,_=!1;function $(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)({page:1,per_page:20,image_type:"all",q:"",orientation:"all",safesearch:!0}),r=Object(f.a)(o,2),c=r[0],s=r[1],l=Object(a.useState)(!1),d=Object(f.a)(l,2),u=d[0],b=d[1];Object(a.useEffect)((function(){var e;(e=c,v({url:"/",params:Object(p.a)({key:"24178889-8dbe9fccf0c585814c1dcb342",lang:"zh"},e)})).then((function(e){i(_?function(t){return t.concat(e.hits)}:e.hits)})).finally((function(){Z=!1}))}),[c]);return Object(h.jsx)(oe,{children:Object(h.jsxs)(O.a,{defaultActiveKey:["1"],collapsible:"header",children:[Object(h.jsx)(V,{header:Object(h.jsx)("div",{style:{width:"300px"},children:"\u56fe\u7247"}),extra:function(){var e=function(e,t){t.preventDefault(),e&&(_=!1,s(Object.assign({},c,{q:e,page:1})))};return Object(h.jsx)(k.a,{content:function(){return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(J,{placeholder:"\u641c\u7d22",onSearch:e,style:{width:200}})})},title:"\u7b5b\u9009",trigger:"click",visible:u,onVisibleChange:function(e){return b(e)},children:Object(h.jsx)(m.a,{onClick:function(e){e.stopPropagation(),b(!0)}})})}(),children:Object(h.jsxs)(ae,{children:[Object(h.jsx)(Q,{}),n.map((function(e){return Object(h.jsx)(F,{image:e},e.id)})),Object(h.jsx)(A.a,{style:{width:"100%",marginTop:"20px"},onClick:function(){if(!Z){Z=!0;var e=c.page;_=!0,s(Object.assign({},c,{page:e?e+1:1}))}},children:"\u52a0\u8f7d\u66f4\u591a"})]})},"1"),Object(h.jsx)(V,{header:Object(h.jsx)("div",{style:{width:"300px"},children:"\u6587\u5b57"}),children:Object(h.jsx)(ae,{children:Object(h.jsx)(X,{})})},"2")]})})}var ee,te,ne,ie,oe=d.a.aside(W||(W=Object(l.a)(["\n  flex: none;\n  display: flex;\n  flex-direction: column;\n  width: 400px;\n  height: 100%;\n  background-color: #fff;\n  border-right: 1px solid #ddd;\n  overflow-y: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #fff;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #fff;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n\n  .ant-collapse {\n    border: 0;\n    background-color: #fff;\n  }\n"]))),ae=d.a.div(Y||(Y=Object(l.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  padding-left: 10px;\n  user-select: none;\n\n  &:after {\n    content: '';\n    display: block;\n    flex-grow: 99999;\n  }\n"]))),re=n(329),ce=T(),se=ce.undo,le=ce.redo,de=Object(H.a)((function(e){var t=e.scale,n=e.setScale,i=R.canUseUndo,o=R.canUseRedo;return Object(h.jsxs)(he,{children:[Object(h.jsxs)(ue,{children:[Object(h.jsx)(re.a,{className:"slider",tipFormatter:null,defaultValue:100*t,min:10,max:500,onChange:function(e){n(e/100)}}),Object(h.jsxs)("div",{className:"scale",children:[Math.round(100*t),"%"]})]}),Object(h.jsxs)(be,{children:[Object(h.jsx)(xe,{className:i?"active":"",onClick:se,children:Object(h.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArRJREFUWEfFl09rE1EQwGfyB/SgKOjBQz1IIeBBEPsB6tFL8uZBCiIIgiiKigcpiKDtwYJ4kFpQiAh68WDovrdRWMGDfoAW9KBURRCUigoe9BJD3o5syZbNZje7G5P4IITMmzfzezPzZgjCf16Yxj8RXQWAeWae11rPpTmTVicRQAhxGREXfIPDhugLQESXAOBm8DaI+MCyrBNpb5ikFwtARBcAYDFk4I3rujO2bb9NMpx2PxJACHEGEe+M2rlnvwdASnmSme+Nw3kPABEdB4CHEeHzIvKtIzfM7HqrUCgY79v7DQCe/Hur1friOM6vzCkQQhxFxEdpDyborSGicl13WWu92k93IwXVanWy3W5/GJLzLjOIWDPGLMYV7mYNENFjj2UUEAAQ+3q6ijAOwms+acAQcQIASp3PrjSF3PMKoiAG6X5CiNuIeD4JIrIPDBFiGhFfhDppzbKs076sXyeMqolZpVRXa05KTblcLuXz+bWgHjNP+a8jaRb0QLiue8y27UzPVQgxi4g3Nm+NeMWyrI0BlzgNw+kYdBgR0U8A2NmBeKWUOpgKwFMKQDxn5lNa609JoQ/vE9EKABzy5caY7Y1G43diBPwDQoi5YrG4UK/XW1mdhy7hHy8ppd6nBhjEafCMdwFEvObLmPmw1vrl2ACIaBkAZABgUmv9cWwAUsrXzHzAB2g2m1scx/kzFoBKpTKRy+XeAcDWDsAzpdSR1K/gX/MvpVxi5nOB8J/VWt8dCwAReRPWa2j+WkfEKcuyvo4cQEp5i5kvhtpw13+LodeAEGJHoVDYb4y5DgDTofTVlVIzQVlmgGq1utsYc5+Zt0XUxl4A2BdTMz3OB0qBEKJnxKYo0kjn4wBYZeaa1roWB5k5BVLKPcy8HmPwBwB8RsQVZn6ilHqaFJ3MAEkGs+7/BQfySDDlTlsQAAAAAElFTkSuQmCC",alt:""})}),Object(h.jsx)(xe,{className:o?"active":"",onClick:le,children:Object(h.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAqtJREFUWEfFljGrE0EQx2duQ0yjiKA2TxBEfWjhg2dno1gdaLJzD2MlKOLDRkUtLCx8tqIgPEGwULASD243ATvB9wVEsBCEh4qChQqKFlpcMrIhd1wul9wuOXEhhGRn5v+7uZ2ZRfjPC6vWl1KuIOINAGgrpcKy+JUCZMQT3VKISgGCIHjEzKdzTz0VolKAVqu1z/O8pwCw3xaiUgAj6gpROYArhBOA7/ub6vX6HCJuAwCBiJ5ZcRwL821+m/8NBDNvB4D7BVUwciZKAaSUi57nLTEzAcB8WVlZ7qcQEwHMuxRCXGLmZcugTma1Wm13GIbrhQDDg/QMAHY6RbU3DpVSbWM+BiClPIyILwpifQOAt+bDzJ9stIYdMW+aio8BSCkXhuKbs17MvKq1vmgjmtgUdEWzNSI+BkBEpomcyIkf0VqvuYgT0RUAuJPzGRMfASCiMwDwMOvU6/Xmu92uSbv1IqJzAPDARnwEIAiCx8x8KnFk5mta61vWygAQBMFJZn5iK57PwPvMqf+ulNriIm5sC4ZRYdqzcQdV0Gw2NwohfmY2XiqlDroC5OZAqXiaASLaMyyxRNPKuQjQQCBiW2u9YvMAgwzka5+Zb9oGsBGZZpMA7ELE9YxhpJRamjW4jf8AwPf9DY1G40/igIivoyg6YBNgVpu0FRPRKwBYGAb83e/393Y6HauWOwtEFsDM7vOZLNyLoujCLMFtfFMAKeVRRHyecyq91dqIlB7CxEBKeRsRr440CsS7URRdnlVokv/YOM6dhcRvTQhxPY7jN1rrH1XCFF5IiOgLAGydIPQOAD7m9xDxlxDibBiGX10AJ17JikZzWWBmdh7dUy+lUsplRDR3wsUycbNfOUAiSkTHEPE4M5sBtWPC6/nMzIe01h9sYNNydzH+F7Z/AWqi/yEtgkl8AAAAAElFTkSuQmCC",alt:""})})]})]})})),he=d.a.footer(ee||(ee=Object(l.a)(["\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  width: 100%;\n  height: 44px;\n  padding: 0 40px;\n  background-color: #fff;\n  border-top: 1px solid #ddd;\n\n  .slider {\n    width: 240px;\n  }\n\n  .scale {\n    width: 100px;\n    padding-left: 20px;\n  }\n"]))),ue=d.a.div(te||(te=Object(l.a)(["\n  display: flex;\n  align-items: center;\n"]))),be=d.a.div(ne||(ne=Object(l.a)(["\n  display: flex;\n  justify-content: space-around;\n  width: 120px;\n\n  img {\n    width: 22px;\n    height: 22px;\n    pointer-events: none;\n    user-select: none;\n  }\n"]))),xe=d.a.div(ie||(ie=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  padding: 6px 8px;\n  border-radius: 4px;\n  cursor: not-allowed;\n  opacity: .5;\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  &.active {\n    opacity: 1;\n    cursor: pointer;\n  }\n"]))),fe=Object(a.createContext)(1),pe=Object(a.createContext)(null),ge=n(166),ye=function e(t,n,i){var o=this;Object(ge.a)(this,e),this.handleMove=function(e){},this.handleUp=function(){},this.startCoords={x:0,y:0},this.preCoords={x:0,y:0},this.mouseUp=function(){document.onmousemove=null,document.onmouseup=null,o.handleUp()},this.mouseMove=function(e){var t=e.clientX-o.preCoords.x,n=e.clientY-o.preCoords.y;o.preCoords={x:e.clientX,y:e.clientY},o.handleMove({diff:{x:t,y:n},startCoords:o.startCoords,curCoords:o.preCoords})},this.mouseDown=function(e){o.startCoords={x:e.clientX,y:e.clientY},o.preCoords={x:e.clientX,y:e.clientY},document.onmousemove=o.mouseMove,document.onmouseup=o.mouseUp},this.mouseDown(t),this.handleMove=n,i&&(this.handleUp=i)};var je,ve,Oe,me,we,ke,Ae,Me,Ce,Ee,Le,Se=function(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}},ze=function(e,t,n){return n/=180/Math.PI,{x:(e.x-t.x)*Math.cos(n)-(e.y-t.y)*Math.sin(n)+t.x,y:(e.x-t.x)*Math.sin(n)+(e.y-t.y)*Math.cos(n)+t.y}},Te=n.p+"static/media/rotate.a7cc796d.svg",Ie=n.p+"static/media/lock.7263c59f.svg";!function(e){e.TL="topLeft",e.TR="topRight",e.BL="bottomLeft",e.BR="bottomRight",e.T="top",e.B="bottom",e.L="left",e.R="right"}(Le||(Le={}));var Be,Re=10,De=10,Ue=[0,45,90,135],Ne=[{start:0,end:23,cursor:"nwse-resize"},{start:338,end:360,cursor:"nwse-resize"},{start:23,end:68,cursor:"ns-resize"},{start:68,end:113,cursor:"nesw-resize"},{start:113,end:158,cursor:"ew-resize"},{start:158,end:203,cursor:"nwse-resize"},{start:203,end:248,cursor:"ns-resize"},{start:248,end:293,cursor:"nesw-resize"},{start:293,end:338,cursor:"ew-resize"}],Pe=Object(H.a)((function(e){var t=e.info,n=Object(a.useContext)(fe),i=R.layers,o=R.setLayer,r=R.isMoving,c=R.setIsMoving,s=Object(a.useState)([]),l=Object(f.a)(s,2),d=l[0],u=l[1],b=function(e,a){e.stopPropagation(),0===t.rotate?function(e,a){var r=i.findIndex((function(e){return e.id===t.id}));r>-1&&new ye(e,(function(e){var t=Object(E.cloneDeep)(i[r]),s=e.diff,l=s.x,d=s.y,h=t.width/t.height,u=t.position,b=u.x,x=u.y,f=t.width,p=t.height;switch(a){case Le.TL:var g=t.height;b+=l/n,x-=(p=(f-=l/n)/h)-g;break;case Le.TR:var y=t.height;x-=(p=(f+=l/n)/h)-y;break;case Le.BL:b+=l/n,p=(f-=l/n)/h;break;case Le.BR:p=(f+=l/n)/h;break;case Le.T:p-=d/n,x+=d/n;break;case Le.B:p+=d/n;break;case Le.L:f-=l/n,b+=l/n;break;case Le.R:f+=l/n}(f>Re&&p>De||f>t.width||p>t.height)&&("text"===t.type&&t.height!==p&&t.scale&&(t.scale*=p/t.height),t.width=f,t.height=p,t.position.x=b,t.position.y=x),o(t),c(!0)}),(function(){c(!1)}))}(e,a):function(e,a){var r,s,l=(t.position.x+t.width/2)*n,d=(t.position.y+t.height/2)*n,h=null===(r=e.target)||void 0===r?void 0:r.getBoundingClientRect(),u=null===(s=document.querySelector("#layerControl"))||void 0===s?void 0:s.getBoundingClientRect(),b={x:h.left-Number(u.left)+h.width/2,y:h.top-Number(u.top)+h.height/2},x={x:l-(b.x-l),y:d-(b.y-d)},f=t.width/t.height,p=i.findIndex((function(e){return e.id===t.id}));new ye(e,(function(e){var r=e.curCoords,s=Object(E.cloneDeep)(i[p]),l={x:r.x-Number(u.left),y:r.y-Number(u.top)},d=s.height;switch(a){case Le.TL:var h=Se(l,x),g=ze(l,h,-t.rotate),y=ze(x,h,-t.rotate),j=y.x-g.x,v=y.y-g.y;j/v>f?g.x+=Math.abs(j-v*f):g.y+=Math.abs(v-j/f);var O=ze(g,h,t.rotate);h=Se(O,x),g=ze(O,h,-t.rotate),j=(y=ze(x,h,-t.rotate)).x-g.x,v=y.y-g.y,j/n>Re&&v/n>De&&(s.width=j/n,s.height=v/n,s.position.y=g.y/n,s.position.x=g.x/n);break;case Le.TR:var m=Se(l,x),w=ze(l,m,-t.rotate),k=ze(x,m,-t.rotate),A=w.x-k.x,M=k.y-w.y;A/M>f?w.x-=Math.abs(A-M*f):w.y+=Math.abs(M-A/f);var C=ze(w,m,t.rotate);m=Se(C,x),w=ze(C,m,-t.rotate),k=ze(x,m,-t.rotate),A=w.x-k.x,M=k.y-w.y,A/n>Re&&M/n>De&&(s.width=A/n,s.height=M/n,s.position.y=w.y/n,s.position.x=k.x/n);break;case Le.BR:var L=Se(l,x),S=ze(l,L,-t.rotate),z=ze(x,L,-t.rotate),T=S.x-z.x,I=S.y-z.y;T/I>f?S.x-=Math.abs(T-I*f):S.y-=Math.abs(I-T/f);var B=ze(S,L,t.rotate);L=Se(B,x),S=ze(B,L,-t.rotate),z=ze(x,L,-t.rotate),T=S.x-z.x,I=S.y-z.y,T/n>Re&&I/n>De&&(s.width=T/n,s.height=I/n,s.position.y=z.y/n,s.position.x=z.x/n);break;case Le.BL:var R=Se(l,x),D=ze(l,R,-t.rotate),U=ze(x,R,-t.rotate),N=U.x-D.x,P=D.y-U.y;N/P>f?D.x+=Math.abs(N-P*f):D.y-=Math.abs(P-N/f);var K=ze(D,R,t.rotate);R=Se(K,x),D=ze(K,R,-t.rotate),N=(U=ze(x,R,-t.rotate)).x-D.x,P=D.y-U.y,N/n>Re&&P/n>De&&(s.width=N/n,s.height=P/n,s.position.y=U.y/n,s.position.x=D.x/n);break;case Le.T:case Le.B:var W=ze(l,b,-t.rotate),Y=ze({x:b.x,y:W.y},b,t.rotate),H=Math.sqrt(Math.pow(Y.x-x.x,2)+Math.pow(Y.y-x.y,2)),F={x:Y.x-(Y.x-x.x)/2,y:Y.y+(x.y-Y.y)/2},G=!1,X=(t.rotate+360)%360;a===Le.T&&(X>=0&&X<=90||X>=270&&X<=360?Y.y>=x.y&&(G=!0):Y.y<=x.y&&(G=!0)),a===Le.B&&(X>=90&&X<=270?Y.y>=x.y&&(G=!0):Y.y<=x.y&&(G=!0)),H/n>De&&!G&&(s.height=H/n,s.position.y=(F.y-H/2)/n,s.position.x=F.x/n-s.width/2);break;case Le.L:case Le.R:var Q=ze(l,b,-t.rotate),q=ze({x:Q.x,y:b.y},b,t.rotate),V=Math.sqrt(Math.pow(q.x-x.x,2)+Math.pow(q.y-x.y,2)),J={x:q.x-(q.x-x.x)/2,y:q.y+(x.y-q.y)/2},Z=!1,_=(t.rotate+360)%360;a===Le.L&&(_>=0&&_<=90||_>=270&&_<=360?q.x>=x.x&&(Z=!0):q.x<=x.x&&(Z=!0)),a===Le.R&&(_>=90&&_<=270?q.x>=x.x&&(Z=!0):q.x<=x.x&&(Z=!0)),V/n>Re&&!Z&&(s.width=V/n,s.position.y=J.y/n-s.height/2,s.position.x=(J.x-V/2)/n)}"text"===s.type&&s.height!==d&&s.scale&&(s.scale*=s.height/d),o(s),c(!0)}),(function(){c(!1)}))}(e,a)},x=Object(a.useCallback)((function(){var e=t.rotate;e<0&&(e+=360);var n=[];Ue.forEach((function(t){var i=(t+e)%360,o=Ne.find((function(e){return e.start<=i&&e.end>=i}));o&&n.push(o.cursor)})),u(n)}),[t.rotate]);return Object(a.useEffect)((function(){x()}),[x]),Object(h.jsx)(Ke,{style:{width:t.width*n,height:t.height*n,transform:"translate(".concat(t.position.x*n,"px, ").concat(t.position.y*n,"px) rotate(").concat(t.rotate,"deg)")},className:["border-control",r?"moving":""].join(" "),children:t.isLocked?Object(h.jsx)(Ze,{icon:Ie,rotate:t.rotate}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ge,{style:{cursor:d[0]},onMouseDown:function(e){return b(e,Le.BR)}}),t.width*n>30&&t.height*n>30&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ye,{style:{cursor:d[0]},onMouseDown:function(e){return b(e,Le.TL)}}),Object(h.jsx)(He,{style:{cursor:d[2]},onMouseDown:function(e){return b(e,Le.TR)}}),Object(h.jsx)(Fe,{style:{cursor:d[2]},onMouseDown:function(e){return b(e,Le.BL)}}),Object(h.jsx)(qe,{style:{cursor:d[3]},onMouseDown:function(e){return b(e,Le.L)}}),Object(h.jsx)(Ve,{style:{cursor:d[3]},onMouseDown:function(e){return b(e,Le.R)}}),"text"!==t.type&&Object(h.jsx)(Xe,{style:{cursor:d[1]},onMouseDown:function(e){return b(e,Le.T)}}),"text"!==t.type&&Object(h.jsx)(Qe,{style:{cursor:d[1]},onMouseDown:function(e){return b(e,Le.B)}})]}),Object(h.jsx)(Je,{className:"rotate-point",icon:Te,onMouseDown:function(e){e.stopPropagation();var n=e.target.closest(".border-control");if(n){var a=n.getBoundingClientRect(),r={x:a.left+a.width/2,y:a.top+a.height/2};new ye(e,(function(e){var n=e.curCoords,a=n.y-r.y,s=n.x-r.x,l=180*Math.atan2(a,s)/Math.PI,d=i.findIndex((function(e){return e.id===t.id})),h=Object(E.cloneDeep)(i[d]);h.rotate=(l-90+360)%360,o(h),c(!0)}),(function(){c(!1)}))}}})]})})})),Ke=d.a.div(je||(je=Object(l.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n\n  &.moving .rotate-point {\n    opacity: 0;\n  }\n\n  &.moving span {\n    opacity: 0;\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    right: -1px;\n    bottom: -1px;\n    border: 2px solid #00c4cc;\n  }\n"]))),We=d.a.span(ve||(ve=Object(l.a)(["\n  position: absolute;\n  display: block;\n  background: transparent;\n  z-index: 1;\n  pointer-events: auto;\n  width: 18px;\n  height: 18px;\n  user-select: none;\n  transition: opacity 200ms;\n\n  ::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    border-radius: 6px;\n    background: #fff;\n    box-shadow: 0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(53 71 90 / 20%);\n  }\n"]))),Ye=Object(d.a)(We)(Oe||(Oe=Object(l.a)(["\n  top: -9px;\n  left: -9px;\n  cursor: nwse-resize;\n"]))),He=Object(d.a)(We)(me||(me=Object(l.a)(["\n  top: -9px;\n  right: -9px;\n  cursor: nesw-resize;\n"]))),Fe=Object(d.a)(We)(we||(we=Object(l.a)(["\n  bottom: -9px;\n  left: -9px;\n  cursor: nesw-resize;\n"]))),Ge=Object(d.a)(We)(ke||(ke=Object(l.a)(["\n  bottom: -9px;\n  right: -9px;\n  cursor: nwse-resize;\n"]))),Xe=Object(d.a)(We)(Ae||(Ae=Object(l.a)(["\n  width: calc(100% - 24px);\n  height: 12px;\n  top: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n"]))),Qe=Object(d.a)(We)(Me||(Me=Object(l.a)(["\n  width: calc(100% - 24px);\n  height: 12px;\n  bottom: -6px;\n  left: 12px;\n  cursor: ns-resize;\n\n  ::before {\n    width: 16px;\n    height: 4px;\n  }\n"]))),qe=Object(d.a)(We)(Ce||(Ce=Object(l.a)(["\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  left: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n"]))),Ve=Object(d.a)(We)(Ee||(Ee=Object(l.a)(["\n  width: 12px;\n  height: calc(100% - 24px);\n  top: 12px;\n  right: -6px;\n  cursor: ew-resize;\n\n  ::before {\n    width: 4px;\n    height: 16px;\n  }\n"]))),Je=d.a.div({position:"absolute",left:"50%",bottom:"-50px",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",transform:"translate(-50%, -50%)",pointerEvents:"auto",borderRadius:"50%",boxShadow:"0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)",userSelect:"none",cursor:"grab"},(function(e){return{background:"#fff url(".concat(e.icon,") no-repeat center / 18px 18px")}})),Ze=d.a.div({position:"absolute",right:"0",bottom:"0",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto",borderRadius:"50%",boxShadow:"0 0 5px 1px rgb(57 76 96 / 15%), 0 0 0 1px rgb(57 76 96 / 15%)",userSelect:"none",zIndex:"1"},(function(e){return{background:"#fff url(".concat(e.icon,") no-repeat center / 13px 13px"),transform:"translate(50%, 50%) rotate(".concat(-e.rotate,"deg)")}}));function _e(e){var t=e.info,n=Object(a.useContext)(fe);return Object(h.jsx)(tt,{style:{width:t.width*n,height:t.height*n,transform:"translate(".concat(t.position.x*n,"px, ").concat(t.position.y*n,"px) rotate(").concat(t.rotate,"deg)")}})}var $e,et,tt=d.a.div(Be||(Be=Object(l.a)(["\nposition: absolute;\ntop: 0;\nleft: 0;\npointer-events: none;\n\n&:after {\n  content: '';\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n}\n"]))),nt=Object(H.a)((function(e){var t,n,i=e.children,o=e.info,r=Object(a.useContext)(fe),c=R.template,s=R.layers,l=R.setLayer,d=R.selectLayer,u=R.hoverLayer,b=R.isMoving,x=R.setIsMoving,f=Object(a.useContext)(pe).setIsSelectedBackground,g=function(){var e={x:0,y:0,width:0,height:0,rotate:0},t={x:0,y:0,width:0,height:0},n="",i=[],o=1,a={width:0,height:0},r=4,c=document.querySelector("#verticalLine"),s=document.querySelector("#horizontalLine"),l=0,d=0,h=function(n,i){Math.abs(n-(t.x+t.width))<=r&&(i.x=n-e.width,i.x+=(e.width-t.width)/2,l=2),Math.abs(n-(t.x+t.width/2))<=r&&(i.x=n-e.width/2,l=1),Math.abs(n-t.x)<=r&&(i.x=n,i.x-=(e.width-t.width)/2,l=0)},u=function(n,i){Math.abs(n-(t.y+t.height))<=r&&(i.y=n-e.height,i.y-=(t.height-e.height)/2,d=2),Math.abs(n-(t.y+t.height/2))<=r&&(i.y=n-e.height/2,d=1),Math.abs(n-t.y)<=r&&(i.y=n,i.y+=(t.height-e.height)/2,d=0)},b=function(n){if(c&&s){if(n.x!==e.x){var i=0;0===l&&(i=n.x+(e.width-t.width)/2),1===l&&(i=n.x+e.width/2),2===l&&(i=n.x+(e.width-t.width)/2+t.width),c.style.transform="translateX(".concat(i*o,"px)"),c.style.visibility="visible"}else c.style.visibility="hidden";if(n.y!==e.y){var a=0;0===d&&(a=n.y-(t.height-e.height)/2),1===d&&(a=n.y+e.height/2),2===d&&(a=n.y-(t.height-e.height)/2+t.height),s.style.transform="translateY(".concat(a*o,"px)"),s.style.visibility="visible"}else s.style.visibility="hidden"}};return{getRect:function(){return e},init:function(c,s,l,d,h){n=s,i=l,r=4/(o=d),a=h;var u=(e=c).rotate*Math.PI/180,b=Math.abs(e.width*Math.cos(u))+Math.abs(e.height*Math.sin(u)),x=Math.abs(e.height*Math.cos(u))+Math.abs(e.width*Math.sin(u));t.width=b,t.height=x,t.x=e.x+(e.width-b)/2,t.y=e.y-(x-e.height)/2},move:function(o){var r=o.x,c=o.y;e.x=r,e.y=c;var s={x:e.x,y:e.y};return t.x=e.x+(e.width-t.width)/2,t.y=e.y-(t.height-e.height)/2,i.forEach((function(e){var t=e.rotate*Math.PI/180,i=Math.abs(e.width*Math.cos(t))+Math.abs(e.height*Math.sin(t)),o=Math.abs(e.height*Math.cos(t))+Math.abs(e.width*Math.sin(t)),a=e.position.x+(e.width-i)/2,r=e.position.y-(o-e.height)/2;e.id!==n&&(h(a+i,s),h(a+i/2,s),h(a,s),u(r+o,s),u(r+o/2,s),u(r,s))})),h(a.width,s),h(a.width/2,s),h(0,s),u(a.height,s),u(a.height/2,s),u(0,s),b(s),s}}}(),y=g.getRect,j=g.init,v=g.move,O=function(e){var t=e.diff,n=Object(E.cloneDeep)(o),i=v({x:y().x+t.x/r,y:y().y+t.y/r});n.position=i,l(n),x(!0)},m=function(){document.querySelector("#verticalLine").style.visibility="hidden",document.querySelector("#horizontalLine").style.visibility="hidden",x(!1)};return Object(h.jsxs)(ht,{style:{width:o.width,height:o.height,transform:"translate(".concat(o.position.x,"px, ").concat(o.position.y,"px) rotate(").concat(o.rotate,"deg)"),zIndex:o.zIndex},onMouseDown:function(e){e.stopPropagation(),o.isEditing||(d(o.id),f(!1),o.isLocked||(new ye(e,O,m),j(Object(p.a)(Object(p.a)({},o.position),{},{width:o.width,height:o.height,rotate:o.rotate}),o.id,s,r,Object(p.a)({},c.global))))},onMouseEnter:function(e){e.stopPropagation(),u(o.id)},onMouseOut:function(e){e.stopPropagation(),u()},className:[b?"moving":"",o.isEditing?"edit":""].join(" "),children:[Object(h.jsx)(ut,{style:{transform:"scale(".concat((null===(t=o.reverse)||void 0===t?void 0:t.x)||1,", ").concat((null===(n=o.reverse)||void 0===n?void 0:n.y)||1,")")},children:i}),o.isSelected&&Object(h.jsx)(it,{children:Object(h.jsx)(Pe,{info:o})}),!o.isSelected&&!b&&o.isHover&&Object(h.jsx)(it,{children:Object(h.jsx)(_e,{info:o})})]})}));function it(e){var t=e.children;return Object(c.createPortal)(t,document.querySelector("#layerControl"))}var ot,at,rt,ct,st,lt,dt,ht=d.a.div($e||($e=Object(l.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n  user-select: none;\n  cursor: default;\n\n  &.moving {\n    cursor: all-scroll;\n  }\n\n  &.edit {\n    cursor: text;\n  }\n"]))),ut=d.a.div(et||(et=Object(l.a)(["\n  width: 100%;\n  height: 100%;\n  transition: transform 250ms;\n"]))),bt=(n(257),n(258),n(167)),xt=n.n(bt),ft=Object(H.a)((function(e){var t,n=e.layer,i=Object(a.useRef)(null),o=R.editTextLayer,r=R.setLayer,c=R.needUpdateLayerHeight,s=R.setNeedUpdateLayerHeight,l=R.isMoving,d=Object(a.useContext)(fe),u=Object(a.useState)(null),b=Object(f.a)(u,2),x=b[0],p=b[1],g=null===(t=document.querySelector("#textControl"))||void 0===t?void 0:t.getBoundingClientRect(),y=Object(a.useCallback)((function(){if(x){var e=Object(E.cloneDeep)(n),t=x.getText();if(e.source.content=t,i.current){var o=i.current.getBoundingClientRect(),a=n.rotate%180*Math.PI/180,c=Math.abs((o.height-n.width*d*Math.sin(a))/Math.cos(a));if(c/d!==n.height){e.height=c/d;var s={x:o.left+o.width/2-g.left,y:o.top+o.height/2-g.top},l=s.x/d-n.width/2,h=(s.y-c/2)/d;e.position={x:l,y:h}}}r(e)}}),[x,n,r,d,g]);Object(a.useEffect)((function(){if(c&&i.current){var e=Object(E.cloneDeep)(n),t=i.current.getBoundingClientRect(),o=n.rotate%180*Math.PI/180,a=Math.abs((t.height-n.width*d*Math.sin(o))/Math.cos(o));if(a/d!==n.height){e.height=a/d;var l={x:t.left+t.width/2-g.left,y:t.top+t.height/2-g.top},h=l.x/d-n.width/2,u=(l.y-a/2)/d;e.position={x:h,y:u},r(e)}s(!1)}}),[g,n,c,d,r,s]),Object(a.useEffect)((function(){if(l&&i.current){var e=i.current.getBoundingClientRect(),t=n.rotate%180*Math.PI/180,o=Math.abs((e.height-n.width*d*Math.sin(t))/Math.cos(t));if(Math.abs(o/d-n.height)>1){var a=Object(E.cloneDeep)(n);a.height=o/d,r(a)}}}),[n,d,l,g,r]);return Object(a.useEffect)((function(){if(i.current&&!x){var e=new xt.a(i.current);p(e)}}),[x]),Object(a.useEffect)((function(){x&&n.source.content&&x.getText()!==n.source.content&&x.setText(n.source.content)}),[x,n.source.content]),Object(a.useEffect)((function(){x&&(x.enable(n.isEditing),n.isEditing&&x.setSelection(0,1e3))}),[x,n.isEditing]),Object(a.useEffect)((function(){return x&&x.on("text-change",y),function(){null===x||void 0===x||x.off("text-change",y)}}),[x,y]),Object(h.jsx)(pt,{style:{transform:"scale(".concat(n.scale,")"),width:"".concat(n.width/(n.scale||1),"px"),height:"".concat(n.height/(n.scale||1),"px")},children:Object(h.jsx)(gt,{data:n.style,onDoubleClick:function(){o(n.id)},children:Object(h.jsx)(yt,{ref:i,spellCheck:"false"})})})})),pt=d.a.div(ot||(ot=Object(l.a)(["\n  transform-origin: 0 0;\n"]))),gt=d.a.div({},(function(e){return{fontFamily:'"'.concat(e.data.font,'"'),fontSize:e.data.fontSize,color:e.data.color,lineHeight:e.data.lineHeight,textAlign:e.data.textAlign,fontWeight:e.data.fontWeight,textDecorationLine:e.data.underline?"underline":"none"}})),yt=d.a.div(at||(at=Object(l.a)(["\n  font-family: inherit;\n  font-size: inherit;\n\n  .ql-editor {\n    padding: 0;\n    overflow: visible;\n    font-family: inherit;\n    line-height: inherit;\n    text-align: inherit;\n    white-space: break-spaces;\n    /* user-select: text; */\n    line-break: anywhere;\n\n    &>* {\n      cursor: inherit;\n    }\n  }\n"]))),jt=Object(H.a)((function(){var e=R.template,t=R.resetSelectStatus,n=R.setLayerType,i=e.global,o=e.background,r=Object(a.useContext)(fe),c=Object(a.useContext)(pe),s=c.isSelectedBackground,l=c.setIsSelectedBackground;return Object(h.jsxs)(St,{width:i.width,height:i.height,scale:r,children:[Object(h.jsxs)(zt,{width:i.width,height:i.height,scale:r,children:[Object(h.jsx)(Lt,{color:o.color,onClick:function(e){e.stopPropagation(),l(!0),t(),n(j.BACKGROUND)}}),e.layers.map((function(e){return"image"===e.type?Object(h.jsx)(nt,{info:e,children:Object(h.jsx)(Et,{src:Object(M.q)(e.source.imageUrl),draggable:"false"})},e.id):"text"===e.type?e.isEditing?Object(h.jsx)(vt,{children:Object(h.jsx)(nt,{info:e,children:Object(h.jsx)(ft,{layer:Object(M.q)(e)})})},e.id):Object(h.jsx)(nt,{info:e,children:Object(h.jsx)(ft,{layer:Object(M.q)(e)})},e.id):Object(h.jsx)(h.Fragment,{})}))]}),Object(h.jsxs)(It,{id:"layerControl",width:i.width,height:i.height,scale:r,children:[s&&Object(h.jsx)(Bt,{}),Object(h.jsx)(Rt,{id:"verticalLine"}),Object(h.jsx)(Dt,{id:"horizontalLine"})]}),Object(h.jsx)(Tt,{id:"textControl",width:i.width,height:i.height,scale:r})]})}));function vt(e){var t=e.children;return Object(c.createPortal)(t,document.querySelector("#textControl"))}var Ot,mt,wt,kt,At,Mt,Ct,Et=d.a.img(rt||(rt=Object(l.a)(["\n  width: 100%;\n  height: 100%;\n"]))),Lt=d.a.div({position:"relative",zIndex:-1,width:"100%",height:"100%"},(function(e){return{backgroundColor:e.color}})),St=d.a.div({flex:"none",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"auto",pointerEvents:"none"},(function(e){return{width:e.width*e.scale+100,height:e.height*e.scale+100}})),zt=d.a.div({flex:"none",position:"relative",overflow:"hidden",backgroundColor:"#fff",userSelect:"none",pointerEvents:"auto"},(function(e){return{width:e.width,height:e.height,transform:"scale(".concat(e.scale,")")}})),Tt=Object(d.a)(zt)(ct||(ct=Object(l.a)(["\n  position: absolute;\n  top: 50;\n  left: 50;\n  z-index: 1;\n  pointer-events: none;\n  overflow: visible;\n  background-color: transparent;\n"]))),It=d.a.div({position:"absolute",top:50,left:50,zIndex:2,pointerEvents:"none"},(function(e){return{width:e.width*e.scale,height:e.height*e.scale}})),Bt=d.a.div(st||(st=Object(l.a)(["\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #00c4cc;\n  background: transparent;\n  pointer-events: none;\n"]))),Rt=d.a.div(lt||(lt=Object(l.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 0;\n  height: 100%;\n  border-left: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n"]))),Dt=d.a.div(dt||(dt=Object(l.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 0;\n  border-top: 1px dashed #c228ff;\n  visibility: hidden;\n  z-index: 2;\n"]))),Ut=n(330),Nt=n(335),Pt=n(336),Kt=n(331),Wt=n(338),Yt=n(332),Ht=n(337),Ft=n(340),Gt=n(341),Xt=n(342),Qt=n(343),qt=n(344),Vt=n(345),Jt=n(346),Zt=n(347),_t=n(348),$t=n(174),en=[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft Yahei"},{name:"\u6977\u4f53",value:"KaiTi"},{name:"\u534e\u6587\u6977\u4f53",value:"STKaiti"},{name:"\u7fe9\u7fe9\u4f53-\u7b80",value:"Hanzipen SC"},{name:"\u5a03\u5a03\u4f53-\u7b80",value:"Wawati SC"},{name:"\u5706\u4f53-\u7b80",value:"Yuanti SC"},{name:"\u5170\u4ead\u9ed1-\u7b80",value:"Lantinghei SC"}],tn=[6,8,10,12,14,16,18,20,22,24,28,32,36,42,48,56,64,72,80,88,96,104,120,144],nn=[{width:1280,height:720,label:"1280px \xd7 720px",value:"1"},{width:720,height:1280,label:"720px \xd7 1280px",value:"2"},{width:1024,height:768,label:"1024px \xd7 768px",value:"3"},{width:768,height:1024,label:"768px \xd7 1024px",value:"4"},{width:1920,height:1080,label:"1920px \xd7 1080px",value:"5"}],on=Ut.a.Option,an=Object(H.a)((function(){var e,t,n,i,o,r,c=R.template,s=R.layerType,l=R.layers,d=R.setCanvasSize,u=R.setLayer,b=R.setLayers,x=R.setLayerLevel,p=R.removeLayer,g=R.setLayerLock,y=R.setBackgroundColor,v=R.setNeedUpdateLayerHeight,O=Object(a.useState)("1"),m=Object(f.a)(O,2),w=m[0],A=m[1],M=l.find((function(e){return e.isSelected})),C=(null===M||void 0===M?void 0:M.scale)||1,L="";s===j.TEXT?L=(null===M||void 0===M||null===(r=M.style)||void 0===r?void 0:r.color)||"":s===j.BACKGROUND&&(L=c.background.color);var S=(null===M||void 0===M||null===(e=M.style)||void 0===e?void 0:e.font)||"",z=(null===M||void 0===M||null===(t=M.style)||void 0===t?void 0:t.fontSize)||0,T=(null===M||void 0===M||null===(n=M.style)||void 0===n?void 0:n.textAlign)||"left",I=(null===M||void 0===M||null===(i=M.style)||void 0===i?void 0:i.fontWeight)||400,B=(null===M||void 0===M||null===(o=M.style)||void 0===o?void 0:o.underline)||!1,D=(null===M||void 0===M?void 0:M.isLocked)||!1,U={min:1,max:100,current:1};M&&(U.current=l.findIndex((function(e){return e.id===M.id}))+1,U.max=l.length);var N=c.global.width,P=c.global.height;Object(a.useEffect)((function(){var e=nn.find((function(e){return e.width===N&&e.height===P&&e.value!==w}));e?A(e.value):"6"!==w&&A("6")}),[]);var K=function(e){var t=Object(E.cloneDeep)(M);(null===t||void 0===t?void 0:t.reverse)&&("x"===e&&(t.reverse.x=1===t.reverse.x?-1:1),"y"===e&&(t.reverse.y=1===t.reverse.y?-1:1),u(t))},W=Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(Nt.a.Group,{onChange:function(e){A(e.target.value);var t=nn.find((function(t){return t.value===e.target.value}));t&&d({width:t.width,height:t.height})},value:w,children:Object(h.jsxs)(Pt.b,{direction:"vertical",children:[nn.map((function(e){return Object(h.jsx)(Nt.a,{value:e.value,children:e.label},e.value)})),Object(h.jsxs)(Nt.a,{value:"6",children:["\u81ea\u5b9a\u4e49","6"===w?Object(h.jsxs)("div",{style:{marginTop:10},children:[Object(h.jsx)(Kt.a,{value:N,size:"small",placeholder:"\u5bbd",style:{width:100,marginRight:10},onChange:function(e){Object(E.isNumber)(e)&&e>0&&d({width:e,height:P})}}),"\xd7",Object(h.jsx)(Kt.a,{value:P,size:"small",placeholder:"\u9ad8",style:{width:100,marginLeft:10,marginRight:10},onChange:function(e){Object(E.isNumber)(e)&&e>0&&d({width:N,height:e})}})," \u50cf\u7d20"]}):null]})]})})});return Object(h.jsxs)(rn,{children:[Object(h.jsxs)(cn,{className:D?"locked":"",children:[[j.EMPTY].includes(s)&&Object(h.jsx)(sn,{children:Object(h.jsx)(k.a,{content:W,trigger:"click",placement:"bottomLeft",children:Object(h.jsx)("span",{className:"text",children:"\u753b\u5e03\u5c3a\u5bf8"})})}),[j.BACKGROUND,j.TEXT].includes(s)&&Object(h.jsx)(sn,{children:Object(h.jsx)(k.a,{content:Object(h.jsx)($t.a,{color:L,onChange:function(e){var t="rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")");if(s===j.TEXT){var n=Object(E.cloneDeep)(M);"text"===(null===n||void 0===n?void 0:n.type)&&n.style&&(n.style.color=t,u(n))}s===j.BACKGROUND&&y(t)}}),trigger:"click",placement:"bottomLeft",children:Object(h.jsx)(ln,{style:{backgroundColor:L}})})}),[j.TEXT].includes(s)&&Object(h.jsx)(sn,{children:Object(h.jsx)(Ut.a,{value:S,style:{width:140},placeholder:"\u9009\u62e9\u5b57\u4f53",onChange:function(e){var t=Object(E.cloneDeep)(M);"text"===(null===t||void 0===t?void 0:t.type)&&t.style&&(t.style.font=e,u(t))},children:en.map((function(e){return Object(h.jsx)(on,{value:e.value,children:Object(h.jsx)("span",{style:{fontFamily:e.value},children:e.name})},e.value)}))})}),[j.TEXT].includes(s)&&Object(h.jsx)(sn,{children:Object(h.jsx)(Ut.a,{value:(z*C).toFixed(0),style:{width:100,textAlign:"center"},placeholder:"\u5b57\u4f53\u5927\u5c0f",onChange:function(e){var t=Number(e);if(!isNaN(t)){var n=Object(E.cloneDeep)(M);"text"===(null===n||void 0===n?void 0:n.type)&&n.style&&(n.style.fontSize=t/C,u(n),v(!0))}},children:tn.map((function(e){return Object(h.jsx)(on,{value:e,children:e},e)}))})}),[j.TEXT].includes(s)&&Object(h.jsx)(sn,{className:700===I?"active":"",onClick:function(){var e=Object(E.cloneDeep)(M);"text"===(null===e||void 0===e?void 0:e.type)&&e.style&&(e.style.fontWeight=700===e.style.fontWeight?400:700,u(e))},children:Object(h.jsx)(Ft.a,{style:{fontSize:24}})}),[j.TEXT].includes(s)&&Object(h.jsx)(sn,{className:B?"active":"",onClick:function(){var e=Object(E.cloneDeep)(M);"text"===(null===e||void 0===e?void 0:e.type)&&e.style&&(e.style.underline=!e.style.underline,u(e))},children:Object(h.jsx)(Gt.a,{style:{fontSize:24}})}),[j.TEXT].includes(s)&&Object(h.jsxs)(sn,{onClick:function(){var e="left";"left"===T&&(e="center"),"center"===T&&(e="right"),"right"===T&&(e="left");var t=Object(E.cloneDeep)(M);"text"===(null===t||void 0===t?void 0:t.type)&&t.style&&(t.style.textAlign=e,u(t))},children:["left"===T&&Object(h.jsx)(Xt.a,{style:{fontSize:24}}),"center"===T&&Object(h.jsx)(Qt.a,{style:{fontSize:24}}),"right"===T&&Object(h.jsx)(qt.a,{style:{fontSize:24}})]}),[j.IMAGE].includes(s)&&Object(h.jsx)(sn,{children:Object(h.jsx)(Wt.a,{overlay:Object(h.jsxs)(Yt.a,{style:{width:120},children:[Object(h.jsx)(Yt.a.Item,{style:{padding:"10px"},icon:Object(h.jsx)(Vt.a,{}),onClick:function(){return K("x")},children:"\u6c34\u5e73\u7ffb\u8f6c"},"x"),Object(h.jsx)(Yt.a.Item,{style:{padding:"10px"},icon:Object(h.jsx)(Vt.a,{style:{transform:"rotate(90deg)"}}),onClick:function(){return K("y")},children:"\u5782\u76f4\u7ffb\u8f6c"},"y")]}),trigger:["click"],children:Object(h.jsx)("span",{className:"text",children:"\u7ffb\u8f6c"})})})]}),Object(h.jsxs)(cn,{className:D?"locked":"",children:[[j.IMAGE,j.TEXT].includes(s)&&Object(h.jsx)(sn,{children:Object(h.jsx)(k.a,{content:Object(h.jsx)(re.a,{value:U.current,min:U.min,max:U.max,style:{width:180},onChange:function(e){e>U.current?(l.forEach((function(t,n){n+1>U.current&&n+1<=e&&x(t.id,t.zIndex-1)})),M&&x(M.id,M.zIndex+(e-U.current))):(l.forEach((function(t,n){n+1>=e&&n+1<U.current&&x(t.id,t.zIndex+1)})),M&&x(M.id,M.zIndex-(U.current-e))),b(Object(E.cloneDeep)(l).sort((function(e,t){return e.zIndex-t.zIndex})))}}),trigger:"click",placement:"bottomRight",children:Object(h.jsx)("span",{className:"text",children:"\u5c42\u7ea7\u8c03\u6574"})})}),[j.TEXT,j.IMAGE].includes(s)&&Object(h.jsx)(sn,{className:["item-lock",D?"active":""].join(" "),onClick:function(){M&&g(M.id,!M.isLocked)},children:D?Object(h.jsx)(Jt.a,{style:{fontSize:24}}):Object(h.jsx)(Zt.a,{style:{fontSize:24}})}),[j.IMAGE,j.TEXT].includes(s)&&Object(h.jsx)(sn,{onClick:function(){var e=l.find((function(e){return e.isSelected}));e&&p(e.id)},children:Object(h.jsx)(_t.a,{style:{fontSize:24}})}),[j.EMPTY].includes(s)&&Object(h.jsx)(sn,{children:Object(h.jsx)(Ht.a,{placement:"bottomRight",title:"\u786e\u5b9a\u6e05\u7a7a\u753b\u5e03\uff1f",onConfirm:function(){b([])},okText:"\u6e05\u7a7a",cancelText:"\u53d6\u6d88",children:Object(h.jsx)("span",{className:"text",children:"\u6e05\u7a7a\u753b\u5e03"})})})]})]})})),rn=d.a.div(Ot||(Ot=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  height: 46px;\n  padding: 0 10px;\n  background-color: #fff;\n  border-bottom: 1px solid #ddd;\n  user-select: none;\n"]))),cn=d.a.div(mt||(mt=Object(l.a)(["\n  display: flex;\n  align-items: center;\n\n  &.locked>div:not(.item-lock) {\n    display: none;\n  }\n"]))),sn=d.a.div(wt||(wt=Object(l.a)(['\n  display: flex;\n  align-items: center;\n  margin-right: 10px;\n  padding: 4px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &.active {\n    background-color: rgba(57,76,96,.15);\n  }\n\n  &:hover {\n    background-color: rgba(64,87,109,.07);\n  }\n\n  .text {\n    padding: 0 10px;\n    font-size: 16px;\n  }\n\n  input[type="search"] {\n    text-align: center;\n  }\n']))),ln=d.a.div(kt||(kt=Object(l.a)(["\n  width: 28px;\n  height: 28px;\n  border: 2px solid #666;\n  border-radius: 4px;\n"]))),dn=T(),hn=dn.undo,un=dn.redo,bn={},xn=Object(H.a)((function(){var e=Object(a.useState)(1),t=Object(f.a)(e,2),n=t[0],i=t[1],o=Object(a.useRef)(null),r=R.template,c=R.resetSelectStatus,s=R.removeLayer,l=R.addLayer,d=Object(a.useState)(!1),u=Object(f.a)(d,2),b=u[0],x=u[1];Object(a.useEffect)((function(){var e=o.current,t=r.global.width,n=r.global.height,a=1;e&&e.clientWidth<t+100&&(a=(e.clientWidth-100)/t),e&&e.clientHeight<n*a+100&&(a=(e.clientHeight-100)/n),i(a)}),[r.global.width,r.global.height]);var p=Object(a.useCallback)((function(e){if(document.activeElement===document.body||null===document.activeElement){if("Backspace"===e.key||"Delete"===e.key){var t=r.layers.find((function(e){return e.isSelected}));t&&s(t.id)}if("c"===e.key&&(e.metaKey||e.ctrlKey)){var n=r.layers.find((function(e){return e.isSelected}));n&&!r.layers.some((function(e){return e.isEditing}))&&(bn=Object(E.cloneDeep)(n))}"v"===e.key&&(e.metaKey||e.ctrlKey)&&(r.layers.some((function(e){return e.isEditing}))||bn&&(bn.position&&(bn.position.x+=10),bn.position&&(bn.position.y+=10),bn.id=String(Date.now()),bn.zIndex=r.layers.length?r.layers[r.layers.length-1].zIndex+1:1,c(),l(bn))),"z"!==e.key||!e.metaKey&&!e.ctrlKey||e.shiftKey||hn(),"z"===e.key&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&un()}}),[l,s,c,r.layers]);Object(a.useEffect)((function(){return document.addEventListener("keydown",p),function(){document.removeEventListener("keydown",p)}}),[p]);return Object(h.jsxs)(fn,{children:[Object(h.jsx)(an,{}),Object(h.jsx)(pn,{ref:o,id:"CanvasWrapper",onMouseDown:function(e){"CanvasWrapper"===e.target.id&&(c(),x(!1))},children:Object(h.jsx)(pe.Provider,{value:{isSelectedBackground:b,setIsSelectedBackground:x},children:Object(h.jsx)(fe.Provider,{value:n,children:Object(h.jsx)(jt,{})})})}),Object(h.jsx)(de,{scale:n,setScale:function(e){return i(e)}})]})})),fn=d.a.div(At||(At=Object(l.a)(["\n  position: relative;\n  flex: 1;\n  overflow: hidden;\n"]))),pn=d.a.div(Mt||(Mt=Object(l.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  height: calc(100% - 88px);\n  overflow: scroll;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    background: #eef2f8;\n\n    &:horizontal {\n      height: 8px;\n    }\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-corner {\n    background: #eef2f8;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #c4c4c4;\n    border: 8px solid rgba(0, 0, 0, 0);\n    border-radius: 9999px;\n\n    &:hover {\n      background: #adadad;\n    }\n  }\n"])));function gn(){return Object(h.jsxs)(yn,{children:[Object(h.jsx)($,{}),Object(h.jsx)(xn,{})]})}var yn=d.a.main(Ct||(Ct=Object(l.a)(["\n  display: flex;\n  height: calc(100vh - 56px);\n  background-color: #eef2f8;\n  overflow: hidden;\n"])));n(322);var jn=function(){return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(u,{}),Object(h.jsx)(gn,{})]})},vn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,349)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),i(e),o(e),a(e),r(e)}))};n(323);s.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(jn,{})}),document.getElementById("root")),vn()}},[[324,1,2]]]);
//# sourceMappingURL=main.5d7a0432.chunk.js.map